<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Astroparticle Physics - 11&nbsp; Gamma-ray Astronomy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap4_2.html" rel="next">
<link href="./chap4_0.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap4_0.html">Multimessenger Astronomy</a></li><li class="breadcrumb-item"><a href="./chap4_1.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Gamma-ray Astronomy</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Astroparticle Physics</a> 
        <div class="sidebar-tools-main">
    <a href="./Astroparticle-Physics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Physics Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Some Basic Concents and Notations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Time and Coordinate Systems in Astronomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Special Relativity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to Cosmology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Cosmic Rays</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">What are Cosmic Rays?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Extra-Galactic Cosmic Rays: The Knee and Beyond</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Cosmic Rays in the Atmosphere</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Interactions of CR particles in the atmosphere</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Muons and Neutrinos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Particles Underground</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Multimessenger Astronomy</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Gamma-ray Astronomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Gamma-rays, Cosmic-Rays and Neutrinos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Neutrino Astronomy</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Dark Matter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dark Matter</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#spectral-energy-distribution" id="toc-spectral-energy-distribution" class="nav-link active" data-scroll-target="#spectral-energy-distribution">Spectral Energy Distribution</a></li>
  <li><a href="#gamma-ray-production-mechanism" id="toc-gamma-ray-production-mechanism" class="nav-link" data-scroll-target="#gamma-ray-production-mechanism">Gamma-ray production mechanism</a>
  <ul class="collapse">
  <li><a href="#leptonic-models" id="toc-leptonic-models" class="nav-link" data-scroll-target="#leptonic-models">Leptonic models:</a></li>
  <li><a href="#hadronic-model" id="toc-hadronic-model" class="nav-link" data-scroll-target="#hadronic-model">Hadronic model:</a></li>
  </ul></li>
  <li><a href="#leptonic-models-1" id="toc-leptonic-models-1" class="nav-link" data-scroll-target="#leptonic-models-1">Leptonic models</a>
  <ul class="collapse">
  <li><a href="#synchrotron-radiation" id="toc-synchrotron-radiation" class="nav-link" data-scroll-target="#synchrotron-radiation">Synchrotron radiation</a></li>
  <li><a href="#single-electron-in-uniform-magnetic-field" id="toc-single-electron-in-uniform-magnetic-field" class="nav-link" data-scroll-target="#single-electron-in-uniform-magnetic-field">Single-electron in uniform magnetic field</a></li>
  <li><a href="#non-relativistic-case-cyclotron-radiation" id="toc-non-relativistic-case-cyclotron-radiation" class="nav-link" data-scroll-target="#non-relativistic-case-cyclotron-radiation">Non relativistic case: Cyclotron radiation</a></li>
  <li><a href="#synchrotron" id="toc-synchrotron" class="nav-link" data-scroll-target="#synchrotron">Relativistic case: Synchrotron radiation.</a></li>
  <li><a href="#inverse-compton" id="toc-inverse-compton" class="nav-link" data-scroll-target="#inverse-compton">Inverse Compton scattering.</a></li>
  </ul></li>
  <li><a href="#hadronic-models" id="toc-hadronic-models" class="nav-link" data-scroll-target="#hadronic-models">Hadronic models</a>
  <ul class="collapse">
  <li><a href="#pion-decay" id="toc-pion-decay" class="nav-link" data-scroll-target="#pion-decay">Pion decay</a></li>
  </ul></li>
  <li><a href="#galactic-gamma-ray-diffuse-emission" id="toc-galactic-gamma-ray-diffuse-emission" class="nav-link" data-scroll-target="#galactic-gamma-ray-diffuse-emission">Galactic gamma-ray diffuse emission</a></li>
  <li><a href="#extragalactic-background-light" id="toc-extragalactic-background-light" class="nav-link" data-scroll-target="#extragalactic-background-light">Extragalactic Background Light</a></li>
  <li><a href="#gamma-ray-detection" id="toc-gamma-ray-detection" class="nav-link" data-scroll-target="#gamma-ray-detection">Gamma-ray Detection</a>
  <ul class="collapse">
  <li><a href="#the-atmosphere" id="toc-the-atmosphere" class="nav-link" data-scroll-target="#the-atmosphere">The atmosphere</a></li>
  <li><a href="#cherenkov-emission" id="toc-cherenkov-emission" class="nav-link" data-scroll-target="#cherenkov-emission">Cherenkov emission</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap4_0.html">Multimessenger Astronomy</a></li><li class="breadcrumb-item"><a href="./chap4_1.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Gamma-ray Astronomy</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Gamma-ray Astronomy</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>As we saw, the origin of CR remains a mystery due to the deflection of CRs in their travel. Only CR astronomy at <span class="math inline">\(10^{19}\)</span> eV will be possible if the composition of these UHECR are protons, but even in this case the GZK limits the horizon.</p>
<p>Gamma-ray astronomy provides an fundamental tool to observe the Universe using neutral deep penetrating gamma-ray particles. Originally the distinction between gamma-rays and X-rays was due to the nuclear production mechanism. X-rays are the product of transition of electrons in the atomic shell, while gamma-rays are produced in the atomic nucleus. This distinction also leads to a classification in energy. X-rays are typically below 100 keV. Photons with E &gt; 100 keV are called gamma-rays.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/EM_spectrum.svg" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1" title="Source: Wikipedia"><img src="images/EM_spectrum.svg" class="img-fluid figure-img" alt="Source: Wikipedia"></a></p>
<figcaption>Source: Wikipedia</figcaption>
</figure>
</div>
<section id="spectral-energy-distribution" class="level2">
<h2 class="anchored" data-anchor-id="spectral-energy-distribution">Spectral Energy Distribution</h2>
<p>In gamma-ray astronomy is usual to study an object emission by its spectral energy distribution (SED). The SED on an object is its energy emitted plotted against some measure of the photon - frequency or wavelength. The reason astronomers do this is to see how much energy is produced by the object as a function of frequency or wavelength. The SED is typically characterized by <span class="math inline">\(\nu F_\nu\)</span> and it is measured in units of ergs <span class="math inline">\(\mathrm{cm}^{-2}\; \mathrm{s}\;^{-1}\)</span>, ie. it indicates the rate of energy emitted per surface. The function <span class="math inline">\(F_\nu\)</span> is the flux density which indicates the rate of energy emitted per surface and also per frequency, so it is expressed as ergs <span class="math inline">\(\mathrm{cm^{-2}\; s^{-1}\; Hz^{-1}}\)</span>. All of this doesn’t need to be confused with the spectrum! which is what we are being using to characterize CRs. In CR physics spectrum in the rate of particles per unit energy and surface and it is measured on <span class="math inline">\(\mathrm{GeV^{-1}\; cm^{-2}\; s^{-1}}\)</span>. The spectrum multiply by energy, gives you the rate of particles per unit surface. Multiplying again by energy give use the energy rate per unit surface. Therefore we have the relation:</p>
<p><span class="math display">\[\nu F_\nu = E^2 \frac{\mathrm{d}N}{\mathrm{d}E}\]</span></p>
</section>
<section id="gamma-ray-production-mechanism" class="level2">
<h2 class="anchored" data-anchor-id="gamma-ray-production-mechanism">Gamma-ray production mechanism</h2>
<p>Sources of CR can also produce gamma-rays by different mechanisms roughly divided in two main categories:</p>
<section id="leptonic-models" class="level3">
<h3 class="anchored" data-anchor-id="leptonic-models">Leptonic models:</h3>
<p>In this models only leptons (mostly electrons) will produce gamma-ray emission. The mechanismare mostly: * <strong>Synchrotron radiation.</strong> * <strong>Inverse Compton Scattering.</strong></p>
</section>
<section id="hadronic-model" class="level3">
<h3 class="anchored" data-anchor-id="hadronic-model">Hadronic model:</h3>
<p>In hadronic models, gamma-rays are produced as a result of acceleration to high energies of protons or other hadrons. The mechanism of gamma-ray production in hadronic models are mainly: * <strong><span class="math inline">\(\pi^0\)</span> decay.</strong> * <strong>Proton synchrotron radiation.</strong></p>
<p>Another categories for gamma-ray production can some exotic models like dark matter annihilaiton, or matter-antimatter annihilation and nuclear transformation.</p>
</section>
</section>
<section id="leptonic-models-1" class="level2">
<h2 class="anchored" data-anchor-id="leptonic-models-1">Leptonic models</h2>
<section id="synchrotron-radiation" class="level3">
<h3 class="anchored" data-anchor-id="synchrotron-radiation">Synchrotron radiation</h3>
<p>Synchrotron radiation is extremely important for astrophysics as it was realized by Shklovskii in 1957 when studing the non-thermal emission of the Crab remnant. In order to understand better the synchrotron radiation we will have to dig in a bit in electromagnetism. We already saw that a charge particle of charge <span class="math inline">\(q\)</span>, for example an electron, moving with velocity <span class="math inline">\(v\)</span> in a magnetic field <span class="math inline">\(\vec{B}\)</span> feels an an external force:</p>
<p><span class="math display">\[\vec{F} = \frac{q}{c}(\vec{v}\times \vec{B}) \]</span></p>
<p>Now, because of the force on the particle is perpendicular to the motion, the magnetic field cannot do work on the particle, and so its speed does not change, i.e.&nbsp;<span class="math inline">\(|v|\)</span> = constant, but there is an acceleration since the direction will change. On the other hand an accelerated electrical charge radiates electromagnetic waves! which… will slow down the particle…</p>
<p>The reason of this aparent inconsistency comes from the fact that we treat the electric field lines as the purely Coulombic action-at-a-distance. In reality we have to take into account that as a particle moves, the electric field lines need to <em>re-arrange</em> and this re-arrangement cannot happen at a speed faster than the speed of light.</p>
<p>Here are going to derive the radiation emission for a particle with an acceleration and we are going to do it by messing around with the Coulomb fields. For a more formal argument derived from Maxwell equations you can see the book of Longair.</p>
<p>Let’s assume that the particle is at rest at the moment <span class="math inline">\(t=0\)</span>. The electric field lines clearly point away from the origin. At that moment the particle accelerates which brings the velocity of the particle to <span class="math inline">\(\Delta v\)</span> in a time <span class="math inline">\(\Delta t\)</span>, after that the particle continues with uniform velocity.</p>
<p><a href="images/bremsstrahlung.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/bremsstrahlung.svg" class="img-fluid"></a></p>
<p>After a certain time, the particle will be in the position <span class="math inline">\(t\Delta v\)</span>. In a sphere located far way (with a radius larger than <span class="math inline">\(c t\)</span>), the electric field lines are still those of the stacionary particle, since they field lines cannot “know” yet that the particle has moved, so the point radially towards the origin at <span class="math inline">\(t=0\)</span>. Inside a sphere of radius <span class="math inline">\(c(t - \Delta t\)</span>), the electric field lines are already those from the electron that moves at a constant velocity.</p>
<p>The perturbation of the electric field lines needs to propagate radially, this <em>kink</em> is nothing more than a radiation! From simple geometry relations we can get that:</p>
<p><span class="math display">\[\frac{E_\theta}{E_{r}} = \frac{\Delta v  t \sin\theta}{c\Delta t} = \frac{r \sin \theta}{c^2}\frac{\Delta v}{\Delta t}\]</span></p>
<p>where <span class="math inline">\(r = c t\)</span>, and <span class="math inline">\(E_r\)</span> is simply the Coulomb field <span class="math inline">\(E_r = q/4\pi\epsilon_0 r^2\)</span> or in <a href="https://en.wikipedia.org/wiki/Gaussian_units">gaussian units</a> since the kink is really small and the eletric field along the kink remains the same <span class="math inline">\(E_r = q/r^2\)</span> and therefore the transverse component becomes:</p>
<p><span class="math display">\[E_\theta = \frac{q a \sin\theta}{c^2 r}\]</span></p>
<p>where we used the fact that <span class="math inline">\(\Delta v/\Delta t\)</span> is just the acceleration <span class="math inline">\(a\)</span>. An interesting fact appears here, <span class="math inline">\(E_\theta\)</span> depends on <span class="math inline">\(r^{-1}\)</span> and not <span class="math inline">\(r^{-2}\)</span> so for larger <span class="math inline">\(r\)</span>, <span class="math inline">\(E_\theta\)</span> is going to dominate over <span class="math inline">\(E_r\)</span>. Accompanying this transverse electric field there will be a magnetic field, which is a property of an electromagnetic wave. In other words, an electromagnetic pulse is generated by the accelerated charge particle. Since this is an electromagnetic radiation there is an energy flow per unit area, per second and the direction is given by the Poynting vector (with <span class="math inline">\(|E|=|B|\)</span> as in electromagnetic wave):</p>
<p><span class="math display">\[\vec{S}  = \frac{c}{4\pi}(\vec{E}\times\vec{B})\]</span></p>
<p>Which points in the radial direction. In this case can be reduced to:</p>
<p><span class="math display">\[|S| \equiv \frac{ \mathrm{d}E}{\mathrm{d}t \mathrm{d}A} = \frac{c}{4\pi} E^2_\theta \vec{n}\]</span></p>
<p>Which is the energy flow per unit area per second. The unit area <span class="math inline">\(\mathrm{d}A\)</span> can be rewritten in terms of the solid angle as <span class="math inline">\(\mathrm{d} A= r^2\mathrm{d}\Omega\)</span>, and so the rate of energy loss through the area subtended by the solid angle <span class="math inline">\(\mathrm{d} \Omega\)</span> at distance <span class="math inline">\(r\)</span> is given by:</p>
<p><span class="math display">\[\left(\frac{\mathrm{d}E}{\mathrm{d}t \mathrm{d} \Omega}\right)_{rad}  = \frac{q^2a^2 \sin^2 \theta}{4\pi c^3}\]</span></p>
<p>Notice that this energy loss rate follows a <em>dipole</em> pattern <span class="math inline">\(\mathrm{d}P/\mathrm{d}\Omega \propto \sin^2 \theta\)</span> and that <span class="math inline">\(\theta\)</span> is defined along the acceleration line. If we now integrate over all solid angles we obtain that the emitted power is given by:</p>
<p><span class="math display">\[P \equiv -\left(\frac{\mathrm{d}E}{\mathrm{d}t}\right)_{rad} = \frac{2q^2 a^2 }{3c^3}\]</span></p>
<p>Which is call the <em>Larmor’s formula</em>. Note that this is valid for any form of acceleration <span class="math inline">\(a\)</span>.</p>
<p>In the relativistic case this formula can be rewritten as:</p>
<p><span class="math display">\[P  = \frac{2q^2}{3c^3} \gamma^4 [ \gamma^2 a_{\parallel}^2 + a^2_{\perp}] \]</span></p>
</section>
<section id="single-electron-in-uniform-magnetic-field" class="level3">
<h3 class="anchored" data-anchor-id="single-electron-in-uniform-magnetic-field">Single-electron in uniform magnetic field</h3>
<p>In an uniform magnetic field, a high energy charged particle, for example an electron, moves in spiral path at a constant <em>pitch angle</em>, <span class="math inline">\(\alpha\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/spiral.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/spiral.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<p>Its velocity along the field lines is constant <span class="math inline">\(v_{\parallel} = v \cos\alpha = \mathrm{const.}\)</span>, but its circular component <span class="math inline">\(v_\perp = v\sin\alpha\)</span>. Let’s first attack the non-relativistic case.</p>
</section>
<section id="non-relativistic-case-cyclotron-radiation" class="level3">
<h3 class="anchored" data-anchor-id="non-relativistic-case-cyclotron-radiation">Non relativistic case: Cyclotron radiation</h3>
<p>From Newton’s law and the Lorentz force we have that:</p>
<p><span class="math display">\[ m_e a_\perp = m_e \frac{v_\perp^2}{r_{gyr}} = \frac{e v_\perp B}{c}\]</span></p>
<p>where <span class="math inline">\(r_{gyr}\)</span> is the gyroradius which can be written as:</p>
<p><span class="math display">\[r_{gyr} = \frac{v_\perp}{\omega_{gyr}} = \frac{v\sin\alpha}{\omega_{gyr}}\]</span></p>
<p>where we can define the gyrofrecuency as:</p>
<p><span class="math display">\[\omega_{gyr} \equiv \frac{eB}{m_e c}\]</span></p>
<p>Therefore according to the Larmor’s equation of power emitted we can write:</p>
<p><span class="math display">\[P = \frac{2 e^2}{3c^3} \omega_{gyr}^2 v^2\sin^2\alpha\]</span></p>
<p>Note the Larmor formula does not tell us frequency spectrum, but if a particle is moving in a circular motion, then from an observer far way, the “aparent” motion will be sinosoidal as illustrated in the figure below.</p>
<p><a href="images/cyclotron.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/cyclotron.svg" class="img-fluid"></a></p>
<p>In particular since the power <span class="math inline">\(P\)</span> depends on <span class="math inline">\(|v^2|\)</span> for a distance in the <span class="math inline">\(x-y\)</span> plane, power will varie as <span class="math inline">\(\sin^2(\omega_{gyr}t)\)</span> and so the electric field line will change as <span class="math inline">\(E(t)\propto \sin(\omega_{gyr}t)\)</span>. The radiated emission will appear as <em>monochromatic</em> with an angular frequency given precisely by the particle circular frequency <span class="math inline">\(\omega_{gyr}\)</span>. This is the known as the <em>cyclotron</em> radiation. In this case the dipole emission pattern is turning around with the particle and an observer in the laboratory frame will see the same frequency. As a consequence also the radiation is independent of the viewing angle.</p>
</section>
<section id="synchrotron" class="level3">
<h3 class="anchored" data-anchor-id="synchrotron">Relativistic case: Synchrotron radiation.</h3>
<p>Things are slighly different when we consider the relativistic case where electrons move at <span class="math inline">\(\beta \rightarrow 1\)</span>. Using again Newton’s law with the Lorentz force we have:</p>
<p><span class="math display">\[\gamma m_e \frac{\mathrm{d} v_\perp}{\mathrm{d} t} = \frac{e v_\perp B}{c}\]</span></p>
<p>where we can obtain the perpendicular acceleration as:</p>
<p><span class="math display">\[a_\perp = \frac{e v\sin\alpha}{\gamma m_e c}\]</span></p>
<p>where now the electrons’s relatisvistic angular gyroradius frequency is given by:</p>
<p><span class="math display">\[\omega^{rel}_{gyr} \equiv \frac{eB}{\gamma m_e c}\]</span></p>
<p>which is exactly related to the classical angular frequency as <span class="math inline">\(\omega_{gyr}/\gamma\)</span>. According to the relativistic Larmor’s formula above we have that:</p>
<p><span class="math display">\[P = \frac{2 e^2}{3c^3} \gamma^4 \left(\frac{e v\sin\alpha}{\gamma m_e c}\right)^2 \]</span></p>
<p>We can re-arrange this formula by assuming ultra-relativistic electrons <span class="math inline">\(\beta \rightarrow 1\)</span> and that we have an average number of electrons with different pitch angles and so <span class="math inline">\(\langle \sin^2 \alpha \rangle = 2/3\)</span>. We are going also to use the definition of the Thomson cross-section:</p>
<p><span class="math display">\[\sigma_T \equiv \frac{8\pi}{3}r^2_0\]</span></p>
<p>where <span class="math inline">\(r_0\)</span> is the electron classic radius defined (in gaussian units) as:</p>
<p><span class="math display">\[r_0 = \frac{e^2}{m_e c^2} \]</span></p>
<p>with that we can write the power loss as:</p>
<p><span class="math display">\[P = \frac{4}{3} \sigma_T c U_B \gamma^2\]</span></p>
<p>where <span class="math inline">\(U_B = B^2/8\pi\)</span> is the magnetic field energy density. The power depends on the electron mass via the Thomson cross-section and the <span class="math inline">\(\gamma\)</span>. In total it gives <span class="math inline">\(P\propto m_e^{-4}\)</span> for the electrons. That’s why for protons the syncrotron radiation is not as important as it is for electrons. The mean free-path for electrons given their losses sue to synchrotron is (for typical astrophysical values):</p>
<p><span class="math display">\[l_{syn} = \left(\frac{1}{E}\frac{\mathrm{d}E}{\mathrm{d}t}\right)^{-1}  \sim 100 \mathrm{\;pc}\]</span></p>
<p>That’s the reason why electrons are not the main component of CR since the cannot travel long distances. If we want now to derive the power emitted per frequency, things get also a bit more complicated. One first thing to take into account is that in the relativistic regime the power radiated will be distorted. From Lorentz transformations we can derive that an angle <span class="math inline">\(\Psi\)</span> in the particle rest frame will be seen in laboratory frame as:</p>
<p><span class="math display">\[\sin \Psi = \frac{\sin\Psi^\prime}{\gamma(1+\beta \cos\Psi^\prime)}\]</span></p>
<p>(we saw this in the Exercises 1). For small angles we have that</p>
<p><span class="math display">\[\sin \Psi \sim \Psi \sim \frac{1}{\gamma}\]</span></p>
<p>i.e, while the power is radiated nearly isotropically (dipole) in the particle’s instantaneus rest frame, most of it will be <em>beamed</em> into a narrow cone of angle <span class="math inline">\(\sim 1/\gamma\)</span> in the laboratory frame. Note that I’m referring to an <em>instantaneous</em> rest frame, what does it even mean? Well it means that I in the particle rest frame, where the velocity of the particle is 0, the acceleration on the other hand is not 0, so eventually the particle will move. Ie, there is no particle rest frame, but there is an instantaneous rest frame.</p>
<p>This beaming in the lab reference frame has an impact on how the viewer sees the electric field variation. It is no longer a sinusoidal, instead the emission is pulsed every time the cone sweeps around the line of sight of an observer as illustrated below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synchrotron_0.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/synchrotron_0.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<p>Since each cone beaming has a half amplidude of <span class="math inline">\(1/\gamma\)</span> the radiation from an observer is visible during a <span class="math inline">\(\Delta \theta \sim 2/\gamma\)</span>. During this angular distance the particle travels from <span class="math inline">\(A\)</span> to <span class="math inline">\(B\)</span> at an angular frequency given by <span class="math inline">\(\omega_{gyr}^{rel}\)</span> which means that <span class="math inline">\(\Delta t_{AB}\)</span> is given by:</p>
<p><span class="math display">\[\Delta t_{AB} = \frac{\Delta \theta}{\omega_{gyr}^{rel}} = \frac{2}{\gamma \omega_{gyr}^{rel}}\]</span></p>
<p>Given the relativistic speed of the the electron, the frequency of the radiation is no longer a sinusoidal. When a photon is emitted at the point <span class="math inline">\(B\)</span> the photon emitted in <span class="math inline">\(A\)</span> has already travelled a distance <span class="math inline">\(c\Delta t_{AB}\)</span>. Therefore the time interval between photons is given by:</p>
<p><span class="math display">\[\Delta t_{sync} = \frac{c\Delta t_{AB} - v_\perp \Delta t_{AB}}{c} \approx \Delta t_{AB}( 1 - \beta) \approx  \Delta t_{AB} \frac{1 - \beta^2}{1 + \beta} \]</span></p>
<p><span class="math display">\[ \Delta t_{sync} \approx \frac{ \Delta t_{AB} }{2\gamma^2} = \frac{1}{\gamma^3 \omega_{gyr}^{rel}} = \frac{1}{\gamma^2 \omega_{gyr}} \]</span></p>
<p>So synchrotron radiation is a very spiky series of widely spaced narrow pulses of time <span class="math inline">\(2\Delta t_{sync}\)</span>, and adjacent spikes are separated in frequency <span class="math inline">\(\Delta t_{gyr} = 1/\nu^{rel}_{gyr} = \gamma/\nu_{gyr}\)</span>. The emission from an observer is illustrated below:</p>
<p><a href="images/synchrotron_1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/synchrotron_1.svg" class="img-fluid"></a></p>
<p>The power spectrum (ie power as function of frequency) illustrated in the plot on the right is no long a monochromatic sinusoidal signal, but the Fourier transform of this time series of pulses. Taking of all the Fourier components into account results in the following expression for one electron (the formal derivation can be found for example in <em>Classical Electrodynamics</em> by J. D. Jackson):</p>
<p><span class="math display">\[P(\nu)\mathrm{d}\nu = \frac{\sqrt{3}e^3B\sin\alpha}{m_ec^2}\frac{\nu}{\nu_c}\int_{\nu/\nu_c}^\infty K_{5/3}(\psi)\mathrm{d}\psi\]</span></p>
<p>where <span class="math inline">\(K_{5/2}\)</span> is the Bessel function of order 5/2, and we expressed the power spectrum in terms of the frequency <span class="math inline">\(\nu = \nu_{gyr} =\omega_{gyr}/2\pi\)</span> and where we defined the critical frequency as:</p>
<p><span class="math display">\[\nu_c \equiv \frac{3}{2}\gamma^2\nu_{gyr} \sin \alpha\]</span></p>
<p>which the frequency at which the power spectrum will peak. In general terms we can describe the shape of the synchrotron power spectrum of a single electron has a logarithmic slope at low frequencies as <span class="math inline">\(P \propto \nu^{1/3}\)</span>, a broad peak near the critical frequency <span class="math inline">\(\nu_c\)</span>, and a sharp fall off at higher frequencies.</p>
<section id="spectrum-for-several-electrons-for-optically-thin-sources" class="level4">
<h4 class="anchored" data-anchor-id="spectrum-for-several-electrons-for-optically-thin-sources">Spectrum for several electrons for optically thin sources</h4>
<p>If a synchrotron source containing any arbitrary distribution of electron energies is optically thin (<span class="math inline">\(\tau \ll 1\)</span>), then its spectrum is the superposition of the spectra from individual electrons and its flux density cannot rise faster than <span class="math inline">\(\nu^{1/3}\)</span> at any frequency <span class="math inline">\(\nu\)</span>. The energy distribution of cosmic-ray electrons in most synchrotron sources is roughly a power law:</p>
<p><span class="math display">\[n(E) \mathrm{d}E \propto E^{-\delta}\mathrm{d}E\]</span></p>
<p>We make the very simple and crude approximation that each electron radiates all of its power at a single critical frequency:</p>
<p><span class="math display">\[\nu_c \simeq \gamma^2\nu_{gyr}\]</span></p>
<p>We can assume that the luminosity or total power emitted per unit volume per unit frequency, <span class="math inline">\(L(\nu)\mathrm{d}\nu\)</span> is given by the power emitted for each individual electron times the number of electrons:</p>
<p><span class="math display">\[ L (\nu) \mathrm{d}\nu = P n(E)\mathrm{d}E = -\left(\frac{\mathrm{d}E}{\mathrm{d}t}\right) n(E)\mathrm{d}E \]</span></p>
<p>where <span class="math display">\[E = \gamma m_e c^2 \simeq \left(\frac{\nu}{\nu_{gyr}}\right)^{1/2}m_e c^2\]</span></p>
<p>and so</p>
<p><span class="math display">\[\frac{\mathrm{d}E}{\mathrm{d}\nu} \simeq \frac{m_e c^2 \nu^{-1/2}}{2\nu_{gyr}^{1/2}}\]</span></p>
<p>putting all together gives:</p>
<p><span class="math display">\[L_\nu \propto B^{(\delta+1)/2}\nu^{(1-\delta)/2}\]</span></p>
<p>That is, the synchrotron spectrum of a power-law energy distribution is itself a power law. This idea is represented in the figure below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/synchrotron_spectrum.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="images/synchrotron_spectrum.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<p>For example in our Galaxy we expect the electron population to have an spectral index of <span class="math inline">\(\delta \sim 2.4\)</span>, and so the synchrotron radiation should have an spectral index of <span class="math inline">\(\sim 0.7\)</span>.</p>
</section>
<section id="power-spectrum-for-several-electrons-for-optically-thick-sources" class="level4">
<h4 class="anchored" data-anchor-id="power-spectrum-for-several-electrons-for-optically-thick-sources">Power spectrum for several electrons for optically thick sources</h4>
<p>The argument of a power law synchrotron spectrum as a power-low with specltral index <span class="math inline">\(\alpha = (1 - \delta)/2\)</span> it’s true as long as no absorption of photons by the emitting region happens. At low frequencies however synchrotron suffers from self-absorption, in which a photon interacts with a charge in a magnetic field. This also happens in <em>optically thick</em> sources. Therefore at low frequencies its emission is absorbed and re-emitted as blackbody radiation. The derivation of the synchrotron self-absorption is complicated so we are going to give only an heuristic approach. The problem with the re-emission of low frequencies as a black-body radiation is that a power-law distribution does not have a characteristic temperature. We can however assume that each electrons emits energy at a given frequency (given that the synchrotron emission of individual electrons is highly peak at a given frequency):</p>
<p><span class="math display">\[\nu_c \equiv \frac{3}{2}\gamma^2\nu_{gyr} \sin \alpha\]</span></p>
<p>in order to calculate an <em>effective temperature</em> we can use that for an ultrarelativistic gas we have the relation:</p>
<p><span class="math display">\[E_e = 3kT_e(\nu)\]</span></p>
<p>where <span class="math inline">\(E_e = \gamma m_e c^2\)</span>, since <span class="math inline">\(\gamma \propto \nu^{1/2}\)</span> we have that:</p>
<p><span class="math display">\[T_e(\nu) \propto \nu^{1/2}\]</span></p>
<p>The black-body radiation or Rayleigh-Jeans is proportional to <span class="math inline">\(\nu^2\)</span> but given the extra dependency of <span class="math inline">\(T_e(\nu)\)</span> it is changed as:</p>
<p><span class="math display">\[L(\nu) \propto T(\nu) \nu^2 B^{-1/2} \sim \nu^{1/2}\nu^{2}B^{-1/2} \sim \nu^{5/2} B^{-1/2}\]</span></p>
<p>A thing to note is that this part of the spectrum is independent of the orginal electron power-law spectral index.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial I: Working with SED using `naima`">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial I: Working with SED using <code>naima</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>We are going to plot some SED using a python module called <a href="https://github.com/zblz/naima"><code>naima</code></a>. This package allows for the calculation of non-thermal radiation from relativistic particle populations.</p>
<div id="7aed7f06" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">"STIXGeneral"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'axes.labelsize'</span>: <span class="dv">20</span>})</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'legend.fontsize'</span>: <span class="dv">20</span>})</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'figure.figsize'</span>: [<span class="dv">8</span>, <span class="dv">6</span>]})</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.labelsize'</span>] <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.labelsize'</span>] <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.major.width'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.minor.width'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.major.pad'</span>] <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.direction'</span>] <span class="op">=</span> <span class="st">'in'</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.size'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.minor.size'</span>] <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.width'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.minor.width'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.pad'</span>] <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.direction'</span>] <span class="op">=</span> <span class="st">'in'</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'legend.frameon'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'lines.linewidth'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.linewidth'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'svg'</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> naima</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> astropy.units <span class="im">as</span> u</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># First we are going to define a population of electrons with a PowerLaw model                                    </span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>e_pl <span class="op">=</span> naima.models.PowerLaw(<span class="fl">1e35</span><span class="op">*</span>u.Unit(<span class="st">'1/eV'</span>), <span class="dv">1</span><span class="op">*</span>u.TeV, <span class="fl">2.4</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Now the equivlent synchrotron radiation for a magnetic field of 100 uG</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>syn <span class="op">=</span> naima.models.Synchrotron(e_pl, B<span class="op">=</span><span class="dv">100</span><span class="op">*</span>u.uG)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>spectrum_energy <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">1000</span>)<span class="op">*</span>u.eV</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>sed_syn <span class="op">=</span> syn.sed(spectrum_energy, distance<span class="op">=</span><span class="fl">1.5</span><span class="op">*</span>u.kpc)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>ax.loglog(spectrum_energy,sed_syn,lw<span class="op">=</span><span class="dv">3</span>,label<span class="op">=</span><span class="st">'Syncrotron'</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">1e-9</span>, <span class="fl">1e-5</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Photon energy [</span><span class="sc">{0}</span><span class="st">]'</span>.<span class="bu">format</span>(</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        spectrum_energy.unit.to_string(<span class="st">'latex_inline'</span>)))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'$E^2 dN/dE$ [</span><span class="sc">{0}</span><span class="st">]'</span>.<span class="bu">format</span>(</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        sed_syn.unit.to_string(<span class="st">'latex_inline'</span>)))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap4_1_files/figure-html/cell-2-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="chap4_1_files/figure-html/cell-2-output-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inverse-compton" class="level3">
<h3 class="anchored" data-anchor-id="inverse-compton">Inverse Compton scattering.</h3>
<p>Compton discovered that photons can transfer part of their energy to electrons in a collision. In astrophysics the inverse Compton effect electrons accelerated to high energy collide with photons from the blackbody radiation (thermal photons) or starlight photons and transfer energy to them.</p>
<p>In astrophysics the inverse compton scattering is very important as a fast electrons that produce the synchrotron component can hit a low-energy photon and transfer a large fraction of its energy to the photon. For low energy photons, the scattering is elastic, and this regime is called the classical <em>Thomson regime</em>. However, for high energy photons where <span class="math inline">\(E_\gamma \gg m_e c^2\)</span> the scatting is not elastic and the energy of the scattered photons changes. This regime is called the <em>Klein-Nishina</em>. The cross-section for this <em>inelastic</em> scattering is given by:</p>
<p><span class="math display">\[\frac{\mathrm{ d} \sigma_{KN}}{\mathrm{ d}\Omega} = \frac{r_e^2}{2} \frac{E^2_{\gamma,out}}{E^2_{\gamma,in}}\left(\frac{E_{\gamma,out}}{E_{\gamma,in}} + \frac{E_{\gamma,in}}{E_{\gamma,out}} - \sin^2\theta\right)\]</span></p>
<p>In the low energy regime <span class="math inline">\(E_{\gamma,in} = E_{\gamma,out}\)</span> and the cross-section approaches that of the Thomson scattering.</p>
<section id="maximum-energy-of-inverse-compton" class="level4">
<h4 class="anchored" data-anchor-id="maximum-energy-of-inverse-compton">Maximum energy of inverse Compton</h4>
<p>Let’s assume the lab reference system, <span class="math inline">\(O\)</span>, and the electrons rest frame system <span class="math inline">\(O^\prime\)</span>. The energy of the photon is then given by:</p>
<p><span class="math display">\[E_{\gamma,in}^\prime = \gamma E_{\gamma,in} (1 + \beta \cos\theta)\]</span></p>
<p>where <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\beta\)</span> refer obviously to the electron. Since in the electron’s rest frame the scattering happens at low-energy we can assume that the scattering is described by the elastic Thomson regime, ie, the photon is scattered with the same energy in the electron’s rest frame. Going back to the lab frame we have then:</p>
<p><span class="math display">\[E_{\gamma,out} = \gamma E_{\gamma,out}^\prime ( 1 + \beta\cos\theta^\prime)\]</span></p>
<p>but <span class="math inline">\(E_{\gamma,in}^\prime = E_{\gamma,out}^\prime\)</span>. The maximum energy transfer will be that of a head-on collision in which the electron <span class="math inline">\(\cos\theta = \cos \theta^\prime = 1\)</span> is bounced backwards we have that:</p>
<p><span class="math display">\[\nu_{max} = \nu_0 \gamma^2 ( 1 + \beta)^2 \simeq 4 \nu_0 \gamma^2\]</span></p>
<p>As electrons are moving in an isotropic photon field the will see mostly head on collitions. So the energy spectrum of of scattered photons peak close to the maximum frecuency. This relation is very important for astrophysics, because it tell us a relation between the energy of electrons and the spectrum of photons. We know there are electrons with <span class="math inline">\(\gamma \sim 100 - 1000\)</span> and therefore the resulting photon emission is of very high energy. For example assuming electrons with <span class="math inline">\(\gamma \approx 1000\)</span> we have:</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Waveband</th>
<th>Frequency (Hz) <span class="math inline">\(\nu_0\)</span></th>
<th>Scattered Frequency (Hz)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Radio</td>
<td><span class="math inline">\(10^9\)</span></td>
<td><span class="math inline">\(10^{15}\)</span> = UV</td>
</tr>
<tr class="even">
<td>Far-infrared</td>
<td><span class="math inline">\(3\times10^{12}\)</span></td>
<td><span class="math inline">\(3\times10^{18}\)</span> = X-rays</td>
</tr>
<tr class="odd">
<td>Optical</td>
<td><span class="math inline">\(4\times10^{14}\)</span></td>
<td><span class="math inline">\(4\times10^{21}\)</span> = <span class="math inline">\(\gamma\)</span>-rays</td>
</tr>
</tbody>
</table>
<p>The hand-waving argument <span class="math inline">\(\nu \sim \nu_0 \gamma^2\)</span> has also implication on the spectrum of photons. If electrons follow a power-law in the form of:</p>
<p><span class="math display">\[\mathrm{d} n(E) \propto E^{-p} \mathrm{d} E\]</span></p>
<p>we can derive the spectrum of scattered photons which will follow a power-law as:</p>
<p><span class="math display">\[ I(\nu) \propto \nu^{-\frac{p-1}{2}} \]</span></p>
<p>because electrons losse energy by a factor <span class="math inline">\(\gamma^2\)</span> and the frequency of photons is <span class="math inline">\(\nu \approx \nu_0 \gamma^2\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In some cases the synchrotron spectrum can interact with the same electron population that generated them via IC, scenario is called <em>Synchrotron Self Compton</em> (SSC). When external photons are present IC does not need the synchrotron field. Such process is referred as <em>External Inverse Compton</em></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial II: Adding the IC ">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial II: Adding the IC
</div>
</div>
<div class="callout-body-container callout-body">
<p>We are going now to calculate the IC spectrum using the CMB as the radiation field:</p>
<div id="724be957" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.constants <span class="im">import</span> c</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>IC <span class="op">=</span> naima.models.InverseCompton(e_pl, seed_photon_fields<span class="op">=</span>[<span class="st">'CMB'</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sed_ic_cbm <span class="op">=</span> IC.sed(spectrum_energy, distance<span class="op">=</span><span class="fl">1.5</span><span class="op">*</span>u.kpc, seed<span class="op">=</span><span class="st">"CMB"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>fig2 <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ax.loglog(spectrum_energy,sed_syn,lw<span class="op">=</span><span class="dv">3</span>,label<span class="op">=</span><span class="st">'Syncrotron'</span>,c<span class="op">=</span>naima.plot.color_cycle[<span class="dv">1</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>ax.loglog(spectrum_energy,sed_ic_cbm,lw<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">'Inverse Compton CBM'</span>, c<span class="op">=</span>naima.plot.color_cycle[<span class="dv">2</span>])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">1e-12</span>, <span class="fl">1e-5</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Photon energy [</span><span class="sc">{0}</span><span class="st">]'</span>.<span class="bu">format</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        spectrum_energy.unit.to_string(<span class="st">'latex_inline'</span>)))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'$E^2 dN/dE$ [</span><span class="sc">{0}</span><span class="st">]'</span>.<span class="bu">format</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        sed_syn.unit.to_string(<span class="st">'latex_inline'</span>)))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap4_1_files/figure-html/cell-3-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="chap4_1_files/figure-html/cell-3-output-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<section id="case-of-study-active-galactic-nuclei" class="level4">
<h4 class="anchored" data-anchor-id="case-of-study-active-galactic-nuclei">Case of study: Active Galactic Nuclei</h4>
<p>As we saw, blazars are a particular classification of AGNs with their relativistic plasma jet oriented close to the line of sight. Because blazars have their jets pointing towards, the full emission comes from a relatively small region (the width of the jets) and so these objects can exhibit rapid variability (due to the smaller causally connected regions). The typical SED for AGNS is characterized by a synchrotron component extending from radio to X-ray frequencies, and a second component peaking at gamma-ray frequencies due to either inverse-Compton radiation (or from hadronic processes). The plot below shows the spectral energy distribution of nearby (z = 0.044) blazar 1ES 2344+514 during a flaring and a quiet state.</p>
</section>
</div>
</div>
</section>
<section id="lightcurves-and-flares" class="level4">
<h4 class="anchored" data-anchor-id="lightcurves-and-flares">Lightcurves and flares</h4>
<p>In addition to the SED one could measure the light-curve or number of photons (or energy density) as a function of time. This is usually done to illustrate the variability of the source. For AGNs it is possible to make the lightcurve for different energy ranges, and therefore addressing different emission mechanism.</p>
<p>Sometimes it is possible to observe a <em>flare</em> in high energy photon range but with no activity detected in soft/hard X-ray. These are called <strong>orphan flare</strong>. This is interesting since in the SSC scenarios the X-rays (due to synchrotron) and TeV gamma-rays (due IC scattering) must be correlated. An orphan flare is therefore an indication that SSC scenario might be excluded, while the EC is still possible. As we will see also an hadronic scenario in which TeV photons come from <span class="math inline">\(\pi^0\)</span> is still possible.</p>
</section>
</section>
</section>
<section id="hadronic-models" class="level2">
<h2 class="anchored" data-anchor-id="hadronic-models">Hadronic models</h2>
<section id="pion-decay" class="level3">
<h3 class="anchored" data-anchor-id="pion-decay">Pion decay</h3>
<p>Accelerated protons in the source can produce charged and neutral pions via proton-proton interaction. In this context a CR proton with energy <span class="math inline">\(E_p\)</span> and momentum <span class="math inline">\(p_p\)</span> interacts with the ISM at rest in the process:</p>
<p><span class="math display">\[ p + p \rightarrow p + p + \pi^0\]</span></p>
<p>There is a threshold for this production given by the invariant:</p>
<p><span class="math display">\[s = E_{CoM}^2 = (E_p + m_p)^2 - p_p^2 = (2m_p^2 + m_{\pi^0}^2)^2 \]</span></p>
<p>As we saw in lesson 2, the available energy to produce particles can be derived as:</p>
<p><span class="math display">\[\epsilon = E_{CoM} - 2m_p \]</span></p>
<p>The energy threshod to produce a pion at rest is then:</p>
<p><span class="math display">\[E_{p,th} = \frac{m_{\pi^0}^2 + 4m_p m_{\pi^0} + 2m_p^2}{ 2 m_p} = \frac{m_{\pi^0}^2}{2m_p} + 2 m_{\pi^0} + m_p\]</span></p>
<div id="898f5013" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mp <span class="op">=</span> <span class="fl">938.28</span> <span class="co">#MeV</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mpion <span class="op">=</span> <span class="fl">134.976</span> <span class="co">#MeV</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="ss">f"Kinetic energy threshold for pion production </span><span class="sc">{</span>(mpion<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>mp) <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>mpion)<span class="sc">:.1f}</span><span class="ss"> MeV"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kinetic energy threshold for pion production 279.7 MeV</code></pre>
</div>
</div>
<p>The pions are produced with the same power law as the parent proton. Neutral pions decay rapidly (<span class="math inline">\(\tau = 8.4 \times 10^{-17}\)</span> ns, compared to 26 ns of charged pions) in to two photons. In the CoM each photon from the pion decay has an energy of <span class="math inline">\(E^{*}_\gamma = m_{\pi^0}/2 \approx 70\)</span> MeV as we saw for the 2-body decay. In order to calculate the energy in the lab system we need to make a lorentz transformation:</p>
<p><span class="math display">\[E_\gamma = \gamma(E^{*}_\gamma + \beta_\pi p^{*}_\gamma \cos\theta^{*})\]</span></p>
<p>where (<span class="math inline">\(^*\)</span>) denotes the CoM. Since pion is an isoscalar the decay is isotropic the limits are determined by <span class="math inline">\(\cos\theta^{*} = \pm 1\)</span>. These limits are:</p>
<p><span class="math display">\[\frac{m_{\pi^0}}{2}\sqrt{\frac{1-\beta}{1+\beta}} \leq E_\gamma \leq \frac{m_{\pi^0}}{2}\sqrt{\frac{1+\beta}{1-\beta}}\]</span></p>
<p>where <span class="math inline">\(\beta\)</span> is the velocity of the parent pion and we used <span class="math inline">\(p^* = E^*\)</span> for photons.</p>
<section id="pion-bump" class="level4">
<h4 class="anchored" data-anchor-id="pion-bump">Pion bump</h4>
<p>But what is the distribution of photons? Since the decay is isotropic in the CoM:</p>
<p><span class="math display">\[\mathrm{d} N  = \frac{1}{4\pi} d\Omega = \frac{1}{2} \mathrm{d}\cos\theta^*\]</span></p>
<p>Using the lorentz transformation from CoM system and the lab system we can express: <span class="math inline">\(\mathrm{d}\cos\theta^* = \mathrm{d}E_\gamma/(\gamma \beta_\pi p^*_\gamma) = 2\mathrm{d} E/ (\gamma \beta_\pi m_{\pi^0})\)</span> and thus:</p>
<p><span class="math display">\[\mathrm{d} N = \frac{\mathrm{d} E}{\gamma \beta_\pi m_{\pi^0}}\]</span></p>
<p>Then the distribution of photons <span class="math inline">\(\mathrm{d}N/\mathrm{d}E = \mathrm{\; const.}\)</span> ie is constant on a box from <span class="math inline">\(E_{min}\)</span> to <span class="math inline">\(E_{max}\)</span> when plotted as <span class="math inline">\(\log(E_\gamma)\)</span>. If many pions are decaying, the distribution of photons will be superpossition of boxes around <span class="math inline">\(m_{\pi^0}\)</span>. This is the so-called <em>pion bump</em>.</p>
<p><a href="images/pion_bump.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="images/pion_bump.png" class="img-fluid"></a></p>
</section>
<section id="pion-bump-in-snr-with-molecular-cloud" class="level4">
<h4 class="anchored" data-anchor-id="pion-bump-in-snr-with-molecular-cloud">Pion bump in SNR with Molecular Cloud</h4>
<p>In 2013 Fermi (a gamma-ray satellite) confirmed the pion-bump in two old SNRs with Molecular Cloud.</p>
<p><a href="https://inspirehep.net/files/6ff98851515f2a9d31b6faabd53dc1b7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="https://inspirehep.net/files/6ff98851515f2a9d31b6faabd53dc1b7.png" class="img-fluid"></a></p>
<p>So did we find the sources of Galactic Cosmic Rays? No.&nbsp;The steep gamma-ray spectrum at high energies suggests that the acceleration is not very active any more (as expected from old SNRs) and hence, even though there might be some particle acceleration these are not the sources of Galactic Cosmic Rays.</p>
</section>
</section>
</section>
<section id="galactic-gamma-ray-diffuse-emission" class="level2">
<h2 class="anchored" data-anchor-id="galactic-gamma-ray-diffuse-emission">Galactic gamma-ray diffuse emission</h2>
<p>Diffuse gamma-ray emission is that not associated with a particular source. Fermi-LAT observed gamma-ray counts in the energy range from 200 MeV to 100 GeV. The signal is dominated by the diffuse Galactic emission, which is strongest in the plane of our Galaxy and toward the Galactic center but present all over the sky. The following shows the diffuse gamma-ray emission from 200 MeV to 100 GeV.</p>
<p>The gamma-ray diffuse emission are produced primarly the <span class="math inline">\(\pi^0\)</span> produced by interactions of cosmic rays protons with the ISM. The Inverse Compton scattering on star light is less important as well as bremsstrahlung (braking radiation). In the plot below the models are split into the three basic emission components:</p>
<ul>
<li><span class="math inline">\(\pi^0\)</span>-decay (red, long-dashed)</li>
<li>IC (green, dashed),</li>
<li>and bremsstrahlung (cyan, dash-dotted).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/GalacticCenter_Fermi.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="quarto-lightbox-gallery-12" title="Source: Taken from arXiv:1202.4039"><img src="images/GalacticCenter_Fermi.jpg" class="img-fluid figure-img" alt="Source: Taken from arXiv:1202.4039"></a></p>
<figcaption>Source: Taken from <a href="http://arxiv.org/abs/1202.4039">arXiv:1202.4039</a></figcaption>
</figure>
</div>
</section>
<section id="extragalactic-background-light" class="level2">
<h2 class="anchored" data-anchor-id="extragalactic-background-light">Extragalactic Background Light</h2>
<p>As we saw, VHE gamma-rays (<span class="math inline">\(E_\gamma =30\)</span> GeV) have a limited horizon due to their interaction with the CMB and the <a href="http://en.wikipedia.org/wiki/Extragalactic_background_light">Extragalactic Background Light (EBL)</a>. The EBL is difficult to measure directly due to strong foregrounds from our solar system and the Galaxy. The TeV signal of distant AGNs are (partially) absorved at the highest energies by the ELB. The absortion is energy dependent and increases with distance. Observations of very far distant AGNs can be used to put constrains on the amount of EBL. However it is difficult to distinguish between an intrinsic softening of blazar spectra and a softening caused by the interaction with low energy EBL photons. The plot below shows the gamma-ray horizon and measurements from some Imaging Atmospheric Cherenkov Telescopes (IACTs) up to z=0.536.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ELB.png" class="lightbox" data-glightbox="description: .lightbox-desc-13" data-gallery="quarto-lightbox-gallery-13" title="Source: Taken from arXiv:0904.0774v2"><img src="images/ELB.png" class="img-fluid figure-img" alt="Source: Taken from arXiv:0904.0774v2"></a></p>
<figcaption>Source: Taken from <a href="http://arxiv.org/abs/0904.0774">arXiv:0904.0774v2</a></figcaption>
</figure>
</div>
</section>
<section id="gamma-ray-detection" class="level2">
<h2 class="anchored" data-anchor-id="gamma-ray-detection">Gamma-ray Detection</h2>
<section id="the-atmosphere" class="level3">
<h3 class="anchored" data-anchor-id="the-atmosphere">The atmosphere</h3>
<p>The Earth’s atmosphere is opaque to photons with energy above 10 eV, meaning that to observe gamma-rays directly we need to place the detector above the atmosphere. A turning point in gamma-ray astronomy was the launch of the first satellite-borne telescope, SAS-2, in 1972.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="http://scienceofdoom.files.wordpress.com/2009/11/800px-atmospheric_electromagnetic_opacity-svg.png" class="lightbox" data-glightbox="description: .lightbox-desc-14" data-gallery="quarto-lightbox-gallery-14" title="Source: scienceofdoom.wordpress.com"><img src="http://scienceofdoom.files.wordpress.com/2009/11/800px-atmospheric_electromagnetic_opacity-svg.png" class="img-fluid figure-img" alt="Source: scienceofdoom.wordpress.com"></a></p>
<figcaption>Source: scienceofdoom.wordpress.com</figcaption>
</figure>
</div>
<p>The mayor limitation of satellite experiments is their low area which limits their use to <span class="math inline">\(\leq 100\)</span> GeV. At 100 GeV is when electromagnetic showers from the initial photon can be detected in ground-based telescopes.</p>
</section>
<section id="cherenkov-emission" class="level3">
<h3 class="anchored" data-anchor-id="cherenkov-emission">Cherenkov emission</h3>
<p>When relativistic particles traverse a medium at a speed greater than the speed of light in that medium it can induce Cherenkov radiation. Cherenkov light is emitted in the UV and blue region in a narrow cone with angle:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/Cherenkov.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="images/Cherenkov.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<p><span class="math display">\[\cos \theta = \frac{ct/n}{\beta c t} = \frac{1}{\beta n}\]</span></p>
<p>In the relativistic limit <span class="math inline">\(\beta \sim 1\)</span> we can write:</p>
<p><span class="math display">\[\sin \theta = \sqrt{1 - \frac{1}{n^2}} = \sqrt{\frac{n^2 - 1}{n^2}} = \sqrt{\frac{(n-1)(n+1)}{n^2}} \approx \sqrt{2(n-1)}\]</span></p>
<p>In the atmosphere the spectral index depends on the altitude (same as density and pressure):</p>
<p><span class="math display">\[n = 1 + \epsilon_0 e^{-h/h_0} \]</span></p>
<p>where <span class="math inline">\(\epsilon_0 \simeq 2.8 \times 10^{-4}\)</span> at sea level.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial III: Plot of the Cherenkov angle as funcion of the spectral index">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial III: Plot of the Cherenkov angle as funcion of the spectral index
</div>
</div>
<div class="callout-body-container callout-body">
<div id="44aa63f4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>diffn <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co">#n - 1 form 0.0001 to 1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#lets remove the values that will give errors in the arcsin:</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>diffn <span class="op">=</span> diffn[np.where(np.sqrt(<span class="dv">2</span><span class="op">*</span>diffn) <span class="op">&lt;=</span> <span class="fl">1.</span>)]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#In the relativistic limit </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ax.plot(diffn, np.degrees(np.arcsin(np.sqrt(<span class="dv">2</span><span class="op">*</span>diffn))))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">"log"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">"log"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"n - 1 "</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$\theta_C$ ($^\circ$)"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>thetaw <span class="op">=</span> np.degrees(np.arcsin(np.sqrt(<span class="dv">2</span><span class="op">*</span>(<span class="fl">1.33</span> <span class="op">-</span><span class="dv">1</span>))))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="vs">r"Cherenkov angle in water: $\theta_C = </span><span class="sc">%.2f</span><span class="vs">^{\circ}$"</span><span class="op">%</span>thetaw)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#For the atmosphere n = 1.0003</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>thetaatm <span class="op">=</span> np.degrees(np.arcsin(np.sqrt(<span class="dv">2</span><span class="op">*</span>(<span class="fl">1.0003</span> <span class="op">-</span><span class="dv">1</span>))))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="vs">r"Cherenkov angle in the atmosphere: $\theta_C = </span><span class="sc">%.2f</span><span class="vs">^{\circ}$"</span><span class="op">%</span>thetaatm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap4_1_files/figure-html/cell-5-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="chap4_1_files/figure-html/cell-5-output-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Cherenkov angle in water: $\theta_C = 54.33^{\circ}$
Cherenkov angle in the atmosphere: $\theta_C = 1.40^{\circ}$</code></pre>
</div>
</div>
</div>
</div>
<section id="number-of-photons" class="level4">
<h4 class="anchored" data-anchor-id="number-of-photons">Number of photons</h4>
<p>The number of photons from Cherenkov radiation follows the <em>Frank-Tamn</em> formula:</p>
<p><span class="math display">\[\frac{\mathrm{d}N}{\mathrm{d}x} = 2 \pi \alpha z^2\int_{\lambda_1}^{\lambda_2} \sin^2\theta \frac{\mathrm{d}\lambda}{\lambda^2}\]</span></p>
<p>For relativistic particles, <span class="math inline">\(\beta \sim 1\)</span> in water <span class="math inline">\(n = 1.33\)</span> the Cherenkov spectrum is:</p>
<div id="1c58c028" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.constants <span class="im">as</span> cte</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> cte.alpha <span class="co">#fine structure constant</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>wl <span class="op">=</span> np.arange(<span class="dv">200</span>, <span class="dv">500</span>,<span class="dv">1</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">1.33</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ax.plot(wl, <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> alpha <span class="op">*</span> ( <span class="dv">1</span><span class="op">-</span> <span class="dv">1</span><span class="op">/</span>n<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>wl<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"$\lambda$ [nm]"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$\frac{\mathrm</span><span class="sc">{d}</span><span class="vs">N_\gamma}{\mathrm</span><span class="sc">{d}</span><span class="vs">x\mathrm</span><span class="sc">{d}</span><span class="vs">\lambda}$ (photons nm$^{-2}$)"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap4_1_files/figure-html/cell-6-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="chap4_1_files/figure-html/cell-6-output-1.svg" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="atmospheric-extintion." class="level4">
<h4 class="anchored" data-anchor-id="atmospheric-extintion.">Atmospheric extintion.</h4>
<p>Once in the atmosphere, the Cherenkov light can suffer absortion and scattering due to several processes:</p>
<ul>
<li>Rayleigh scattering:</li>
</ul>
<p><span class="math display">\[ I = I_0 \frac{8\pi^4 \alpha^2}{\lambda^4 R^2}(1 - \cos^2\theta)\]</span></p>
<p>where <span class="math inline">\(R\)</span> is the distance to the particle and <span class="math inline">\(\theta\)</span> the scattering angle.</p>
<ul>
<li>Absortion by ozone, above 20 km.</li>
<li>Aerosol, dust. Independent of <span class="math inline">\(\lambda\)</span>.</li>
</ul>
<p><a href="images/Cherenkov_NSB_spectra.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="images/Cherenkov_NSB_spectra.png" class="img-fluid"></a></p>
<p>This processes change the Cherenkov spectrum dependending on the altitude. In ice on the other hand, there is no UV absorption and the Cherenkov spectrum keeps the <span class="math inline">\(1/\lambda^2\)</span> tendency.</p>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Source: Wikipedia</span>
<span class="glightbox-desc lightbox-desc-12">Source: Taken from <a href="http://arxiv.org/abs/1202.4039">arXiv:1202.4039</a></span>
<span class="glightbox-desc lightbox-desc-13">Source: Taken from <a href="http://arxiv.org/abs/0904.0774">arXiv:0904.0774v2</a></span>
<span class="glightbox-desc lightbox-desc-14">Source: scienceofdoom.wordpress.com</span>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap4_0.html" class="pagination-link  aria-label=" &lt;span="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap4_2.html" class="pagination-link" aria-label="<span class='chapter-number'>12</span>&nbsp; <span class='chapter-title'>Gamma-rays, Cosmic-Rays and Neutrinos</span>">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Gamma-rays, Cosmic-Rays and Neutrinos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","descPosition":"bottom","loop":false,"closeEffect":"zoom","selector":".lightbox"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>