<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Astroparticle Physics - 8&nbsp; Muons and Neutrinos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap3_2.html" rel="next">
<link href="./chap3_0.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap2_0.html">Cosmic Rays</a></li><li class="breadcrumb-item"><a href="./chap3_1.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Muons and Neutrinos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Astroparticle Physics</a> 
        <div class="sidebar-tools-main">
    <a href="./Astroparticle-Physics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Physics Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Some Basic Concents and Notations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Time and Coordinate Systems in Astronomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Special Relativity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to Cosmology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Cosmic Rays</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">What are Cosmic Rays?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Extra-Galactic Cosmic Rays: The Knee and Beyond</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cosmic Rays in the Atmosphere</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Muons and Neutrinos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Particles Underground</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Multimessenger Astronomy</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Gamma-ray Astronomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Gamma-rays, Cosmic-Rays and Neutrinos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Neutrino Astronomy</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Dark Matter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dark Matter</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">References</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#muons-and-neutrinos-production" id="toc-muons-and-neutrinos-production" class="nav-link active" data-scroll-target="#muons-and-neutrinos-production">Muons and Neutrinos Production</a></li>
  <li><a href="#muon-fluxes" id="toc-muon-fluxes" class="nav-link" data-scroll-target="#muon-fluxes">Muon Fluxes</a>
  <ul class="collapse">
  <li><a href="#energy-regimes-of-muon-fluxes" id="toc-energy-regimes-of-muon-fluxes" class="nav-link" data-scroll-target="#energy-regimes-of-muon-fluxes">Energy Regimes of Muon Fluxes</a></li>
  <li><a href="#muon-flux-analytical-approximation" id="toc-muon-flux-analytical-approximation" class="nav-link" data-scroll-target="#muon-flux-analytical-approximation">Muon Flux Analytical Approximation</a></li>
  <li><a href="#measured-muon-flux" id="toc-measured-muon-flux" class="nav-link" data-scroll-target="#measured-muon-flux">Measured Muon Flux</a></li>
  <li><a href="#muon-bundles" id="toc-muon-bundles" class="nav-link" data-scroll-target="#muon-bundles">Muon Bundles</a></li>
  <li><a href="#muon-anti-muon-charge-ratio" id="toc-muon-anti-muon-charge-ratio" class="nav-link" data-scroll-target="#muon-anti-muon-charge-ratio">Muon anti-Muon Charge Ratio</a></li>
  </ul></li>
  <li><a href="#neutrinos-fluxes" id="toc-neutrinos-fluxes" class="nav-link" data-scroll-target="#neutrinos-fluxes">Neutrinos Fluxes</a>
  <ul class="collapse">
  <li><a href="#neutrino-fluxes-and-kinematics" id="toc-neutrino-fluxes-and-kinematics" class="nav-link" data-scroll-target="#neutrino-fluxes-and-kinematics">Neutrino Fluxes and Kinematics</a></li>
  <li><a href="#fluxes-as-function-of-zenith" id="toc-fluxes-as-function-of-zenith" class="nav-link" data-scroll-target="#fluxes-as-function-of-zenith">Fluxes as Function of Zenith</a></li>
  <li><a href="#prompt-fluxes" id="toc-prompt-fluxes" class="nav-link" data-scroll-target="#prompt-fluxes">Prompt Fluxes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap2_0.html">Cosmic Rays</a></li><li class="breadcrumb-item"><a href="./chap3_1.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Muons and Neutrinos</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Muons and Neutrinos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The plot below shows the particle flux surviving after a certain altitude.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/cr_fig3_07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1" title="Source: Particle Data Group"><img src="images/cr_fig3_07.png" class="img-fluid figure-img" alt="Source: Particle Data Group"></a></p>
<figcaption>Source: Particle Data Group</figcaption>
</figure>
</div>
<p>We can extract different information from this plot:</p>
<ul>
<li><p>Primaries dominate up to 9 km, secondaries (electrons, pions) roughly follow the primary shape. Muons and neutrinos are continously produced.</p></li>
<li><p>Vertical fluxes for <span class="math inline">\(E &gt; 1\)</span> GeV. Points show the <span class="math inline">\(\mu^-\)</span> measurements. Muons and neutrinos are produced in decays of mesons which are themselves produced by interactions of CR particles with air nuclei.</p></li>
<li><p>They are the dominant flux at sea level and the only ones that can penetrate deep underground.</p></li>
</ul>
<p>Electrons and nucleons fluxes above 1 GeV/<span class="math inline">\(c\)</span> are about 0.2 and 2 m<span class="math inline">\(^{-2}\)</span> s<span class="math inline">\(^{-1}\)</span> sr<span class="math inline">\(^{-1}\)</span> at sea level. Nucleons are the degraded remnants of the primary cosmic radiation. At sea level about 1/3 are neutrons.</p>
<section id="muons-and-neutrinos-production" class="level2">
<h2 class="anchored" data-anchor-id="muons-and-neutrinos-production">Muons and Neutrinos Production</h2>
<p>The most important channels for muon and neutrino production are:</p>
<ul>
<li><p>Two body decays <span class="math display">\[\pi^{\pm} \rightarrow \mu^{\pm} + \nu_{\mu}({ \bar \nu_\mu}) \mathrm{\;\; (\sim 100\%)}\]</span> <span class="math display">\[K^{\pm} \rightarrow \mu^{\pm} + \nu_{\mu}({\bar \nu_\mu}) \mathrm{\;\; (\sim 63.5\%)}\]</span></p></li>
<li><p>Three body decay <span class="math display">\[K_L \rightarrow \pi^{\pm} e^{\pm}\nu_e({\bar \nu_e}) \mathrm{\;\; (\sim 38.7\%)}\]</span></p></li>
</ul>
<p>At lower energies, the muon decay is also important:</p>
<p><span class="math display">\[ \mu^{\pm} \rightarrow e^{\pm} + \nu_{e}({\bar \nu_e}) + {\bar \nu_{\mu}}(\nu_\mu)\]</span></p>
<p>For each of the 2-body decay channels, assuming the muon always decay the neutrino flavor ratio is:</p>
<p><span class="math display">\[\mathbf{ \nu_\mu : \nu_e = 2:1}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Mean free path for mesons, $\pi$, $K$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mean free path for mesons, <span class="math inline">\(\pi\)</span>, <span class="math inline">\(K\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Charged pions and Kaons can interact or decay. Both processes have a mean free path and one or the other will dominate depending on which mean free path is larger.</p>
<p>The <strong>decay mean free path</strong> of pions is given by <span class="math inline">\(l^d_\pi =\gamma  c \tau_\pi\)</span> where <span class="math inline">\(\gamma\)</span> is the Lorentz factor of the pion. Multiplying for density we have the <strong>density decay mean free path</strong> as:</p>
<p><span class="math display">\[\lambda^d_\pi = \rho(X) \gamma  c \tau_\pi\]</span></p>
<p>However the atmosphere density depends on the atmospheric depth as <span class="math inline">\(\rho(X) = X/h_0\)</span>. In units of <em>slant depth</em>, <span class="math inline">\(X_{sd} = X/\cos\theta\)</span> and expanding <span class="math inline">\(\gamma = E / m_\pi c^2\)</span> we can rewrite the density decay free path as:</p>
<p><span class="math display">\[\frac{1}{\lambda^d_\pi(E)} = \frac{m_\pi c^2 h_0}{E c \tau_\pi X_{sd} \cos \theta} = \frac{\epsilon_\pi}{E X_{sd} \cos\theta}\]</span></p>
<p>where <span class="math inline">\(E\)</span>, <span class="math inline">\(m_\pi\)</span>, <span class="math inline">\(\tau_\pi\)</span> are the pion energy, mass and lifetime and we defined:</p>
<p><span class="math display">\[\epsilon_\pi = \frac{c\tau_\pi}{m_\pi c^2 h_0}\]</span></p>
<p>as a <em>critial energy</em>. The crital energy is such that the decay time equals the vertical atmospheric depth <span class="math inline">\(\lambda^d_\pi(\epsilon_\pi) = X_{sd} \cos\theta = X\)</span>.</p>
<p>The <strong>interaction mean free path</strong> is the same as nucleon <span class="math inline">\(\lambda_\pi = A m_\pi/\sigma_\pi^{air}\)</span> which as we saw is indenpendent of <span class="math inline">\(X\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Critical energy  for mesons, $\pi$, $K$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Critical energy for mesons, <span class="math inline">\(\pi\)</span>, <span class="math inline">\(K\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Decay or interaction dominates depending on whether <span class="math inline">\(1/\lambda^d_\pi\)</span> or <span class="math inline">\(1/\lambda_\pi\)</span> is larger. This in turns depends on the ratio between the energy <span class="math inline">\(E\)</span> and the critical energy <span class="math inline">\(\epsilon_\pi\)</span>. For example, the value of the crital energy for pions is given by:</p>
<p><span class="math display">\[\epsilon_\pi = \frac{c\tau_\pi}{m_\pi c^2 h_0} \approx 115 \;\mathrm{ GeV}\]</span></p>
<p>So we can distinguish two regimes.</p>
<ul>
<li><p>For <span class="math inline">\(E \gg \epsilon_\pi\)</span> decay length is much larger than the atmospheric depth, so interaction dominates.</p></li>
<li><p>For <span class="math inline">\(E \ll \epsilon_\pi\)</span> decay dominates is much shorter than the atmospheric depth, so the pion will likely decay before interacting.</p></li>
</ul>
<p>The same formulas can be derived for Kaons.</p>
</div>
</div>
</section>
<section id="muon-fluxes" class="level2">
<h2 class="anchored" data-anchor-id="muon-fluxes">Muon Fluxes</h2>
<p>The muon energy spectrum at sea level is a direct consequence of the meson source spectrum. Unlike electrons, muons will decay before reaching the ground in the GeV energy range. The muon decay length is given by:</p>
<p><span class="math display">\[ d_\mu = \gamma \tau_\mu c\]</span></p>
<p>Where <span class="math inline">\(\tau_\mu\)</span> is the muon lifetime of the order of <span class="math inline">\(2.2\times 10^{-6}\)</span> s. So for a muon of 1 GeV we have:</p>
<div id="2a4ef22b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>lifetime <span class="op">=</span> <span class="fl">2.1969811e-6</span> <span class="co"># muon lifetime in seconds</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.constants <span class="im">as</span> cte</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cspeed <span class="op">=</span> cte.c</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>muon_mass <span class="op">=</span> cte.value(<span class="st">"muon mass energy equivalent in MeV"</span>) <span class="op">*</span> <span class="fl">1e-3</span> <span class="co"># in GeV</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>energy <span class="op">=</span> <span class="dv">1</span> <span class="co"># GeV</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"d = </span><span class="sc">{</span>(energy<span class="op">/</span>muon_mass)<span class="op">*</span>lifetime<span class="op">*</span>cspeed<span class="op">*</span><span class="fl">1e-3</span><span class="sc">:.2f}</span><span class="ss"> km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d = 6.23 km</code></pre>
</div>
</div>
<p>Compared to the typical atmospheric altitude of <span class="math inline">\(h \sim 15\)</span> km it means that at those energies, muons will not reach the ground.</p>
<section id="energy-regimes-of-muon-fluxes" class="level3">
<h3 class="anchored" data-anchor-id="energy-regimes-of-muon-fluxes">Energy Regimes of Muon Fluxes</h3>
<p>Three different regimes are distinguishable:</p>
<ul>
<li><span class="math inline">\(E_\mu \leq \epsilon_\mu\)</span>, where <span class="math inline">\(\epsilon_\mu \sim 1\)</span> GeV. This critical energy is when interaction probability and decay probability start to be comparable. Even more the muon energy losses become important. As we saw energy losses via ionization is almost constant, for muons is about <span class="math inline">\(\sim 2\)</span> MeV/(g/cm<span class="math inline">\(^{2}\)</span>) in air (and mostly independent on the material). However this is true only above energies of 1 GeV, below ionization losses increase drastically as can be seen in the figure below.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_energylosses_air.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/muon_energylosses_air.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<ul>
<li><p><span class="math inline">\(\epsilon_\mu \leq E_\mu \leq \epsilon_{\pi,K}\)</span>, where <span class="math inline">\(\epsilon_\pi = 115 \;\mathrm{GeV}\)</span> and <span class="math inline">\(\epsilon_K = 850 \;\mathrm{GeV}\)</span>. In this range all mesons decay and muons spectrum follows the same of the parent spectrum of mesons and hence that of the primary CRs. The muon is almost independent of the zenith angle.</p></li>
<li><p><span class="math inline">\(E_\mu \gg \epsilon_{\pi,K}\)</span>, Mesons interaction length starts to be comparable to their decay length. This happens first for inclined showers and so the muon flux gets suppressed while it also starts to depend on the zenith angle (ie on the density of the atmosphere).</p></li>
</ul>
<p>At even highers energies, above 1 TeV in air, muons will also start to loose energie via other radiative process (we will see that below when talking about muons underground).</p>
</section>
<section id="muon-flux-analytical-approximation" class="level3">
<h3 class="anchored" data-anchor-id="muon-flux-analytical-approximation">Muon Flux Analytical Approximation</h3>
<p>An approximate extrapolation formula valid when muon decay is negligible (<span class="math inline">\(E_\mu &gt; 100/\cos\theta\)</span> GeV) and the curvature of the Earth can be neglected (<span class="math inline">\(\theta &lt; 70^{\circ}\)</span>) is given by the Gaisser parametrization:</p>
<p><span class="math display">\[\frac{\mathrm{d}N_\mu}{\mathrm{d}E_\mu \mathrm{d}\Omega} = \frac{0.14}{\mathrm{cm^2\;s\;sr\;GeV}}\left(\frac{E_\mu}{\mathrm{GeV}}\right)^{-2.7}\left[F_\pi(E_\mu, \theta) + F_K(E_\mu,\theta)\right]\]</span></p>
<p>where <span class="math inline">\(F_\pi\)</span> and <span class="math inline">\(F_K\)</span> represent the contributions from pions and kaons, respectively:</p>
<p><span class="math display">\[F_\pi(E_\mu, \theta) = \frac{1}{1+\frac{1.1 E_\mu \cos\theta}{115 \;\mathrm{GeV}}}\]</span></p>
<p><span class="math display">\[F_K(E_\mu, \theta) = \frac{0.054}{1+\frac{1.1 E_\mu \cos\theta}{850\;\mathrm{GeV}}}\]</span></p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial I:  Plot the muon flux for two different angles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial I: Plot the muon flux for two different angles
</div>
</div>
<div class="callout-body-container callout-body">
<div id="ac3e8fe1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">"STIXGeneral"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'axes.labelsize'</span>: <span class="dv">20</span>})</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'legend.fontsize'</span>: <span class="dv">20</span>})</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'figure.figsize'</span>: [<span class="dv">8</span>, <span class="dv">6</span>]})</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.labelsize'</span>] <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.labelsize'</span>] <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.major.width'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.minor.width'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.major.pad'</span>] <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.direction'</span>] <span class="op">=</span> <span class="st">'in'</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.size'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.minor.size'</span>] <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.width'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.minor.width'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.pad'</span>] <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.direction'</span>] <span class="op">=</span> <span class="st">'in'</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'legend.frameon'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'lines.linewidth'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.linewidth'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> muons(cangle, E):</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fl">1.</span><span class="op">/</span>(<span class="fl">1.</span><span class="op">+</span> <span class="fl">1.1</span><span class="op">*</span>E<span class="op">*</span>cangle<span class="op">/</span><span class="fl">115.</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="fl">0.054</span><span class="op">/</span>(<span class="fl">1.</span><span class="op">+</span> <span class="fl">1.1</span><span class="op">*</span>E<span class="op">*</span>cangle<span class="op">/</span><span class="fl">850.</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.14</span> <span class="op">*</span>E<span class="op">**-</span><span class="fl">2.7</span> <span class="op">*</span>(a <span class="op">+</span> b)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">"log"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">"log"</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">1e-5</span>, <span class="fl">3e-1</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$E_\mu^</span><span class="sc">{2.7}</span><span class="vs"> dN_\mu/dE_\mu [cm^{-2}s^{-1} (GeV)^</span><span class="sc">{1.7}</span><span class="vs">]$"</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"$E_\mu(GeV)$"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> np.arange(<span class="fl">1e0</span>, <span class="fl">1e6</span>, <span class="dv">10</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>ax.plot(E, E<span class="op">**</span><span class="fl">2.7</span><span class="op">*</span>muons(np.cos(<span class="dv">75</span><span class="op">*</span>np.pi<span class="op">/</span><span class="fl">180.</span>),E), label<span class="op">=</span><span class="vs">r"$\theta = 75^{\circ}$"</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>ax.plot(E, E<span class="op">**</span><span class="fl">2.7</span><span class="op">*</span>muons(np.cos(<span class="dv">0</span><span class="op">*</span>np.pi<span class="op">/</span><span class="fl">180.</span>),E), label<span class="op">=</span><span class="vs">r"$\theta = 0^{\circ}$"</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_1_files/figure-html/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="chap3_1_files/figure-html/cell-3-output-1.png" width="564" height="533" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="measured-muon-flux" class="level3">
<h3 class="anchored" data-anchor-id="measured-muon-flux">Measured Muon Flux</h3>
<p>In reality below 10 GeV muon decay and energy loss become important and the Gaisser parametrization overestimates the muon flux as can be seen in the plot below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/atmmu.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4" title="Source: Particle Data Group"><img src="images/atmmu.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%" alt="Source: Particle Data Group"></a></p>
<figcaption>Source: Particle Data Group</figcaption>
</figure>
</div>
<p>As can be seen from the measured muon flux has the following characteristics:</p>
<ul>
<li>Muons are the most numerous charged particles at sea level</li>
<li>The mean energy of muons at the ground is <span class="math inline">\(\sim\)</span> 4 GeV.</li>
<li>The integral intensity of vertical muons above 1 GeV/c at sea level is <span class="math inline">\(\approx 70 \mathrm{m}^{-2} \mathrm{s}^{-1} \mathrm{sr}^{-1}\)</span> or <span class="math inline">\(\approx 1 \mathrm{cm}^{-2} \mathrm{min}^{-1}\)</span>.</li>
</ul>
</section>
<section id="muon-bundles" class="level3">
<h3 class="anchored" data-anchor-id="muon-bundles">Muon Bundles</h3>
<p>Sometimes muons also come in groups or <strong>bundles</strong> of parallel muons originated from the same primary CR. Muon bundles sometime look like a single high energy muon. The multiplicity (number of muons in the bundle) if can be measured is correlated with the mass of the orignal CR. The image belowe shows a muon-bundle event observed with the MACRO underground detector.</p>
<p><a href="images/macro-bundle.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/macro-bundle.png" class="img-fluid"></a></p>
</section>
<section id="muon-anti-muon-charge-ratio" class="level3">
<h3 class="anchored" data-anchor-id="muon-anti-muon-charge-ratio">Muon anti-Muon Charge Ratio</h3>
<p>The muon charge ratio reflects the excess of <span class="math inline">\(\pi^+\)</span> over <span class="math inline">\(\pi^-\)</span> and <span class="math inline">\(K^+\)</span> over <span class="math inline">\(K^-\)</span> and the fact that there are more protons than neutrons in the primary spectrum.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_ratio.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6" title="Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)"><img src="images/muon_ratio.png" class="img-fluid figure-img" style="width:50.0%" alt="Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)"></a></p>
<figcaption>Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)</figcaption>
</figure>
</div>
<p>The increase with energy of the ratio is due to an increasing importance of kaons coming from the process $ p + N + K^+$.</p>
<p>Assuming the following reactions for the production of <span class="math inline">\(\pi^+\)</span> and <span class="math inline">\(\pi^{-}\)</span>:</p>
<p><span class="math display">\[ p + N \rightarrow p^\prime + N^\prime  + k \pi^+ + k \pi^- + r\pi^0 \]</span> <span class="math display">\[ p + N \rightarrow n + N^\prime  + (k + 1) \pi^+ + k \pi^- + r\pi^0 \]</span></p>
<p>where <span class="math inline">\(k\)</span> and <span class="math inline">\(r\)</span> are the multiplicity of the particle species. Assuming same cross sections we obtain:</p>
<p><span class="math display">\[ R = \frac{N(\pi^+)}{N(\pi^-)} = \frac{2k+1}{2k} = 1 + \frac{1}{2k} \]</span></p>
<p>for low energies <span class="math inline">\(k = 2\)</span> and <span class="math inline">\(R \sim 1.25\)</span></p>
</section>
</section>
<section id="neutrinos-fluxes" class="level2">
<h2 class="anchored" data-anchor-id="neutrinos-fluxes">Neutrinos Fluxes</h2>
<ul>
<li><p>Neutrinos are the most abundant CR product at sea level, yet they have only recently (compared to other particles) measured due to their extremely low cross-section.</p></li>
<li><p>The process giving neutrino fluxes are the same as for the muons (we saw already) plus the muon decay. Taking into account the decay of pions, kaons and muons gives to a flavor ratio of: <span class="math inline">\(\nu_\mu : \nu_e = 2:1\)</span> and <span class="math inline">\(\nu_e/{\bar \nu_e} \sim \mu^+/\mu^-\)</span></p></li>
<li><p>At few GeV (&gt; <span class="math inline">\(\epsilon_\mu\)</span>) muons will not decay and <span class="math inline">\(\nu_e\)</span> will be supressed as the main source of <span class="math inline">\(\nu_e\)</span> is the muon decay.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial II: Plot the $\nu_\mu$ and $\nu_e$ atmospheric flux using the package `DaemonFlux` @Yanez:2023lsy">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial II: Plot the <span class="math inline">\(\nu_\mu\)</span> and <span class="math inline">\(\nu_e\)</span> atmospheric flux using the package <code>DaemonFlux</code> <span class="citation" data-cites="Yanez:2023lsy">Yañez and Fedynitch (<a href="chap1_3.html#ref-Yanez:2023lsy" role="doc-biblioref">2023</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<div id="1fd0da12" class="cell" data-fig-caption="Neutrino Flux using DaemonFlux @Yanez:2023lsy" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> daemonflux <span class="im">import</span> Flux</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fl <span class="op">=</span> Flux(location<span class="op">=</span><span class="st">'generic'</span>, use_calibration<span class="op">=</span><span class="va">True</span>, debug<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>egrid <span class="op">=</span> np.logspace(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with a square Figure.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> fig.add_gridspec(<span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                      left<span class="op">=</span><span class="fl">0.1</span>, right<span class="op">=</span><span class="fl">0.9</span>, bottom<span class="op">=</span><span class="fl">0.1</span>, top<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                      height_ratios <span class="op">=</span> (<span class="dv">4</span>, <span class="dv">1</span>), wspace<span class="op">=</span><span class="fl">0.05</span>, hspace<span class="op">=</span><span class="fl">0.12</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Axes.</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax_1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ax_2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>], sharex<span class="op">=</span>ax)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ax_1.plot(egrid, fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"numuflux"</span>)<span class="op">+</span>fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"antinumu"</span>), label<span class="op">=</span><span class="vs">r"$\nu_{\mu}$ at $\theta = 60^\circ$"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>ax_1.plot(egrid, fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"nueflux"</span>), label<span class="op">=</span><span class="vs">r"$\nu_</span><span class="sc">{e}</span><span class="vs">$ at $\theta = 60^\circ$"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>ax_1.legend()</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>ax_1.loglog()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>ax_1.grid()</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>ax_2.plot(egrid, fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"numuflux"</span>)<span class="op">/</span>fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"nueflux"</span>), label<span class="op">=</span><span class="vs">r"\nu_{\mu}"</span>, lw<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>ax_2.grid()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>ax_2.set_xscale(<span class="st">"log"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ax_2.set_ylim(<span class="dv">0</span>, <span class="dv">30</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>ax_2.set_xlim(<span class="dv">1</span>, <span class="fl">1e5</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ax_1.set_xlim(<span class="dv">1</span>, <span class="fl">1e5</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>ax_2.set_xlabel(<span class="vs">r"$E_\nu$/GeV"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>ax_1.set_ylabel(<span class="vs">r"$(E_\nu/\mathrm{ GeV})^3 \Phi_\nu (\mathrm{ GeV}\mathrm{ \;cm}^2\mathrm{ s\; sr})^{-1}$"</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>ax_2.set_ylabel(<span class="vs">r"$\Phi_{\nu_\mu} / \Phi_{\nu_e}$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Text(0, 0.5, '$\\Phi_{\\nu_\\mu} / \\Phi_{\\nu_e}$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_1_files/figure-html/cell-4-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="chap3_1_files/figure-html/cell-4-output-2.png" width="588" height="553" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In astrophysical sources the ration 2:1 persists. <a href="href=&quot;http://en.wikipedia.org/wiki/Pion#Charged_pion_decays">Why pions don’t decay in to electrons?</a></p>
</div>
</div>
<section id="neutrino-fluxes-and-kinematics" class="level3">
<h3 class="anchored" data-anchor-id="neutrino-fluxes-and-kinematics">Neutrino Fluxes and Kinematics</h3>
<p>As mentioned neutrinos and muons are strongly correlated. However due the two-body kinematics, the energy spectra of the <span class="math inline">\(\nu\)</span>’s and <span class="math inline">\(\mu\)</span>’s from mesons decay are different. For example, the energy of the muon in CoM is given by:</p>
<p><span class="math display">\[E_\mu^{*} = (m_\pi^2 + m_\mu^2)/2m_\pi = 109.8\;\mathrm{MeV}\]</span></p>
<p>and for the neutrino:</p>
<p><span class="math display">\[E_\nu^{*} = (m_\pi^2 - m_\mu^2)/2m_\pi = 29.8\;\mathrm{MeV}\]</span></p>
<p>In the laboratory system, the energies are boosted by the Lorentz factor <span class="math inline">\(\gamma= E_\pi /m_\pi\)</span>, but as can be seen muon carry a much larger fraction of energy than neutrinos. For energies about <span class="math inline">\(1\;\mathrm{TeV}&lt; E_\nu &lt;  10^3\;\mathrm{TeV}\)</span>, the angle averaged atmospheric <span class="math inline">\(\nu_\mu + {\bar \nu_\mu}\)</span> can be approximated by a power law spectrum:</p>
<p><span class="math display">\[\frac{\mathrm{d}N_{\nu_\mu + {\bar \nu_\mu}}}{\mathrm{d}E_\nu} = 7.8 \times 10^{-11}\left(\frac{E_\nu}{1\;\mathrm{TeV}}\right)^{-3.6}\mathrm{cm^2\;s^{-1}\;sr^{-1}\;GeV^{-1}}\]</span></p>
</section>
<section id="fluxes-as-function-of-zenith" class="level3">
<h3 class="anchored" data-anchor-id="fluxes-as-function-of-zenith">Fluxes as Function of Zenith</h3>
<p>Another difference with respect to the muon fluxes is their dependency with respect to the zenith angle. Since atmospheric muons are not absorved by the Earth, their spectrum spans to the whole sky. The following plot shows the calculated neutrino flux at 1,300 m depth with energies <span class="math inline">\(E_\nu = 10\)</span> GeV.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/nu_zenith.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" data-glightbox="description: .lightbox-desc-8" title="Source: arXiv:1210.5154"><img src="images/nu_zenith.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Source: arXiv:1210.5154"></a></p>
<figcaption>Source: <a href="http://arxiv.org/abs/1210.5154">arXiv:1210.5154</a></figcaption>
</figure>
</div>
<p>The peak at the horizon in the atmospheric neutrino flux is due to the so-called <em>secant theta effect</em>. This effect occurs because pions and kaons that are produced nearly skimming the Earth have more flight time in less dense atmosphere, so they have more chance to decay than interact.</p>
</section>
<section id="prompt-fluxes" class="level3">
<h3 class="anchored" data-anchor-id="prompt-fluxes">Prompt Fluxes</h3>
<p>Apart from kaons and pions, charmed messons will also be produced in the atmosphere. Charm particles have lifetimes so short (<span class="math inline">\(10^{-12}\)</span>s) they almost alway decay before interacting. Muons and neutrinos from charm decay are called <em>prompt</em> muons/neutrinos. They have the following peculiarities:</p>
<ul>
<li>The energy spectrum follows the one of the primary cosmic rays ie that of <span class="math inline">\(\sim E^{-2.7}\)</span>.</li>
<li>Since there is no competition between decay and interaction of the charm particle, the <em>prompt</em> flux is fully <strong>isotropic</strong>.</li>
<li>Since neutrinos are produced in 3-body decays they produced the same amount of <span class="math inline">\(\nu_\mu\)</span> and <span class="math inline">\(\nu_e\)</span>.</li>
</ul>
<p>It is important to note that the prompt fluxes have not been observed yet.</p>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Source: Particle Data Group</span>
<span class="glightbox-desc lightbox-desc-4">Source: Particle Data Group</span>
<span class="glightbox-desc lightbox-desc-6">Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)</span>
<span class="glightbox-desc lightbox-desc-8">Source: <a href="http://arxiv.org/abs/1210.5154">arXiv:1210.5154</a></span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Yanez:2023lsy" class="csl-entry" role="listitem">
Yañez, Juan Pablo, and Anatoli Fedynitch. 2023. <span>“<span class="nocase">daemonflux: DAta-drivEn MuOn-calibrated Neutrino Flux</span>,”</span> February. <a href="https://arxiv.org/abs/2303.00022">https://arxiv.org/abs/2303.00022</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap3_0.html" class="pagination-link  aria-label=" &lt;span="" rays="" in="" the="" atmosphere&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cosmic Rays in the Atmosphere</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap3_2.html" class="pagination-link" aria-label="<span class='chapter-number'>9</span>&nbsp; <span class='chapter-title'>Particles Underground</span>">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Particles Underground</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","loop":false,"closeEffect":"zoom","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>