<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AstroParticles - 3&nbsp; Cosmic Rays in the Atmosphere</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap4.html" rel="next">
<link href="./chap2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Cosmic Rays in the Atmosphere</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">AstroParticles</a> 
        <div class="sidebar-tools-main">
    <a href="./AstroParticles.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basic Concents and Notations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Cosmic Rays</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Cosmic Rays in the Atmosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multimessenger Astronomy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dark Matter</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#interactions-of-cr-particles-in-the-atmosphere" id="toc-interactions-of-cr-particles-in-the-atmosphere" class="nav-link active" data-scroll-target="#interactions-of-cr-particles-in-the-atmosphere"><span class="header-section-number">3.1</span> Interactions of CR particles in the atmosphere</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">3.1.1</span> Introduction</a></li>
  <li><a href="#the-atmosphere" id="toc-the-atmosphere" class="nav-link" data-scroll-target="#the-atmosphere"><span class="header-section-number">3.1.2</span> The Atmosphere</a></li>
  <li><a href="#energy-losses-in-the-atmosphere" id="toc-energy-losses-in-the-atmosphere" class="nav-link" data-scroll-target="#energy-losses-in-the-atmosphere"><span class="header-section-number">3.1.3</span> Energy Losses in the Atmosphere</a></li>
  <li><a href="#electromagnetic-shower" id="toc-electromagnetic-shower" class="nav-link" data-scroll-target="#electromagnetic-shower"><span class="header-section-number">3.1.4</span> Electromagnetic Shower</a></li>
  <li><a href="#hadronic-showers" id="toc-hadronic-showers" class="nav-link" data-scroll-target="#hadronic-showers"><span class="header-section-number">3.1.5</span> Hadronic Showers</a></li>
  </ul></li>
  <li><a href="#muons-and-neutrinos" id="toc-muons-and-neutrinos" class="nav-link" data-scroll-target="#muons-and-neutrinos"><span class="header-section-number">3.2</span> Muons and Neutrinos</a>
  <ul class="collapse">
  <li><a href="#muons-and-neutrinos-productions" id="toc-muons-and-neutrinos-productions" class="nav-link" data-scroll-target="#muons-and-neutrinos-productions"><span class="header-section-number">3.2.1</span> Muons and Neutrinos Productions</a></li>
  <li><a href="#muon-fluxes" id="toc-muon-fluxes" class="nav-link" data-scroll-target="#muon-fluxes"><span class="header-section-number">3.2.2</span> Muon Fluxes</a></li>
  <li><a href="#muon-bundles" id="toc-muon-bundles" class="nav-link" data-scroll-target="#muon-bundles"><span class="header-section-number">3.2.3</span> Muon Bundles</a></li>
  <li><a href="#neutrinos-fluxes" id="toc-neutrinos-fluxes" class="nav-link" data-scroll-target="#neutrinos-fluxes"><span class="header-section-number">3.2.4</span> Neutrinos Fluxes</a></li>
  <li><a href="#fluxes-and-kinematics" id="toc-fluxes-and-kinematics" class="nav-link" data-scroll-target="#fluxes-and-kinematics"><span class="header-section-number">3.2.5</span> Fluxes and Kinematics</a></li>
  <li><a href="#prompt-fluxes" id="toc-prompt-fluxes" class="nav-link" data-scroll-target="#prompt-fluxes"><span class="header-section-number">3.2.6</span> Prompt Fluxes</a></li>
  </ul></li>
  <li><a href="#particles-underground" id="toc-particles-underground" class="nav-link" data-scroll-target="#particles-underground"><span class="header-section-number">3.3</span> Particles Underground</a>
  <ul class="collapse">
  <li><a href="#muon-interactions" id="toc-muon-interactions" class="nav-link" data-scroll-target="#muon-interactions"><span class="header-section-number">3.3.1</span> Muon Interactions</a></li>
  <li><a href="#muon-energy-losses" id="toc-muon-energy-losses" class="nav-link" data-scroll-target="#muon-energy-losses"><span class="header-section-number">3.3.2</span> Muon Energy losses</a></li>
  <li><a href="#muon-range" id="toc-muon-range" class="nav-link" data-scroll-target="#muon-range"><span class="header-section-number">3.3.3</span> Muon Range</a></li>
  <li><a href="#neutrino-interactions" id="toc-neutrino-interactions" class="nav-link" data-scroll-target="#neutrino-interactions"><span class="header-section-number">3.3.4</span> Neutrino Interactions</a></li>
  <li><a href="#neutrino-cross-sections-at-gev-energies" id="toc-neutrino-cross-sections-at-gev-energies" class="nav-link" data-scroll-target="#neutrino-cross-sections-at-gev-energies"><span class="header-section-number">3.3.5</span> Neutrino cross-sections at GeV energies</a></li>
  <li><a href="#neutrino-cross-sections-at-tev-energies" id="toc-neutrino-cross-sections-at-tev-energies" class="nav-link" data-scroll-target="#neutrino-cross-sections-at-tev-energies"><span class="header-section-number">3.3.6</span> Neutrino cross-sections at TeV energies</a></li>
  <li><a href="#high-energy-cross-sections" id="toc-high-energy-cross-sections" class="nav-link" data-scroll-target="#high-energy-cross-sections"><span class="header-section-number">3.3.7</span> High energy Cross-Sections</a></li>
  <li><a href="#neutrino-signatures-in-a-neutrino-detector" id="toc-neutrino-signatures-in-a-neutrino-detector" class="nav-link" data-scroll-target="#neutrino-signatures-in-a-neutrino-detector"><span class="header-section-number">3.3.8</span> Neutrino signatures in a neutrino detector</a></li>
  <li><a href="#event-rate-in-an-underground-experiment." id="toc-event-rate-in-an-underground-experiment." class="nav-link" data-scroll-target="#event-rate-in-an-underground-experiment."><span class="header-section-number">3.3.9</span> Event rate in an underground experiment.</a></li>
  <li><a href="#neutrino-oscillations" id="toc-neutrino-oscillations" class="nav-link" data-scroll-target="#neutrino-oscillations"><span class="header-section-number">3.3.10</span> Neutrino Oscillations</a></li>
  <li><a href="#the-pmns-matrix" id="toc-the-pmns-matrix" class="nav-link" data-scroll-target="#the-pmns-matrix"><span class="header-section-number">3.3.11</span> The PMNS Matrix</a></li>
  <li><a href="#the-2-flavor-mixing-case" id="toc-the-2-flavor-mixing-case" class="nav-link" data-scroll-target="#the-2-flavor-mixing-case"><span class="header-section-number">3.3.12</span> The 2-flavor mixing case</a></li>
  <li><a href="#general-case" id="toc-general-case" class="nav-link" data-scroll-target="#general-case"><span class="header-section-number">3.3.13</span> General case</a></li>
  <li><a href="#about-symmetries." id="toc-about-symmetries." class="nav-link" data-scroll-target="#about-symmetries."><span class="header-section-number">3.3.14</span> About symmetries.</a></li>
  <li><a href="#mass-hierarchy" id="toc-mass-hierarchy" class="nav-link" data-scroll-target="#mass-hierarchy"><span class="header-section-number">3.3.15</span> Mass hierarchy</a></li>
  <li><a href="#solar-neutrinos" id="toc-solar-neutrinos" class="nav-link" data-scroll-target="#solar-neutrinos"><span class="header-section-number">3.3.16</span> Solar Neutrinos</a></li>
  <li><a href="#atmospheric-neutrinos" id="toc-atmospheric-neutrinos" class="nav-link" data-scroll-target="#atmospheric-neutrinos"><span class="header-section-number">3.3.17</span> Atmospheric Neutrinos</a></li>
  <li><a href="#reactor-neutrinos" id="toc-reactor-neutrinos" class="nav-link" data-scroll-target="#reactor-neutrinos"><span class="header-section-number">3.3.18</span> Reactor Neutrinos</a></li>
  <li><a href="#neutrino-oscillations-in-matter." id="toc-neutrino-oscillations-in-matter." class="nav-link" data-scroll-target="#neutrino-oscillations-in-matter."><span class="header-section-number">3.3.19</span> Neutrino oscillations in matter.</a></li>
  <li><a href="#tutorial-iii-calculate-the-probabilities-of-nu_e-rightarrow-nu_x-as-function-of-le" id="toc-tutorial-iii-calculate-the-probabilities-of-nu_e-rightarrow-nu_x-as-function-of-le" class="nav-link" data-scroll-target="#tutorial-iii-calculate-the-probabilities-of-nu_e-rightarrow-nu_x-as-function-of-le"><span class="header-section-number">3.3.20</span> Tutorial III: Calculate the probabilities of <span class="math inline">\(\nu_e \rightarrow \nu_x\)</span> as function of L/E</a></li>
  </ul></li>
  <li><a href="#what-else" id="toc-what-else" class="nav-link" data-scroll-target="#what-else"><span class="header-section-number">3.4</span> What else?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Cosmic Rays in the Atmosphere</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="interactions-of-cr-particles-in-the-atmosphere" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="interactions-of-cr-particles-in-the-atmosphere"><span class="header-section-number">3.1</span> Interactions of CR particles in the atmosphere</h2>
<section id="introduction" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.1.1</span> Introduction</h3>
<p>In this lesson we will the different components of a cosmic air shower when cosmic rays interact with Earth’s atmosphere. As seen in the figure below, we have 3 main components, the <strong>electromagnetic component</strong>, the <strong>hadronic component</strong> and muons and neutrinos which can be seen as the <strong>muonic component</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/air-shower.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/air-shower.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</section>
<section id="the-atmosphere" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="the-atmosphere"><span class="header-section-number">3.1.2</span> The Atmosphere</h3>
<p>Before studying the interactions of cosmic rays in the atmosphere we need to setup a model that will describe our atmosphere. To study the cosmic rays interactions in the atmosphere it is useful to define a parameter that we will call the <strong>vertical atmospheric depth</strong> (sometimes also called column density) defined as the integral in altitude of the atmospheric density <span class="math inline">\(\rho\)</span> above the observation level <span class="math inline">\(h\)</span>:</p>
<p><span class="math display">\[X(h) =\int_h^{\infty} \rho(h^\prime)\mathrm{ d}h^\prime\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/x.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/x.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<section id="the-isothermal-model-of-the-atmosphere" class="level4" data-number="3.1.2.1">
<h4 data-number="3.1.2.1" class="anchored" data-anchor-id="the-isothermal-model-of-the-atmosphere"><span class="header-section-number">3.1.2.1</span> The isothermal model of the Atmosphere</h4>
<p>In an isothermal hydrostatic atmosphere a particular layer of gas at some altitude is static. That means that the downward (towards the planet) force of its weight, plus the downward force exerted by pressure in the layer above it, and the upward force exerted by pressure in the layer below, all sum to zero. Assuming a segment of area <span class="math inline">\(A\)</span> and heigth <span class="math inline">\(\mathrm{ d}h\)</span> we can write this equilibrium of forces as:</p>
<p><span class="math display">\[P\cdot A - (P + \mathrm{ d}P)\cdot A - (\rho A \mathrm{ d}h)g_0  =0\]</span></p>
<p><span class="math display">\[\mathrm{ d}P = -g_0\rho(h) \mathrm{ d}h\]</span></p>
<p>Using the ideal gas law:</p>
<p><span class="math display">\[ P = \frac{\rho R T}{M}\]</span></p>
<p>where <span class="math inline">\(R\)</span> is the ideal gas constant, <span class="math inline">\(T\)</span> is temperature, <span class="math inline">\(M\)</span> is average molecular weight, and <span class="math inline">\(g_0\)</span> is the gravitational acceleration at the planet’s surface. We get</p>
<p><span class="math display">\[\frac{\mathrm{ d}P}{P} = -\frac{g_0 M}{R T} \mathrm{ d} h\]</span></p>
<p>assuming a constant and isothermal gas (const <span class="math inline">\(T\)</span>) we can integrate a pressure decreases exponentially with increasing height as:</p>
<p><span class="math display">\[P = P_0 e^{-\frac{g_0 M}{R T} h} \]</span></p>
<p>where the we can define the <strong>scale height</strong> as:</p>
<p><span class="math display">\[ h_0 = \frac{R T}{M g_0} \]</span></p>
<p>Since the temperature is assumed to be constant it follows that <span class="math inline">\(\rho\)</span> also changes exponentially as <span class="math inline">\(\rho = \rho_0 e^{-h/h_0}\)</span> and therefore the column density can be written as:</p>
<p><span class="math display">\[X = X_0 \mathrm{ e}^{-h/h_0}\]</span></p>
<p>where <span class="math inline">\(X_0\)</span> is 1030 g/cm<span class="math inline">\(^{2}\)</span> is the atmospheric depth at sea level, h = 0. In particular for the isothermal model we have that the relation between atmospheric depth (aka column density) and density is:</p>
<p><span class="math display">\[ \rho(X) = \frac{X}{h_0} \]</span></p>
<section id="the-scale-height" class="level5" data-number="3.1.2.1.1">
<h5 data-number="3.1.2.1.1" class="anchored" data-anchor-id="the-scale-height"><span class="header-section-number">3.1.2.1.1</span> The Scale Height</h5>
<p>Using typical values (<span class="math inline">\(T = 273\)</span> K and <span class="math inline">\(M = 29\)</span> g/mol) we get that <span class="math inline">\(h_0 \sim 8\)</span> km which coincidentally is the approximate height of Mt. Everest.</p>
<p>In reality the temperature changes and hence the scale height decreases with increasing altitude until the tropopause.</p>
<p>This equations are valid for vertical particles, for zenith angles &lt; 60<span class="math inline">\(^\circ\)</span> (for which we can ignore the Earth’s curvature) the formula is scaled with <span class="math inline">\(1/\cos{\theta}\)</span> giving the <em>slant depth</em></p>
<p><span class="math display">\[X_{slant-depth} = \frac{X}{\cos \theta} \]</span></p>
</section>
</section>
</section>
<section id="energy-losses-in-the-atmosphere" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="energy-losses-in-the-atmosphere"><span class="header-section-number">3.1.3</span> Energy Losses in the Atmosphere</h3>
<p>Charge particles when entering in the atmosphere will suffer different process of energy losses. We are going to review some of them</p>
<section id="ionization-losses" class="level4" data-number="3.1.3.1">
<h4 data-number="3.1.3.1" class="anchored" data-anchor-id="ionization-losses"><span class="header-section-number">3.1.3.1</span> Ionization Losses</h4>
<p>The <strong>ionization energy loss</strong> of high energy charged particles with colission with atomic electrons is given by the Bethe-Block formula:</p>
<p><span class="math display">\[\left(\frac{\mathrm{ d} E}{\mathrm{ d} x}\right)_{ion}= -\left(\frac{4\pi N_0z^2e^4}{mv^2}\right)\left(\frac{Z}{A}\right)\left\{\log\left[\frac{2mv^2\gamma^2}{I}\right]-\beta^2\right\}\]</span></p>
<p>where <span class="math inline">\(m\)</span> is the mass of the electron, <span class="math inline">\(v\)</span> and <span class="math inline">\(ze\)</span> are the velocity and charge of the incoming particle, <span class="math inline">\(N_0\)</span> is the Avogadro’s number, <span class="math inline">\(Z\)</span> and <span class="math inline">\(A\)</span> are the atomic and mass numbers of the atmos in the medium and <span class="math inline">\(x\)</span> the path travelled, and <span class="math inline">\(I\)</span> is the ionization potential of the medium is approximatively 10 Z eV.</p>
<ul>
<li>Since <span class="math inline">\(Z/A \sim \frac{1}{2}\)</span> in most materials it depends little on the medium.</li>
<li>It varies as <span class="math inline">\(1/v^2\)</span> at low speed and independent of the incident particle mass.</li>
<li>It reaches a minimum at about <span class="math inline">\(3Mc^2\)</span> and it increases logarithmically until it reaches a plateu value.</li>
</ul>
</section>
<section id="radiation-losses" class="level4" data-number="3.1.3.2">
<h4 data-number="3.1.3.2" class="anchored" data-anchor-id="radiation-losses"><span class="header-section-number">3.1.3.2</span> Radiation Losses</h4>
<p>In addition to ionization losses, charge particles also undergo <strong>bremsstrahlung</strong> or braking radiation when travelling through a material given by:</p>
<p><span class="math display">\[\left(\frac{\mathrm{ d} E}{\mathrm{ d} x}\right)_{rad} = -\frac{E}{X_0}\]</span> where for electrons the <strong>radiation length</strong> is:</p>
<p><span class="math display">\[\frac{1}{X_0} = 4 \alpha\left(\frac{Z}{A}\right)(Z + 1)^2r_e^2N_0\log\left(\frac{183}{Z^{1/3}}\right)\]</span></p>
<p>where <span class="math inline">\(r_e = e^2/4\pi m_e c^2\)</span> is the classical electron radius and <span class="math inline">\(\alpha = \frac{1}{137}\)</span> is the fine structure constant.</p>
<ul>
<li>Bremsstrahlung is proportional to <span class="math inline">\(\frac{1}{X_0} \propto r^2_{e} \propto 1/m_e^2\)</span>. The radiation length of a muon will be <span class="math inline">\((m_\mu/m_e)^2\)</span> times that for an electron.</li>
<li>Bremsstrahlung is proportional to the energy.</li>
</ul>
<p>The critical energy is the energy at <span class="math inline">\((\mathrm{ d}E/\mathrm{ d}x)_{ion} = (\mathrm{ d}E/\mathrm{ d}x)_{rad}\)</span>. Above this energy the radiation process dominates, below the ionization. For electrons this is roughly <span class="math inline">\(\epsilon_c \sim 600/Z\)</span> MeV, and for the atmosphere this is <span class="math inline">\(\epsilon_e \sim 85\)</span> MeV.</p>
</section>
<section id="cherenkov-radiation" class="level4" data-number="3.1.3.3">
<h4 data-number="3.1.3.3" class="anchored" data-anchor-id="cherenkov-radiation"><span class="header-section-number">3.1.3.3</span> Cherenkov Radiation</h4>
<p>When relativistic particles traverse a medium at a speed greater than the speed of light in that medium it can induce Cherenkov radiation.</p>
<p><a href="images/Cherenkov.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/Cherenkov.svg" class="img-fluid"></a></p>
<p>Cherenkov light is emitted in the UV and blue region in a narrow cone with angle:</p>
<p><span class="math display">\[\cos \theta = \frac{ct/n}{\beta c t} = \frac{1}{\beta n}\]</span></p>
<p>so the threshold for production is <span class="math inline">\(\beta &gt; \frac{1}{n}\)</span>. Most of the components in the air shower will produced abundant Cherenkov light.</p>
<p>We will see more on Cherenkov radiation on the next lesson about <span class="math inline">\(\gamma\)</span>-ray astronomy.</p>
</section>
<section id="pair-production" class="level4" data-number="3.1.3.4">
<h4 data-number="3.1.3.4" class="anchored" data-anchor-id="pair-production"><span class="header-section-number">3.1.3.4</span> Pair production</h4>
<p>If a photon from bremsstrahlung has enougth energy <span class="math inline">\(E_\gamma &gt; 2 m_e\)</span> it can produced a pair of electron positron. The cross-section rises quickly at the threshod of <span class="math inline">\(2 m_e\)</span> but in the high energy part it can be approximated to:</p>
<p><span class="math display">\[\sigma = \frac{7}{9} r_0^2 Z (Z+ 1)\log \left(\frac{183}{3\sqrt{Z}}\right)\]</span></p>
<p>The pair production cannot occure in vacum, a photon desintegrated to the pair <span class="math inline">\(e^-e^+\)</span> will have a null momentum in the CoM system, therefore a nucleus has to be present to absorb the momemtum. As can be seen the radiation length <span class="math inline">\(X_0\)</span> is very similar to the one from radiation losses. In fact we can write:</p>
<p><span class="math display">\[\frac{1}{X_{pair}} = \frac{7}{9}\frac{1}{X_0}\]</span></p>
<p>Which means that the <strong>radiation lengths for braking radiation and pair production are comparable</strong>.</p>
</section>
</section>
<section id="electromagnetic-shower" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="electromagnetic-shower"><span class="header-section-number">3.1.4</span> Electromagnetic Shower</h3>
<p>When photons from radiation losses of electrons, have enough energy to produce pairs of positrons electrons, these hey also can produce photons which, in turn, can also produces pairs, etc, etc. This is called an <strong>electromagnetic shower</strong>.</p>
<section id="the-heitler-toy-model" class="level4" data-number="3.1.4.1">
<h4 data-number="3.1.4.1" class="anchored" data-anchor-id="the-heitler-toy-model"><span class="header-section-number">3.1.4.1</span> The Heitler Toy-Model</h4>
<p>The Heitler toy model explains very well the development of an electromagnetic shower. As we saw, in the ultrarelativistic limit the radiation lenghs for pair production and bremsstrahung are comparable. We can defined a distance <span class="math inline">\(d_{split} = X_0 \log2\)</span> where an electron will looses, on average, half of its energy.</p>
<p>An electron with inital energy <span class="math inline">\(E_0\)</span> in a medium will generate a photon in a <span class="math inline">\(d_{split}\)</span> length of energy <span class="math inline">\(E_0/2\)</span>, in the next radiation length the photon can convert into <span class="math inline">\(e^+e^-\)</span> each with energies <span class="math inline">\(E_0/4\)</span>. After <span class="math inline">\(t\)</span> steps the electrons, positrons will have energies of <span class="math inline">\(E(t)=E_0/2^t\)</span>. This continues until the electrons, positrons fall below the critical energy of electrons, <span class="math inline">\(\epsilon_e\)</span>, and ionization dominates. The process is illustrated in the figure below, where each step <span class="math inline">\(n\)</span> corresponds to one <span class="math inline">\(d_{split}\)</span> length.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/em-shower.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="images/em-shower.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<p>The Heitler model has the following properties:</p>
<ul>
<li>The shower has maximum at:</li>
</ul>
<p><span class="math display">\[t_{max} = \frac{\log(E_0/\epsilon_e)}{\log2}\]</span></p>
<ul>
<li>The maximum number of particles is:</li>
</ul>
<p><span class="math display">\[N_{max} = 2^{t_{max}} = \frac{E_0}{\epsilon_e}\]</span></p>
<ul>
<li>The shower maximum will be at a depth <span class="math inline">\(X_{max}\)</span>:</li>
</ul>
<p><span class="math display">\[X_{max}=d_{split} \frac{\log(E_0/\epsilon_e)}{\log2} = X_0 \log(E_0/\epsilon_e)\]</span></p>
<p>For air <span class="math inline">\(\epsilon_e = 85\)</span> MeV and the <strong>radiation length</strong> <span class="math inline">\(X_0 = 36.7 \mathrm{ g/cm}^2\)</span>. Actual showers also spread laterally mostly due to Coulomb scattering. The lateral spread is a few times the so-called <strong>Moliere unit</strong> equal to <span class="math inline">\(21/\epsilon_e\)</span> (MeV).</p>
<p>The <span class="math inline">\(X_{max}\)</span> prediction of the Heitler model is in good agreement with Monte Carlo simulations. However, the electron to photon ratio of 2 is not in agreement given that the model predicts only one photon emitted by bremsstrahlung. Simulations show a ratio of 1/6 since in reality several photons are emitted and electrons lose energy much faster than photons do.</p>
</section>
</section>
<section id="hadronic-showers" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="hadronic-showers"><span class="header-section-number">3.1.5</span> Hadronic Showers</h3>
<p>Before modeling the baryon-induced showers or hadronic showers, we need to estimate the <em>nuclean mean free path</em> in the atmosphere. We can write the <strong>standard mean free path</strong> for <span class="math inline">\(\sigma^{air}_N\)</span> nucleon-air cross section as:</p>
<p><span class="math display">\[l_N = \frac{1}{n \sigma_N^{air}}\]</span></p>
<p>where as we saw in the introduction <span class="math inline">\(n\)</span> is the <strong>number density</strong> of targets, in our case air nuclei. This number density can be expresed as $n = N_T/V $ where <span class="math inline">\(N_T\)</span>is the total number of air nuclei in volume <span class="math inline">\(V\)</span>.</p>
<p>The <strong>density mean free path</strong>, is defined as <span class="math inline">\(\lambda_N = \rho_{air} l_N\)</span>, where <span class="math inline">\(\rho_{air} = n \cdot m_{air}\)</span> where <span class="math inline">\(m_{air}\)</span> is the mass of air nuclei, that can be written as <span class="math inline">\(m_{air} \sim A m_p\)</span>. Puttin everything together we have that:</p>
<p><span class="math display">\[\lambda^{air}_N = \rho_{air} l_N = n A m_p\frac{1}{n\sigma_N^{air}} = \frac{A m_{p}}{\sigma_N^{air}}\]</span></p>
<p>For air <span class="math inline">\(A\)</span> is average mean the mass number of air nuclei components (mainly nitrogen, oxygen) and we can assume it to be <span class="math inline">\(A \sim 14.5\)</span> and <span class="math inline">\(\sigma_N^{air} \approx\)</span> 300 mb, which corresponds to <span class="math inline">\(\lambda_N^{air} \approx 80\)</span>g/cm<span class="math inline">\(^{2}\)</span>.</p>
<p>Note that this definition of the density mean free path is independent of the mass density of the medium, so if the density changes with altitude, like in the case of our atmosphere, the density mean free path is the same.</p>
<section id="the-heitler-matthew-model" class="level4" data-number="3.1.5.1">
<h4 data-number="3.1.5.1" class="anchored" data-anchor-id="the-heitler-matthew-model"><span class="header-section-number">3.1.5.1</span> The Heitler-Matthew Model</h4>
<p>In the Heitler model can be adapted also for hadronic showers. This is what Matthew did. We can imagine a proton initiating the cascade instead of a photon/electron, in this case a hadronic air shower will develope:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/proton_eas.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="images/proton_eas.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<p>We can assume that the first interaction is defined by the proton mean free path <span class="math inline">\(\lambda^{air}_N\)</span>. Defining the first interaction point where the proton will lose (on average) half of its energy this first interaction length is given as <span class="math inline">\(\lambda^{air}_{N} \log 2\)</span> where for protons <span class="math inline">\(\lambda^{air}_N \approx 80\)</span>g/cm. The following general interaction is expected:</p>
<p><span class="math display">\[ p + p/n \rightarrow p + n/p + \pi^0 + \pi^{\pm} + K^0 + K^{\pm} + .. \]</span></p>
<p>We will focus only on pion production (same argument can be done for kaons). After the first interaction we can use the simplified assumption that the hadronic interaction produces only <span class="math inline">\(3N_\pi\)</span> pions. Of those $ 2 N_$ will be charged pions and <span class="math inline">\(N_\pi\)</span> will be <span class="math inline">\(\pi^0\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/hadronic-shower.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="images/hadronic-shower.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a></p>
</figure>
</div>
<p>We also assume the energy is equally distributed among them, so <span class="math inline">\(2/3E_0\)</span> will go to charge pions and <span class="math inline">\(1/3E_0\)</span> will go to the neutral pions. The <span class="math inline">\(\pi^0\)</span> has a very short decay time, so it will decay and produce an electromagnetic shower. Charge pions will continue generating hadronic shower in each <span class="math inline">\(d_{split} = \lambda_{\pi}^{air} \log 2\)</span> with the mean free path of pions <span class="math inline">\(\lambda_\pi^{air} \sim 120\)</span>g/cm<span class="math inline">\(^2\)</span> until they reach the critical energy where pions decay is more probable than interactions <span class="math inline">\(\epsilon_\pi\)</span>. On each step we assume that energy is equally divided among the <span class="math inline">\(3 N_\pi\)</span> pions. Thefore at each step <span class="math inline">\(t\)</span> the energy of the pions is:</p>
<p><span class="math display">\[E_\pi = \frac{E_0}{(3N_\pi)^t} \]</span></p>
<p>The number of radiation lengths <span class="math inline">\(t\)</span> to reach the critical energy ie <span class="math inline">\(E_\pi = \epsilon_\pi\)</span>, and is given (as in the case of EM showers):</p>
<p><span class="math display">\[t_{max} = \frac{\log(E_0/\epsilon_\pi)}{\log(3N_\pi)}\]</span></p>
<p>Assuming that after that energy all charged pions (ie <span class="math inline">\(2N_\pi\)</span>) decay to muons, the number of muons is given by:</p>
<p><span class="math display">\[N_\mu =(2N_\pi)^{t_{max}}\]</span></p>
<p>introducing <span class="math inline">\(\beta = \log(2N_\pi)/\log(3N_\pi)\)</span> we have:</p>
<p><span class="math display">\[N_\mu =(E_0/\epsilon_\pi)^\beta \]</span></p>
<p>This is also called the <em>multiplicity</em> and corresponds to the muon bundles as we will see later. For pions between 1 GeV and 10 TeV an appropiate number is <span class="math inline">\(N_\pi = 5\)</span> and in that case <span class="math inline">\(\beta = 0.85\)</span>. Therefore the number of muons doesn’t grow linearly with the intial energy but a slower rate.</p>
<p>The definition of <span class="math inline">\(X_{max}\)</span> is somehow less clear than in an EM shower. Hadronic showers are still dominated by electromagnetic processes, so we can assume that <span class="math inline">\(X_{max}\)</span> depends dominantly on the first generation of <span class="math inline">\(\pi^0\)</span> EM subshowers. For proton primaries, the first interaction will be given by the nucleon mean free path where in this first interaction the proton splits in <span class="math inline">\(3N_\pi\)</span> particles, so <span class="math inline">\(pi^0\)</span> with initial energy <span class="math inline">\(E_0/3N_\pi\)</span> will initiate an EM shower. The depth of maximum is then obtained as the sum of the first proton interaction length and the shower maximum of the first EM sub-shower:</p>
<p><span class="math display">\[X_{max} = \lambda^{air}_N \log2 + X_0 \log\left(\frac{E_0}{3N_\pi\epsilon_e}\right) \]</span></p>
<p>where again <span class="math inline">\(\epsilon_e\)</span> is the critical energy of electrons. The expected values of this formula are low when compared to detailed simulations because it neglects the contributions of the next one or two generation of <span class="math inline">\(\pi^0\)</span> production.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Superposition model for heavy nuclei air showers">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Superposition model for heavy nuclei air showers
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can extend the discussion to heavy nuclei by adopting the <em>Superposition model</em> in which a nucleus of mass A and energy <span class="math inline">\(E_0\)</span> essentially generates <span class="math inline">\(A\)</span> subshowers of energy <span class="math inline">\(E_0/A\)</span>. In that case the muon multiplicity will be:</p>
<p><span class="math display">\[N_\mu = A \left(\frac{E_0}{A\epsilon_\pi}\right)^\beta \propto E_0^\beta A^{1 - \beta} \]</span></p>
<p>therefore the muon multiplicity will depend on the CR composition. Likewise the shower maximum is given by:</p>
<p><span class="math display">\[X^{A}_{max}(E_0) = X_{max}^{p}(E_0) - X_0\log{A}\]</span></p>
<p>ie, for a given energy <span class="math inline">\(E_0\)</span> the shower max depends on the mass of the CR primary and it is typicall smaller than for protons (ie reach the maximum sooner in the atmosphere). For composition studies therefore it is necessary to measure <span class="math inline">\(X_{max}\)</span> and the energy of the shower, which can be estimated from fluorescence techniques.</p>
</div>
</div>
</section>
</section>
</section>
<section id="muons-and-neutrinos" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="muons-and-neutrinos"><span class="header-section-number">3.2</span> Muons and Neutrinos</h2>
<p>The plot below shows the particle flux surviving after a certain altitude.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/cr_fig3_07.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7" title="Source: Particle Data Group"><img src="images/cr_fig3_07.png" class="img-fluid figure-img" alt="Source: Particle Data Group"></a></p>
<figcaption>Source: Particle Data Group</figcaption>
</figure>
</div>
<p>We can extract different information from this plot:</p>
<ul>
<li><p>Primaries dominate up to 9 km, secondaries (electrons, pions) roughly follow the primary shape. Muons and neutrinos are continously produced.</p></li>
<li><p>Vertical fluxes for <span class="math inline">\(E &gt; 1\)</span> GeV. Points show the <span class="math inline">\(\mu^-\)</span> measurements. Muons and neutrinos are produced in decays of mesons which are themselves produced by interactions of CR particles with air nuclei.</p></li>
<li><p>They are the dominant flux at sea level and the only ones that can penetrate deep underground.</p></li>
</ul>
<p>Electrons and nucleons fluxes above 1 GeV/<span class="math inline">\(c\)</span> are about 0.2 and 2 m<span class="math inline">\(^{-2}\)</span> s<span class="math inline">\(^{-1}\)</span> sr<span class="math inline">\(^{-1}\)</span> at sea level. Nucleons are the degraded remnants of the primary cosmic radiation. At sea level about 1/3 are neutrons.</p>
<section id="muons-and-neutrinos-productions" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="muons-and-neutrinos-productions"><span class="header-section-number">3.2.1</span> Muons and Neutrinos Productions</h3>
<p>The most important channels for muon and neutrino production are:</p>
<ul>
<li><p>Two body decays <span class="math display">\[\pi^{\pm} \rightarrow \mu^{\pm} + \nu_{\mu}({ \bar \nu_\mu}) \mathrm{\;\; (\sim 100\%)}\]</span> <span class="math display">\[K^{\pm} \rightarrow \mu^{\pm} + \nu_{\mu}({\bar \nu_\mu}) \mathrm{\;\; (\sim 63.5\%)}\]</span></p></li>
<li><p>Three body decay <span class="math display">\[K_L \rightarrow \pi^{\pm} e^{\pm}\nu_e({\bar \nu_e}) \mathrm{\;\; (\sim 38.7\%)}\]</span></p></li>
</ul>
<p>At lower energies, the muon decay is also important:</p>
<p><span class="math display">\[ \mu^{\pm} \rightarrow e^{\pm} + \nu_{e}({\bar \nu_e}) + {\bar \nu_{\mu}}(\nu_\mu)\]</span></p>
<p>For each of the 2-body decay channels, assuming the muon always decay the neutrino flavor ratio is:</p>
<p><span class="math display">\[\mathbf{ \nu_\mu : \nu_e = 2:1}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Mean free path for mesons, $\pi$, $K$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mean free path for mesons, <span class="math inline">\(\pi\)</span>, <span class="math inline">\(K\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Charged pions and Kaons can interact or decay. Both processes have a mean free path and one or the other will dominate depending on which mean free path is larger.</p>
<p>The <strong>decay mean free path</strong> of pions is given by <span class="math inline">\(l^d_\pi =\gamma  c \tau_\pi\)</span> where <span class="math inline">\(\gamma\)</span> is the Lorentz factor of the pion. Multiplying for density we have the <strong>density decay mean free path</strong> as:</p>
<p><span class="math display">\[\lambda^d_\pi = \rho(X) \gamma  c \tau_\pi\]</span></p>
<p>However the atmosphere density depends on the atmospheric depth as <span class="math inline">\(\rho(X) = X/h_0\)</span>. In units of <em>slant depth</em>, <span class="math inline">\(X_{sd} = X/\cos\theta\)</span> and expanding <span class="math inline">\(\gamma = E / m_\pi c^2\)</span> we can rewrite the density decay free path as:</p>
<p><span class="math display">\[\frac{1}{\lambda^d_\pi(E)} = \frac{m_\pi c^2 h_0}{E c \tau_\pi X_{sd} \cos \theta} = \frac{\epsilon_\pi}{E X_{sd} \cos\theta}\]</span></p>
<p>where <span class="math inline">\(E\)</span>, <span class="math inline">\(m_\pi\)</span>, <span class="math inline">\(\tau_\pi\)</span> are the pion energy, mass and lifetime and we defined:</p>
<p><span class="math display">\[\epsilon_\pi = \frac{c\tau_\pi}{m_\pi c^2 h_0}\]</span></p>
<p>as a <em>critial energy</em>. The crital energy is such that the decay time equals the vertical atmospheric depth <span class="math inline">\(\lambda^d_\pi(\epsilon_\pi) = X_{sd} \cos\theta = X\)</span>.</p>
<p>The <strong>interaction mean free path</strong> is the same as nucleon <span class="math inline">\(\lambda_\pi = A m_\pi/\sigma_\pi^{air}\)</span> which as we saw is indenpendent of <span class="math inline">\(X\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Critical energy  for mesons, $\pi$, $K$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Critical energy for mesons, <span class="math inline">\(\pi\)</span>, <span class="math inline">\(K\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Decay or interaction dominates depending on whether <span class="math inline">\(1/\lambda^d_\pi\)</span> or <span class="math inline">\(1/\lambda_\pi\)</span> is larger. This in turns depends on the ratio between the energy <span class="math inline">\(E\)</span> and the critical energy <span class="math inline">\(\epsilon_\pi\)</span>. For example, the value of the crital energy for pions is given by:</p>
<p><span class="math display">\[\epsilon_\pi = \frac{c\tau_\pi}{m_\pi c^2 h_0} \approx 115 \;\mathrm{ GeV}\]</span></p>
<p>So we can distinguish two regimes.</p>
<ul>
<li><p>For <span class="math inline">\(E \gg \epsilon_\pi\)</span> decay length is much larger than the atmospheric depth, so interaction dominates.</p></li>
<li><p>For <span class="math inline">\(E \ll \epsilon_\pi\)</span> decay dominates is much shorter than the atmospheric depth, so the pion will likely decay before interacting.</p></li>
</ul>
<p>The same formulas can be derived for Kaons.</p>
</div>
</div>
</section>
<section id="muon-fluxes" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="muon-fluxes"><span class="header-section-number">3.2.2</span> Muon Fluxes</h3>
<p>The muon energy spectrum at sea level is a direct consequence of the meson source spectrum. Unlike electrons, muons will decay before reaching the ground in the GeV energy range. The muon decay length is given by:</p>
<p><span class="math display">\[ d_\mu = \gamma \tau_\mu c\]</span></p>
<p>Where <span class="math inline">\(\tau_\mu\)</span> is the muon lifetime of the order of <span class="math inline">\(2.2\times 10^{-6}\)</span> s. So for a muon of 1 GeV we have:</p>
<div id="5fd5a056" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>lifetime <span class="op">=</span> <span class="fl">2.1969811e-6</span> <span class="co"># muon lifetime in seconds</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.constants <span class="im">as</span> cte</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cspeed <span class="op">=</span> cte.c</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>muon_mass <span class="op">=</span> cte.value(<span class="st">"muon mass energy equivalent in MeV"</span>) <span class="op">*</span> <span class="fl">1e-3</span> <span class="co"># in GeV</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>energy <span class="op">=</span> <span class="dv">1</span> <span class="co"># GeV</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"d = </span><span class="sc">{</span>(energy<span class="op">/</span>muon_mass)<span class="op">*</span>lifetime<span class="op">*</span>cspeed<span class="op">*</span><span class="fl">1e-3</span><span class="sc">:.2f}</span><span class="ss"> km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d = 6.23 km</code></pre>
</div>
</div>
<p>Compared to the typical atmospheric altitude of <span class="math inline">\(h \sim 15\)</span> km it means that at those energies, muons will not reach the ground.</p>
<section id="energy-regimes-of-muon-fluxes" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="energy-regimes-of-muon-fluxes"><span class="header-section-number">3.2.2.1</span> Energy regimes of muon fluxes</h4>
<p>Three different regimes are distinguishable:</p>
<ul>
<li><span class="math inline">\(E_\mu \leq \epsilon_\mu\)</span>, where <span class="math inline">\(\epsilon_\mu \sim 1\)</span> GeV. This critical energy is when interaction probability and decay probability start to be comparable. Even more the muon energy losses become important. As we saw energy losses via ionization is almost constant, for muons is about <span class="math inline">\(\sim 2\)</span> MeV/(g/cm<span class="math inline">\(^{2}\)</span>) in air (and mostly independent on the material). However this is true only above energies of 1 GeV, below ionization losses increase drastically as can be seen in the figure below.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_energylosses_air.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="images/muon_energylosses_air.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<ul>
<li><p><span class="math inline">\(\epsilon_\mu \leq E_\mu \leq \epsilon_{\pi,K}\)</span>, where <span class="math inline">\(\epsilon_\pi = 115 \;\mathrm{GeV}\)</span> and <span class="math inline">\(\epsilon_K = 850 \;\mathrm{GeV}\)</span>. In this range all mesons decay and muons spectrum follows the same of the parent spectrum of mesons and hence that of the primary CRs. The muon is almost independent of the zenith angle.</p></li>
<li><p><span class="math inline">\(E_\mu \gg \epsilon_{\pi,K}\)</span>, Mesons interaction length starts to be comparable to their decay length. This happens first for inclined showers and so the muon flux gets suppressed while it also starts to depend on the zenith angle (ie on the density of the atmosphere).</p></li>
</ul>
<p>At even highers energies, above 1 TeV in air, muons will also start to loose energie via other radiative process (we will see that below when talking about muons underground).</p>
</section>
<section id="analytical-approximation" class="level4" data-number="3.2.2.2">
<h4 data-number="3.2.2.2" class="anchored" data-anchor-id="analytical-approximation"><span class="header-section-number">3.2.2.2</span> Analytical approximation</h4>
<p>An approximate extrapolation formula valid when muon decay is negligible (<span class="math inline">\(E_\mu &gt; 100/\cos\theta\)</span> GeV) and the curvature of the Earth can be neglected (<span class="math inline">\(\theta &lt; 70^{\circ}\)</span>) is given by the Gaisser parametrization:</p>
<p><span class="math display">\[\frac{\mathrm{d}N_\mu}{\mathrm{d}E_\mu \mathrm{d}\Omega} = \frac{0.14}{\mathrm{cm^2\;s\;sr\;GeV}}\left(\frac{E_\mu}{\mathrm{GeV}}\right)^{-2.7}\left[F_\pi(E_\mu, \theta) + F_K(E_\mu,\theta)\right]\]</span></p>
<p>where <span class="math inline">\(F_\pi\)</span> and <span class="math inline">\(F_K\)</span> represent the contributions from pions and kaons, respectively:</p>
<p><span class="math display">\[F_\pi(E_\mu, \theta) = \frac{1}{1+\frac{1.1 E_\mu \cos\theta}{115 \;\mathrm{GeV}}}\]</span></p>
<p><span class="math display">\[F_K(E_\mu, \theta) = \frac{0.054}{1+\frac{1.1 E_\mu \cos\theta}{850\;\mathrm{GeV}}}\]</span></p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial I:  Plot the muon flux for two different angles">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial I: Plot the muon flux for two different angles
</div>
</div>
<div class="callout-body-container callout-body">
<div id="760770d1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">"STIXGeneral"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'axes.labelsize'</span>: <span class="dv">20</span>})</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'legend.fontsize'</span>: <span class="dv">20</span>})</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'figure.figsize'</span>: [<span class="dv">8</span>, <span class="dv">6</span>]})</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.labelsize'</span>] <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.labelsize'</span>] <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.major.width'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.minor.width'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.major.pad'</span>] <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.direction'</span>] <span class="op">=</span> <span class="st">'in'</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.size'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.minor.size'</span>] <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.width'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.minor.width'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.major.pad'</span>] <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.direction'</span>] <span class="op">=</span> <span class="st">'in'</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'legend.frameon'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'lines.linewidth'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.linewidth'</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> muons(cangle, E):</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fl">1.</span><span class="op">/</span>(<span class="fl">1.</span><span class="op">+</span> <span class="fl">1.1</span><span class="op">*</span>E<span class="op">*</span>cangle<span class="op">/</span><span class="fl">115.</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="fl">0.054</span><span class="op">/</span>(<span class="fl">1.</span><span class="op">+</span> <span class="fl">1.1</span><span class="op">*</span>E<span class="op">*</span>cangle<span class="op">/</span><span class="fl">850.</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.14</span> <span class="op">*</span>E<span class="op">**-</span><span class="fl">2.7</span> <span class="op">*</span>(a <span class="op">+</span> b)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">"log"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">"log"</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="fl">1e-5</span>, <span class="fl">3e-1</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$E_\mu^</span><span class="sc">{2.7}</span><span class="vs"> dN_\mu/dE_\mu [cm^{-2}s^{-1} (GeV)^</span><span class="sc">{1.7}</span><span class="vs">]$"</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"$E_\mu(GeV)$"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> np.arange(<span class="fl">1e0</span>, <span class="fl">1e6</span>, <span class="dv">10</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>ax.plot(E, E<span class="op">**</span><span class="fl">2.7</span><span class="op">*</span>muons(np.cos(<span class="dv">75</span><span class="op">*</span>np.pi<span class="op">/</span><span class="fl">180.</span>),E), label<span class="op">=</span><span class="vs">r"$\theta = 75^{\circ}$"</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>ax.plot(E, E<span class="op">**</span><span class="fl">2.7</span><span class="op">*</span>muons(np.cos(<span class="dv">0</span><span class="op">*</span>np.pi<span class="op">/</span><span class="fl">180.</span>),E), label<span class="op">=</span><span class="vs">r"$\theta = 0^{\circ}$"</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_files/figure-html/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="chap3_files/figure-html/cell-3-output-1.png" width="564" height="533" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="measured-muon-flux" class="level4" data-number="3.2.2.3">
<h4 data-number="3.2.2.3" class="anchored" data-anchor-id="measured-muon-flux"><span class="header-section-number">3.2.2.3</span> Measured muon flux</h4>
<p>In reality below 10 GeV muon decay and energy loss become important and the Gaisser parametrization overestimates the muon flux as can be seen in the plot below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/atmmu.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" data-glightbox="description: .lightbox-desc-10" title="Source: Particle Data Group"><img src="images/atmmu.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%" alt="Source: Particle Data Group"></a></p>
<figcaption>Source: Particle Data Group</figcaption>
</figure>
</div>
<p>As can be seen from the measured muon flux has the following characteristics:</p>
<ul>
<li>Muons are the most numerous charged particles at sea level</li>
<li>The mean energy of muons at the ground is <span class="math inline">\(\sim\)</span> 4 GeV.</li>
<li>The integral intensity of vertical muons above 1 GeV/c at sea level is <span class="math inline">\(\approx 70 \mathrm{m}^{-2} \mathrm{s}^{-1} \mathrm{sr}^{-1}\)</span> or <span class="math inline">\(\approx 1 \mathrm{cm}^{-2} \mathrm{min}^{-1}\)</span>.</li>
</ul>
</section>
</section>
<section id="muon-bundles" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="muon-bundles"><span class="header-section-number">3.2.3</span> Muon Bundles</h3>
<p>Sometimes muons also come in groups or <strong>bundles</strong> of parallel muons originated from the same primary CR. Muon bundles sometime look like a single high energy muon. The multiplicity (number of muons in the bundle) if can be measured is correlated with the mass of the orignal CR. The image belowe shows a muon-bundle event observed with the MACRO underground detector.</p>
<p><a href="images/macro-bundle.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="images/macro-bundle.png" class="img-fluid"></a></p>
<section id="charge-ratio" class="level4" data-number="3.2.3.1">
<h4 data-number="3.2.3.1" class="anchored" data-anchor-id="charge-ratio"><span class="header-section-number">3.2.3.1</span> Charge Ratio</h4>
<p>The muon charge ratio reflects the excess of <span class="math inline">\(\pi^+\)</span> over <span class="math inline">\(\pi^-\)</span> and <span class="math inline">\(K^+\)</span> over <span class="math inline">\(K^-\)</span> and the fact that there are more protons than neutrons in the primary spectrum.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_ratio.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" data-glightbox="description: .lightbox-desc-12" title="Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)"><img src="images/muon_ratio.png" class="img-fluid figure-img" style="width:50.0%" alt="Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)"></a></p>
<figcaption>Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)</figcaption>
</figure>
</div>
<p>The increase with energy of the ratio is due to an increasing importance of kaons coming from the process $ p + N + K^+$.</p>
<p>Assuming the following reactions for the production of <span class="math inline">\(\pi^+\)</span> and <span class="math inline">\(\pi^{-}\)</span>:</p>
<p><span class="math display">\[ p + N \rightarrow p^\prime + N^\prime  + k \pi^+ + k \pi^- + r\pi^0 \]</span> <span class="math display">\[ p + N \rightarrow n + N^\prime  + (k + 1) \pi^+ + k \pi^- + r\pi^0 \]</span></p>
<p>where <span class="math inline">\(k\)</span> and <span class="math inline">\(r\)</span> are the multiplicity of the particle species. Assuming same cross sections we obtain:</p>
<p><span class="math display">\[ R = \frac{N(\pi^+)}{N(\pi^-)} = \frac{2k+1}{2k} = 1 + \frac{1}{2k} \]</span></p>
<p>for low energies <span class="math inline">\(k = 2\)</span> and <span class="math inline">\(R \sim 1.25\)</span></p>
</section>
</section>
<section id="neutrinos-fluxes" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="neutrinos-fluxes"><span class="header-section-number">3.2.4</span> Neutrinos Fluxes</h3>
<ul>
<li><p>Neutrinos are the most abundant CR product at sea level, yet they have only recently (compared to other particles) measured due to their extremely low cross-section.</p></li>
<li><p>The process giving neutrino fluxes are the same as for the muons (we saw already) plus the muon decay. Taking into account the decay of pions, kaons and muons gives to a flavor ratio of: <span class="math inline">\(\nu_\mu : \nu_e = 2:1\)</span> and <span class="math inline">\(\nu_e/{\bar \nu_e} \sim \mu^+/\mu^-\)</span></p></li>
<li><p>At few GeV (&gt; <span class="math inline">\(\epsilon_\mu\)</span>) muons will not decay and <span class="math inline">\(\nu_e\)</span> will be supressed as the main source of <span class="math inline">\(\nu_e\)</span> is the muon decay.</p></li>
</ul>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial II: Plot the $\nu_\mu$ and $\nu_e$ atmospheric flux using the package `DaemonFlux` @Yanez:2023lsy">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial II: Plot the <span class="math inline">\(\nu_\mu\)</span> and <span class="math inline">\(\nu_e\)</span> atmospheric flux using the package <code>DaemonFlux</code> <span class="citation" data-cites="Yanez:2023lsy">Yañez and Fedynitch (<a href="chap1.html#ref-Yanez:2023lsy" role="doc-biblioref">2023</a>)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<div id="1259e861" class="cell" data-fig-caption="Neutrino Flux using DaemonFlux @Yanez:2023lsy" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> daemonflux <span class="im">import</span> Flux</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fl <span class="op">=</span> Flux(location<span class="op">=</span><span class="st">'generic'</span>, use_calibration<span class="op">=</span><span class="va">True</span>, debug<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>egrid <span class="op">=</span> np.logspace(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with a square Figure.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> fig.add_gridspec(<span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                      left<span class="op">=</span><span class="fl">0.1</span>, right<span class="op">=</span><span class="fl">0.9</span>, bottom<span class="op">=</span><span class="fl">0.1</span>, top<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                      height_ratios <span class="op">=</span> (<span class="dv">4</span>, <span class="dv">1</span>), wspace<span class="op">=</span><span class="fl">0.05</span>, hspace<span class="op">=</span><span class="fl">0.12</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Axes.</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax_1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ax_2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>], sharex<span class="op">=</span>ax)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ax_1.plot(egrid, fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"numuflux"</span>)<span class="op">+</span>fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"antinumu"</span>), label<span class="op">=</span><span class="vs">r"$\nu_{\mu}$ at $\theta = 60^\circ$"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>ax_1.plot(egrid, fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"nueflux"</span>), label<span class="op">=</span><span class="vs">r"$\nu_</span><span class="sc">{e}</span><span class="vs">$ at $\theta = 60^\circ$"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>ax_1.legend()</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>ax_1.loglog()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>ax_1.grid()</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>ax_2.plot(egrid, fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"numuflux"</span>)<span class="op">/</span>fl.flux(egrid, <span class="st">"60"</span>, <span class="st">"nueflux"</span>), label<span class="op">=</span><span class="vs">r"\nu_{\mu}"</span>, lw<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>ax_2.grid()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>ax_2.set_xscale(<span class="st">"log"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ax_2.set_ylim(<span class="dv">0</span>, <span class="dv">30</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>ax_2.set_xlim(<span class="dv">1</span>, <span class="fl">1e5</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ax_1.set_xlim(<span class="dv">1</span>, <span class="fl">1e5</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>ax_2.set_xlabel(<span class="vs">r"$E_\nu$/GeV"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>ax_1.set_ylabel(<span class="vs">r"$(E_\nu/\mathrm{ GeV})^3 \Phi_\nu (\mathrm{ GeV}\mathrm{ \;cm}^2\mathrm{ s\; sr})^{-1}$"</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>ax_2.set_ylabel(<span class="vs">r"$\Phi_{\nu_\mu} / \Phi_{\nu_e}$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Text(0, 0.5, '$\\Phi_{\\nu_\\mu} / \\Phi_{\\nu_e}$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_files/figure-html/cell-4-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="chap3_files/figure-html/cell-4-output-2.png" width="588" height="553" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In astrophysical sources the ration 2:1 persists. <a href="href=&quot;http://en.wikipedia.org/wiki/Pion#Charged_pion_decays">Why pions don’t decay in to electrons?</a></p>
</div>
</div>
</section>
<section id="fluxes-and-kinematics" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="fluxes-and-kinematics"><span class="header-section-number">3.2.5</span> Fluxes and Kinematics</h3>
<p>As mentioned neutrinos and muons are strongly correlated. However due the two-body kinematics, the energy spectra of the <span class="math inline">\(\nu\)</span>’s and <span class="math inline">\(\mu\)</span>’s from mesons decay are different. For example, the energy of the muon in CoM is given by:</p>
<p><span class="math display">\[E_\mu^{*} = (m_\pi^2 + m_\mu^2)/2m_\pi = 109.8\;\mathrm{MeV}\]</span></p>
<p>and for the neutrino:</p>
<p><span class="math display">\[E_\nu^{*} = (m_\pi^2 - m_\mu^2)/2m_\pi = 29.8\;\mathrm{MeV}\]</span></p>
<p>In the laboratory system, the energies are boosted by the Lorentz factor <span class="math inline">\(\gamma= E_\pi /m_\pi\)</span>, but as can be seen muon carry a much larger fraction of energy than neutrinos. For energies about <span class="math inline">\(1\;\mathrm{TeV}&lt; E_\nu &lt;  10^3\;\mathrm{TeV}\)</span>, the angle averaged atmospheric <span class="math inline">\(\nu_\mu + {\bar \nu_\mu}\)</span> can be approximated by a power law spectrum:</p>
<p><span class="math display">\[\frac{\mathrm{d}N_{\nu_\mu + {\bar \nu_\mu}}}{\mathrm{d}E_\nu} = 7.8 \times 10^{-11}\left(\frac{E_\nu}{1\;\mathrm{TeV}}\right)^{-3.6}\mathrm{cm^2\;s^{-1}\;sr^{-1}\;GeV^{-1}}\]</span></p>
<section id="fluxes-as-function-of-zenith" class="level4" data-number="3.2.5.1">
<h4 data-number="3.2.5.1" class="anchored" data-anchor-id="fluxes-as-function-of-zenith"><span class="header-section-number">3.2.5.1</span> Fluxes as Function of Zenith</h4>
<p>Another difference with respect to the muon fluxes is their dependency with respect to the zenith angle. Since atmospheric muons are not absorved by the Earth, their spectrum spans to the whole sky. The following plot shows the calculated neutrino flux at 1,300 m depth with energies <span class="math inline">\(E_\nu = 10\)</span> GeV.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/nu_zenith.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" data-glightbox="description: .lightbox-desc-14" title="Source: arXiv:1210.5154"><img src="images/nu_zenith.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Source: arXiv:1210.5154"></a></p>
<figcaption>Source: <a href="http://arxiv.org/abs/1210.5154">arXiv:1210.5154</a></figcaption>
</figure>
</div>
<p>The peak at the horizon in the atmospheric neutrino flux is due to the so-called <em>secant theta effect</em>. This effect occurs because pions and kaons that are produced nearly skimming the Earth have more flight time in less dense atmosphere, so they have more chance to decay than interact.</p>
</section>
</section>
<section id="prompt-fluxes" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="prompt-fluxes"><span class="header-section-number">3.2.6</span> Prompt Fluxes</h3>
<p>Apart from kaons and pions, charmed messons will also be produced in the atmosphere. Charm particles have lifetimes so short (<span class="math inline">\(10^{-12}\)</span>s) they almost alway decay before interacting. Muons and neutrinos from charm decay are called <em>prompt</em> muons/neutrinos. They have the following peculiarities:</p>
<ul>
<li>The energy spectrum follows the one of the primary cosmic rays ie that of <span class="math inline">\(\sim E^{-2.7}\)</span>.</li>
<li>Since there is no competition between decay and interaction of the charm particle, the <em>prompt</em> flux is fully <strong>isotropic</strong>.</li>
<li>Since neutrinos are produced in 3-body decays they produced the same amount of <span class="math inline">\(\nu_\mu\)</span> and <span class="math inline">\(\nu_e\)</span>.</li>
</ul>
<p>It is important to note that the prompt fluxes have not been observed yet.</p>
</section>
</section>
<section id="particles-underground" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="particles-underground"><span class="header-section-number">3.3</span> Particles Underground</h2>
<section id="muon-interactions" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="muon-interactions"><span class="header-section-number">3.3.1</span> Muon Interactions</h3>
<p>When muon reaches the ground the will experience the following interactions when travelling through matter with a higher density than air. The will losse energy mostly through the following processes:</p>
<ul>
<li><strong>Ionization.</strong> The continuous energy loss of muons passing through a medium as it ionize the material along the path. We saw however that ionization is mostly independent of the material, as most of them have values of <span class="math inline">\(Z/A \sim 0.5\)</span>.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_ionization.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="images/muon_ionization.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></a></p>
</figure>
</div>
<ul>
<li><strong>Bremsstrahlung.</strong> Also called braking radiation. In the electric field of a nucleus or atomic electrons, muons can radiate high energy photons. If the photon has energy enough it can initiate an electromagnetic shower.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_bremsstrahlung.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="images/muon_bremsstrahlung.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></a></p>
</figure>
</div>
<ul>
<li><strong>Pair production.</strong> A muon can radiate a virtual photon which, again in the electric field of a nucleus, can convert into a real <span class="math inline">\(e^+e^-\)</span> pair. As in the case of bremsstrahlung, the pair production will initate an electromagnetic shower.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_pair-production.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="images/muon_pair-production.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></a></p>
</figure>
</div>
<ul>
<li><strong>Photonuclear interactions.</strong> A muon can radiate a virtual photon which directly interacts with a nucleus in the muon propagation medium. The interaction is either electromagnetic or following the fluctuation of the photon into a quark-antiquark pair (i.e.&nbsp;a virtual vector meson). This interaction will generate an hadronic shower.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_photonuclear.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="images/muon_photonuclear.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></a></p>
</figure>
</div>
</section>
<section id="muon-energy-losses" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="muon-energy-losses"><span class="header-section-number">3.3.2</span> Muon Energy losses</h3>
<p>The energy losses due to ionization are continuous while in radiation processes the energy is lost in bursts along the muon path. When a muon is travelling through a dielectric medium like ice or water, it will emit cherenkov photons as wells, but due to the stochastics energy losses electromagnetic and hadronic showers are generated along the muon track. The following figure illustrates this process:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon_energylosses.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="images/muon_energylosses.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></a></p>
</figure>
</div>
<p>It is worth noting that photonuclear interactions are subdominant when compared to bremsstrahlung and pair-production, so most of the showers will be electromagnetic showers. The equation that describes the energy loss for muons at high energy can be simplified to:</p>
<p><span class="math display">\[\frac{\mathrm{ d}E_\mu}{\mathrm{ d}X} = -\alpha -\beta E_\mu\]</span></p>
<p>where <span class="math inline">\(X\)</span> is the thickness of the material (in <span class="math inline">\(\mathrm{ g/cm}^2\)</span>), <span class="math inline">\(\alpha\)</span> is the energy loss due to ionization and <span class="math inline">\(\beta = \beta_{br} + \beta_{pair} + \beta_{ph}\)</span> are the three discrete energy loss processes: bremsstrahlung, electron-positron production and electromagnetic interaction with the nuclei. Thickness is also given sometimes in units of meters water equivalent (1 m.w.e. = <span class="math inline">\(10^2 \mathrm{\; g/cm^2}\)</span>). Due to the energy dependency of the radiative processes, higher energy muons will have more stochastic energy losses than lower energy muons.</p>
<p>The <strong>critical energy</strong> is when both losses are equal, ie <span class="math inline">\(\epsilon_\mu = \alpha/\beta\)</span>. Typical values are <span class="math inline">\(\alpha \simeq 2 \mathrm{ \;MeV\;g}^{-1} \mathrm{ \;cm}^2\)</span> and <span class="math inline">\(\beta \simeq 4 \times 10^{-6} \;\mathrm{ g^{-1}\;cm^2}\)</span>, so <span class="math inline">\(\epsilon_\mu \approx 500\)</span> GeV.</p>
<p>The following plots showd simulated muons bundles in <a href="https:icecube.wisc.edu">IceCube</a>. The stochastic energy losses are particular clear in the right figure.</p>
<div class="{.layout-ncol=2}">
<p><img src="images/musmooth.jpg" class="img-fluid quarto-figure quarto-figure-center" style="width:40.0%"> <img src="images/mustochastic.jpg" class="img-fluid quarto-figure quarto-figure-center" style="width:40.0%"></p>
</div>
</section>
<section id="muon-range" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="muon-range"><span class="header-section-number">3.3.3</span> Muon Range</h3>
<p>By solving the energy loss equation we can estimate the range <span class="math inline">\(R\)</span> for a muon <span class="math inline">\(E_\mu\)</span>, ie the underground depth this muon will reach until its energy is 0 (in reality the muon when reaching low energies will decay):</p>
<p><span class="math display">\[ R(E_\mu) = \frac{1}{\beta}\log\left( 1 + \frac{E_\mu}{\epsilon_\mu}\right)\]</span></p>
<p>Assuming the muon spectrum at sea level can be approximated to a power law <span class="math inline">\(I_\mu(&gt;E_\mu) = AE_\mu^{-\gamma}\)</span> and using the relationship between range and energy we can write the <em>depth-intensity relation</em> (DIR):</p>
<p><span class="math display">\[I_\mu(&gt;E_\mu, R) = A\left[\frac{\alpha}{\beta}(e^{\beta R} - 1)\right]^{-\gamma}\]</span></p>
<p>The plot below shows the depth-intensity muons for vertical directions. The grey-area are neutrino-induced muons (horizontal, up-wards)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/muon-depth.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="images/muon-depth.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</section>
<section id="neutrino-interactions" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="neutrino-interactions"><span class="header-section-number">3.3.4</span> Neutrino Interactions</h3>
<section id="weak-interaction" class="level4" data-number="3.3.4.1">
<h4 data-number="3.3.4.1" class="anchored" data-anchor-id="weak-interaction"><span class="header-section-number">3.3.4.1</span> Weak interaction</h4>
<p>Neutrinos feel only the weak force thus interactions with matter mediated by <span class="math inline">\(W\)</span> and <span class="math inline">\(Z\)</span> bosons with cross-sections typical of weak processes. Feynman diagrams factor along two lines:</p>
<ul>
<li>Neutral current (NC) interactions - exchange of <span class="math inline">\(Z\)</span></li>
<li>Charged current (CC) interaction - exchange of <span class="math inline">\(W^{\pm}\)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/neutrino-interactions.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="images/neutrino-interactions.svg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<p>Neutrinos will scatter from electrons as well as nuclear matter.</p>
<ul>
<li><p>For energies <span class="math inline">\(E_\nu &lt; 1 \mathrm{GeV}\)</span> neutrinos interact with hadronds via <strong>elastic</strong> or <strong>quasielastic scattering</strong>.</p></li>
<li><p>For energies <span class="math inline">\(E_\nu \gg 1 \mathrm{GeV}\)</span> neutrinos do not scatter on hadronds as a compound of quarks, they start to <em>see</em> and interact directly with the quarks, this is the so-called <strong>Deep Inelastic Scattering</strong>.</p></li>
</ul>
</section>
</section>
<section id="neutrino-cross-sections-at-gev-energies" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="neutrino-cross-sections-at-gev-energies"><span class="header-section-number">3.3.5</span> Neutrino cross-sections at GeV energies</h3>
<p>The anti-neutrino cross-section at GeV energies is a factor ~2 lower (naively should be 3, but the factor 2 comes from the structure function of the nucleus) than the neutrino cross-section due to the helicity.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/pdg_plot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="images/pdg_plot.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<p>At <span class="math inline">\(E_\nu \gg 1 \mathrm{GeV}\)</span> the total DIS cross-section (ie, assuming CC and NC together) can be approximated to:</p>
<p><span class="math display">\[\sigma_{\nu p} \simeq 0.69 \times 10^{-38} \left(\frac{E_\nu}{ 1 \mathrm{\; GeV}}\right) \mathrm{ \; cm}^2\]</span> <span class="math display">\[\sigma_{\bar{\nu} p} \simeq 0.35 \times 10^{-38}\left(\frac{E_\nu}{ 1 \mathrm{\; GeV}}\right) \mathrm{ \; cm}^2\]</span></p>
<p>Sometimes the cross-section is expressed as <span class="math inline">\(\nu + N\)</span> where <span class="math inline">\(N\)</span> is the nucleon definition as:</p>
<p><span class="math display">\[N = \frac{n+p}{2}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Earth is transparent to GeV neutrinos">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Earth is transparent to GeV neutrinos
</div>
</div>
<div class="callout-body-container callout-body">
<p>We are going to calculate the mean free path of neutrinos of energies of <span class="math inline">\(\sim GeV\)</span>. Note that mean free path can be expressed as:</p>
<p><span class="math display">\[l = \frac{1}{n_N \sigma_{\nu N}}\]</span></p>
<p>where <span class="math inline">\(n_N\)</span> is the number density of <em>nucleons</em> and not atoms. As we saw in lecture 2 we can re-express the number density as:</p>
<p><span class="math display">\[n_N = \frac{N_A}{\mathcal{M}}\rho\]</span></p>
<p>where <span class="math inline">\(\mathcal{M}\)</span> is the molar mass of one mole of nucleons and <span class="math inline">\(\rho\)</span> is the mass density of the medium. However, by definition a mol of nucleons has a mass of 1 g (Remember that a mol of <span class="math inline">\(^{12}C\)</span> atoms has a mass of 12 g). So, we can rewrite as <span class="math inline">\(n_N = N_A \rho\)</span>. Below there is another way to estimate the mean free path:</p>
<div id="ffa2ed23" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy <span class="im">import</span> constants <span class="im">as</span> ct</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy <span class="im">import</span> units <span class="im">as</span> u</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Earth mass</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (ct.M_earth)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Neutron/proton mass</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (ct.m_n)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Earth radius</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (ct.R_earth)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#number of nucleons</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> ct.M_earth<span class="op">/</span>ct.m_n </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Earth volume</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>Ve <span class="op">=</span> <span class="dv">4</span><span class="op">/</span><span class="dv">3</span><span class="op">*</span>np.pi<span class="op">*</span>ct.R_earth<span class="op">**</span><span class="dv">3</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Nucleon density</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>Nd <span class="op">=</span> N<span class="op">/</span>Ve</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Cross section</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> <span class="fl">1e-38</span> <span class="op">*</span> u.cm<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean free path:</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(s <span class="op">*</span> Nd.to(<span class="dv">1</span><span class="op">/</span>u.cm<span class="op">**</span><span class="dv">3</span>))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (<span class="ss">f"The mean free path is: </span><span class="sc">{</span>L<span class="sc">.</span>to(u.km)<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Name   = Earth mass
  Value  = 5.972167867791379e+24
  Uncertainty  = 1.3422009501651213e+20
  Unit  = kg
  Reference = IAU 2015 Resolution B 3 + CODATA 2018
  Name   = Neutron mass
  Value  = 1.67492749804e-27
  Uncertainty  = 9.5e-37
  Unit  = kg
  Reference = CODATA 2018
  Name   = Nominal Earth equatorial radius
  Value  = 6378100.0
  Uncertainty  = 0.0
  Unit  = m
  Reference = IAU 2015 Resolution B 3
The mean free path is: 304808158.92 km</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="neutrino-cross-sections-at-tev-energies" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="neutrino-cross-sections-at-tev-energies"><span class="header-section-number">3.3.6</span> Neutrino cross-sections at TeV energies</h3>
<ul>
<li><p>At low energies the valence quark parton distribution dominates and both the neutrino NC and CC cross-section grows linear with energy since the transfer momemtum is <span class="math inline">\(q^2 \ll M_{W,Z}\)</span> and so the propagator term is <span class="math inline">\(\sim 1/M^2_{W,Z}\)</span></p></li>
<li><p>Above 10<span class="math inline">\(^{4}\)</span> GeV where the gauge-boson propagator restricts the momentum transfer to values near <span class="math inline">\(M_{W,Z}\)</span> (<span class="math inline">\(\sim 1/(q^2 - M^2_{W,Z})\)</span>) and damps the cross-section increase.</p></li>
</ul>
<p><a href="images/break_cc_new.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="images/break_cc_new.png" class="img-fluid"></a></p>
</section>
<section id="high-energy-cross-sections" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="high-energy-cross-sections"><span class="header-section-number">3.3.7</span> High energy Cross-Sections</h3>
<p>The following shows the neutrino cross section:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/uhenucx.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" data-glightbox="description: .lightbox-desc-24" title="Calculated neutrino cross sections taken from arXiv:1309.1764"><img src="images/uhenucx.png" class="img-fluid figure-img" alt="Calculated neutrino cross sections taken from arXiv:1309.1764"></a></p>
<figcaption>Calculated neutrino cross sections taken from <a href="http://arxiv.org/abs/1309.1764">arXiv:1309.1764</a></figcaption>
</figure>
</div>
<ul>
<li><p>At high energies the asymetry between neutrinos and antineutrinos is lost due to the interaction with <em>sea quarks</em> (<span class="math inline">\(q\bar{q}\)</span>)</p></li>
<li><p>Neutrinos interact mostly with hadrons (quarks) instead of electrons due the their larger target mass. However at <span class="math inline">\(E_\nu \approx 6.3\)</span> PeV the Glashow resonance appears: <span class="math inline">\({\hbar \nu_e} + e \rightarrow W\)</span> making the cross-section higher than the one with hadrons.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Earth is opaque to PeV neutrinos">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Earth is opaque to PeV neutrinos
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>At about 100 TeV the mean free path for neutrino-nucleus scattering is about 10<span class="math inline">\(^{10}\)</span> c.m.w.e. which is about the matter thickness along the Earth diameter.</p></li>
<li><p>This means that UHE neutrino observatories (like IceCube) the flux of neutrinos comming from the nadir is stronly suppressed.</p></li>
<li><p>There is only one exception. A very high energy beam of <span class="math inline">\(\nu_\tau\)</span> at one side of the Earth <span class="math inline">\(E\gg 1\)</span> PeV can end up at the other side as lower energy <span class="math inline">\(\nu_\tau, \nu_e,\nu_\mu\)</span> thought the <strong>tau regeneration</strong> effect: <span class="math inline">\(\nu_\tau \rightarrow \tau \rightarrow \nu_\tau\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="neutrino-signatures-in-a-neutrino-detector" class="level3" data-number="3.3.8">
<h3 data-number="3.3.8" class="anchored" data-anchor-id="neutrino-signatures-in-a-neutrino-detector"><span class="header-section-number">3.3.8</span> Neutrino signatures in a neutrino detector</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/nu_signatures.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="images/nu_signatures.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<ul>
<li><ol start="2" type="a">
<li>In CC <span class="math inline">\(\nu_e\)</span> interactions an hadronic and EM shower initiated by the <span class="math inline">\(e\)</span> is produced. About 20% of the energy goes in the hadronic shower and 80% to the lepton and therfore to the EM shower.</li>
</ol></li>
<li><ol start="4" type="a">
<li>In CC <span class="math inline">\(\nu_\tau\)</span> d) interaction again an hadronic and EM shower are produced as the <span class="math inline">\(\tau\)</span> decays almost inmediately to pions or other charge leptons. In the decay another <span class="math inline">\(\nu_\tau\)</span> is produced <strong>tau regeneration effect</strong>. At very high energyes the two showers can be separated giving a <em>double bang</em> signature or a <em>lollipop</em> if the first shower happens outside the detector.</li>
</ol></li>
<li><ol start="3" type="a">
<li>In CC <span class="math inline">\(\nu_\mu\)</span> the muon only undergoes radiation losses (not ionization) and hence the track of the muon can be reconstructed.</li>
</ol></li>
<li><ol type="a">
<li>In NC only an hadronic shower is visible.</li>
</ol></li>
</ul>
</section>
<section id="event-rate-in-an-underground-experiment." class="level3" data-number="3.3.9">
<h3 data-number="3.3.9" class="anchored" data-anchor-id="event-rate-in-an-underground-experiment."><span class="header-section-number">3.3.9</span> Event rate in an underground experiment.</h3>
<p>An estimate of the detection rate of neutrino events is equivalent to calculate the rate of a neutrino-induced muon/cascades flux:</p>
<p><span class="math display">\[R(E_{vis}, \theta) = \int_{E_{vis}} P_{\nu\rightarrow l} (E_\nu, E_{vis}) P_{shadow}(\theta, E_\nu) \frac{\mathrm{ d}N_\nu}{\mathrm{ d}E_\nu}\mathrm{ d}E_\nu\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(P_{\nu\rightarrow l}(E_\nu, E_{vis})\)</span> is the probability that a neutrino interacts with an nucleus to produce a <span class="math inline">\(\mu\)</span> or an EM or hadronic cascade with a minimum energy <span class="math inline">\(E_{vis}\)</span> <em>visible</em> in the detector.</li>
<li><span class="math inline">\(P_{shadow} (\theta, E_\nu)\)</span>. Probability of neutrino with zenith angle <span class="math inline">\(\theta\)</span> and energy <span class="math inline">\(E_\nu\)</span> of being absorved by Earth.</li>
<li><span class="math inline">\({\mathrm{ d}N_\nu}/{\mathrm{ d}E_\nu}\)</span>. Neutrino flux at the surface.</li>
</ul>
<section id="interaction-probability-p_nurightarrow-l" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="interaction-probability-p_nurightarrow-l">Interaction probability: <span class="math inline">\(P_{\nu\rightarrow l}\)</span></h4>
<p>The probability of a neutrino to produce a lepton or shower visible in the detector can be writen as:</p>
<p><span class="math display">\[P_{\nu \rightarrow l} = N_A \int_{E_{min}}^{E_\nu} \mathrm{ d}E_l \frac{\mathrm{ d}\sigma}{\mathrm{ d}E_l}r_l(E_l, E_{vis})\]</span></p>
<p>where <span class="math inline">\(r_l\)</span> is the detection range of the produced lepton/cascade with energy <span class="math inline">\(E_l\)</span> ending with the minimal energy <span class="math inline">\(E_{vis}\)</span>, and <span class="math inline">\({\mathrm{ d}\sigma}/{\mathrm{ d}E_l}\)</span> is the neutrino cross-section to produce a lepton/cascade with energy <span class="math inline">\(E_l\)</span>.</p>
<p>At high energy the event rate is dominated by neutrino-induced muons due to the long range of the high energy muons.</p>
</section>
<section id="earth-shadow-p_shadow" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="earth-shadow-p_shadow">Earth Shadow: <span class="math inline">\(P_{shadow}\)</span></h4>
<p>The mean free path of neutrinos can be expressed as <span class="math inline">\(\lambda = (N_A \sigma_{tot})^{-1}\)</span>. The shadow fact then can be expressed as:</p>
<p><span class="math display">\[P_{shadow} = e^{-N_A \sigma_{tot} X(\theta)}\]</span></p>
<p>Where <span class="math inline">\(X(\theta)\)</span> is the column depth travelled by the neutrino through the Earth with a zenith angle <span class="math inline">\(\theta\)</span>.</p>
<p>See <strong>Exercises 2</strong> for an evaluation of the event rate in an underground detector.</p>
</section>
</section>
<section id="neutrino-oscillations" class="level3" data-number="3.3.10">
<h3 data-number="3.3.10" class="anchored" data-anchor-id="neutrino-oscillations"><span class="header-section-number">3.3.10</span> Neutrino Oscillations</h3>
<p>Neutrinos are generated in flavor eingenstate however propagation is done in mass eingenstate, since each planar wave has a different frecuency given their different masses, the neutrino detected (also in flavor eingenstate) will have a different interference pattern than the one generated given rise to neutrino flavor oscillations.</p>
<ul>
<li><p>As a result of these changes in relative phases, neutrinos oscillate from one flavor to another as they travel. Low-energy neutrinos oscillate in a shorter distance than high-energy neutrinos.</p></li>
<li><p>A curious aspect of quantum physics is that only the <strong>probability of the flavor of neutrino changes as it travels</strong>.</p></li>
<li><p>The neutrino <em>only becomes a definite flavor when it interacts</em> in a detector - by finding whether an electron, muon, tau is created.</p></li>
</ul>
</section>
<section id="the-pmns-matrix" class="level3" data-number="3.3.11">
<h3 data-number="3.3.11" class="anchored" data-anchor-id="the-pmns-matrix"><span class="header-section-number">3.3.11</span> The PMNS Matrix</h3>
<p>The Pontecorvo-Maki-Nakagawa-Sakata matrix is the one that relates the mass eingenstates with the flavor eingenstates:</p>
<p><span class="math display">\[\begin{pmatrix} \nu_e \\ \nu_\mu \\ \nu_\tau \end{pmatrix} = U_{PMNS} \begin{pmatrix} \nu_1 \\ \nu_2 \\ \nu_1 \end{pmatrix}\]</span></p>
<p>with:</p>
<p><span class="math display">\[
\begin{aligned}
U_{PMNS} &amp;=
\begin{pmatrix}
c_{12}c_{13} &amp; s_{12}c_{13} &amp; s_{13}e^{-i\delta} \\
-s_{12}c_{23} - c_{12}s_{23}s_{13}e^{i\delta} &amp; c_{12}c_{23} - s_{12}s_{23}s_{13}e^{i\delta} &amp; s_{23}c_{13} \\
s_{12}s_{23} - c_{12}c_{23}s_{13}e^{i\delta} &amp; -c_{12}s_{23} - s_{12}c_{23}s_{13}e^{i\delta} &amp; c_{23}c_{13} \end{pmatrix} \\
&amp;= \begin{pmatrix}
1 &amp; 0 &amp; 0 \\ 0 &amp; c_{23} &amp; s_{23} \\ 0 &amp; -s_{23} &amp; c_{23}
\end{pmatrix}
\begin{pmatrix}
c_{13} &amp; 0 &amp; s_{13}e^{-i\delta} \\ 0 &amp; 1 &amp; 0 \\ -s_{13}e^{i\delta} &amp; 0 &amp; c_{13}
\end{pmatrix}
\begin{pmatrix}
c_{12} &amp; s_{12} &amp; 0 \\ -s_{12} &amp; c_{12} &amp; 0 \\ 0 &amp; 0 &amp; 1
\end{pmatrix}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(s_{ij} = \sin \theta_{ij}\)</span>, <span class="math inline">\(c_{ij} = \cos \theta_{ij}\)</span>. The term <span class="math inline">\(\delta\)</span> is a CP violation term, if <span class="math inline">\(s_{13} = 0\)</span> we won’t be able to measure <span class="math inline">\(\delta\)</span> as it always multiplies <span class="math inline">\(s_{13}\)</span></p>
</section>
<section id="the-2-flavor-mixing-case" class="level3" data-number="3.3.12">
<h3 data-number="3.3.12" class="anchored" data-anchor-id="the-2-flavor-mixing-case"><span class="header-section-number">3.3.12</span> The 2-flavor mixing case</h3>
<p>Let’s assume 2 flavor eigenstates identified as rotations of 2 mass eigenstates:</p>
<p><span class="math display">\[\begin{pmatrix} \nu_e \\ \nu_\mu \end{pmatrix} = \begin{pmatrix} \cos\theta &amp; \sin\theta \\ -\sin\theta &amp; \cos\theta \end{pmatrix} \begin{pmatrix} \nu_1 \\ \nu_2 \end{pmatrix}.\]</span></p>
<p>The angle <span class="math inline">\(\theta\)</span> is called the mixing angle.</p>
<p>The mass eigenstates evolve as plane waves with fixed momemtum <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[|\nu_{i}(t, x)\rangle = e^{ -i (E_{i} t - p_i x) }|\nu_{i}(0,0)\rangle\]</span></p>
<p>Let’s imagine we start at <span class="math inline">\((x,t) = (0,0)\)</span> with a pure beam of <span class="math inline">\(\nu_e\)</span>:</p>
<p><span class="math display">\[\begin{pmatrix} 1 \\ 0 \end{pmatrix} = \begin{pmatrix} \cos\theta &amp; \sin\theta \\ -\sin\theta &amp; \cos\theta \end{pmatrix} \begin{pmatrix} \nu_1(0,0) \\ \nu_2(0,0) \end{pmatrix}.\]</span></p>
<p><span class="math display">\[|\nu_{1}(0,0)\rangle = \cos \theta\]</span> <span class="math display">\[|\nu_{2}(0,0)\rangle = \sin \theta\]</span></p>
<p>and as they evolved:</p>
<p><span class="math display">\[|\nu_{1}(t,x)\rangle = \cos \theta e^{ -i (E_{1} t - p_1 x)  }\]</span> <span class="math display">\[|\nu_{2}(t,x)\rangle = \sin \theta e^{ -i (E_{2} t - p_2 x) }\]</span></p>
<p>So after a while the wave form of the <span class="math inline">\(\nu_\alpha\)</span> is given by:</p>
<p><span class="math display">\[|\nu_{e}(t, x)\rangle = \cos^2 \theta e^{ -i (E_{1} t - p_1 x)  } + \sin^2 \theta e^{ -i (E_{2} t - p_2 x) } = A_e\]</span> <span class="math display">\[|\nu_{\mu}(t, x)\rangle = -\sin\theta\cos \theta e^{ -i (E_{1} t - p_1 x)  } + \cos\theta\sin \theta e^{ -i (E_{2} t - p_2 x) } = A_e\]</span></p>
<section id="example-of-survival-probability-for-the-2-flavor-mixing" class="level4" data-number="3.3.12.1">
<h4 data-number="3.3.12.1" class="anchored" data-anchor-id="example-of-survival-probability-for-the-2-flavor-mixing"><span class="header-section-number">3.3.12.1</span> Example of survival probability for the 2-flavor mixing</h4>
<p><span class="math display">\[\begin{aligned}
P(\nu_e \rightarrow \nu_\mu) = \left|\langle \nu_{\mu}(t,x)|\nu_{e}(0,0)\rangle\right|^2 &amp;=\left|\cos\theta \sin\theta (e^{i(E_2 t - p_2 x)} - e^{i(E_1 t -p_1 x)})\right|^2\\
&amp;=
\cos^2\theta\sin^2\theta \left|e^{i(E_2 t - p_2 x)} - e^{i(E_1 t -p_1 x)}\right|^2
\end{aligned}
\]</span></p>
<p>using <span class="math inline">\(e^{\pm ix} = \cos x \pm i\sin x\)</span></p>
<p><span class="math display">\[
\begin{aligned}
P(\nu_e \rightarrow \nu_\mu)&amp;= 2 \cos^2\theta\sin^2\theta ( 1 - \cos (E_2t - p_2x - E_1 t - p_1 x))\\
&amp;= \sin^2 2\theta \sin^2 \left(\frac{(E_2 - E_1)t - (p_2 - p_1)x }{2}\right) \\
&amp;=\sin^2 2\theta \sin^2 \left(\frac{\Delta m_{12}^2 L}{4E}\right)
\end{aligned}
\]</span></p>
<p>using <span class="math inline">\(p_i = \sqrt{E^2_i -m_i^2}\sim E_i(1-\frac{m^2_i}{E_i^2})\)</span>, and in natural units <span class="math inline">\(t = x = L\)</span> we can write the phase difference as:</p>
<p><span class="math display">\[(E_2 - E_1)t - (p_2 - p_1)x = (\frac{m_1^2}{2E_1}-\frac{m_2^2}{2E_2})L = \frac{\Delta m_{12}^2L}{2E}\]</span></p>
<p>And the survival probability is:</p>
<p><span class="math display">\[P(\nu_e \rightarrow \nu_e)  = 1 - P(\nu_e \rightarrow \nu_\mu) = 1- \sin^2 2\theta \sin^2\left(\frac{\Delta m_{12}^2 L}{4E}\right)\]</span></p>
<p>Replacing <span class="math inline">\(\hbar\)</span> and <span class="math inline">\(c\)</span> the expression can be written as:</p>
<p><span class="math display">\[P(\nu_e \rightarrow \nu_e)  = 1 - \sin^2 2\theta \sin^2\left[1.27 \left(\frac{\Delta m^2_{12}}{\mathrm{eV}^2}\right)\frac{L/\mathrm{km}}{E/\mathrm{GeV}}\right]\]</span></p>
<p>We assumed that the mass eigenstates are created with the same energy or momentum and so <span class="math inline">\(E_i = E_j\)</span>.This assumption is not necessary and it comes from the fact we use the plane wave approximation. Using the correct formalism of wave packets the result is the same.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Tutorial III: Plot the survival probability of $\nu_e \rightarrow \nu_e$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tutorial III: Plot the survival probability of <span class="math inline">\(\nu_e \rightarrow \nu_e\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<div id="1b0d7f8d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> astropy.units <span class="im">as</span> u</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">180</span> <span class="co"># km</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>delta_m_sun <span class="op">=</span> <span class="fl">7.0e-5</span> <span class="co"># eV^2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>sin_square_theta_12 <span class="op">=</span> <span class="fl">0.84</span> <span class="co">#maximum mixing</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prob_survival(E, L):</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> sin_square_theta_12 <span class="op">*</span> np.sin(<span class="fl">1.27</span><span class="op">*</span>delta_m_sun <span class="op">*</span> L <span class="op">/</span> E)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"$E_\nu (\mathrm{ MeV})$"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"$P_</span><span class="sc">{ee}</span><span class="st">$"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> np.linspace(<span class="fl">0.1</span>, <span class="dv">15</span>, <span class="dv">1000</span>) <span class="co">#in MeV</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>ax.plot(E, prob_survival(E<span class="op">*</span><span class="fl">1e-3</span>,L), lw<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">"L = </span><span class="sc">%i</span><span class="st"> km</span><span class="ch">\n</span><span class="st">"</span><span class="op">%</span>L<span class="op">+</span><span class="vs">r"$P_</span><span class="sc">{ee}</span><span class="vs"> = 1 -\sin^2 2\theta\sin^2(\Delta m^2L/4E_\nu)$"</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_files/figure-html/cell-6-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="chap3_files/figure-html/cell-6-output-1.png" width="835" height="387" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Eventually at low enough E / long baselines, neutrino beam becomes fully mixed and energy resolution and source extent conspire to produce 50/50 beam.</p>
<div id="4ce2c587" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>y, x <span class="op">=</span> np.meshgrid(np.linspace(<span class="dv">50</span>,<span class="dv">180</span>,<span class="dv">100</span>), np.linspace(<span class="fl">0.1</span>, <span class="dv">15</span>, <span class="dv">100</span>) )</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> prob_survival(x<span class="op">*</span><span class="fl">1e-3</span>,y)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> ax.pcolormesh(x, y, z, cmap <span class="op">=</span> <span class="st">'RdBu'</span>, shading<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>cax <span class="op">=</span> fig.colorbar(img)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Distance (km)"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"$E_\nu (\mathrm{ MeV})$"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>cax.set_label(<span class="st">"Probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_files/figure-html/cell-7-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="chap3_files/figure-html/cell-7-output-1.png" width="817" height="459" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="general-case" class="level3" data-number="3.3.13">
<h3 data-number="3.3.13" class="anchored" data-anchor-id="general-case"><span class="header-section-number">3.3.13</span> General case</h3>
<p>Taking greek letters of the flavor eingenstates and latin letter the mass eingenstates we can write:</p>
<p><span class="math display">\[|\nu_\alpha(x,t)\rangle = \sum_{k=1,2,3} U_{\alpha k} |\nu_k (x,t)\rangle = \sum_{k=1,2,3} U_{\alpha k} e^{-i\Phi_k}|\nu_k (0,0)\rangle\]</span></p>
<p>inverting the mixing matrix we have:</p>
<p><span class="math display">\[|\nu_k (0,0)\rangle =\sum_\gamma U^*_{\gamma  k} |\nu_\gamma(0,0)\rangle\]</span></p>
<p>putting it in the equation above:</p>
<p><span class="math display">\[|\nu_\alpha(x,t)\rangle =\sum_{k=1,2,3} U_{\alpha k} e^{-i\Phi_k}\sum_\gamma U^*_{\gamma  k} |\nu_\gamma(0,0)\rangle\]</span></p>
<p>If we want to evaluate the probability of finding a neutrino <span class="math inline">\(\beta\)</span> when we had <span class="math inline">\(\alpha\)</span> is the transition amplitude is given by:</p>
<p><span class="math display">\[\begin{aligned}
\mathcal{A}(\nu_\alpha(0,0)\rightarrow \nu_\beta(x,t)) &amp;= \langle \nu_\beta(x,t)|\nu_\alpha(0,0)\rangle \\
&amp;= \sum_\gamma \sum_k U_{\gamma k}e^{i\Phi_k}U^*_{\beta k}\langle \nu_\gamma(0,0)|\nu_\alpha(0,0)\rangle \\
&amp;= \sum_k U_{\alpha  k}e^{i\Phi_k}U^*_{\beta k}
\end{aligned}\]</span></p>
<p>where we used the fact that flavor eingenstates are ortogonal and hence <span class="math inline">\(\langle \nu_\gamma(0,0)|\nu_\alpha(0,0)\rangle = \delta_{\gamma,\alpha}\)</span>.</p>
<p>The oscillation probability is then:</p>
<p><span class="math display">\[\begin{aligned}
P(\nu_\alpha \rightarrow \nu_\beta) = |\mathcal{A}(\nu_\alpha(0,0)\rightarrow \nu_\beta(x,t))|^2 &amp;= \left|\sum_k U_{\alpha i}e^{i\Phi_i}U^*_{\beta i}\right|^2\\
&amp;=\sum_i U_{\alpha i}e^{i\Phi_i}U^*_{\beta i}\sum_j U^*_{\alpha j}e^{-i\Phi_j}U_{\beta j}\\
&amp;=\sum_j\sum_i U_{\alpha i}U^*_{\beta i}U^*_{\alpha j}U_{\beta j}e^{-i(\Phi_j-\Phi_i)}
\end{aligned}\]</span></p>
<p>where <span class="math inline">\(\Phi_i = E_i t- p_i x\)</span> and so:</p>
<p><span class="math display">\[\Phi_i - \Phi_j = (E_i - E_j)t - (p_i -p_j)x\]</span></p>
<p>using <span class="math inline">\(p_i = \sqrt{E^2_i -m_i^2}\sim E_i(1-\frac{m^2_i}{E_i^2})\)</span> we can write the phase difference as:</p>
<p><span class="math display">\[\Phi_i - \Phi_j = (\frac{m_i^2}{2E_i}-\frac{m_j^2}{2E_j})L = \frac{\Delta m_{ij}^2L}{2E}\]</span></p>
<p>where we used the fact that at relativistic speeds <span class="math inline">\(t = x = L\)</span> and a dodgy approximation where we assumed that the mass eigenstates are created with the same energy or momentum and so <span class="math inline">\(E_i = E_j\)</span>.This assumption is not necessary, but we find that whatever assumption is made you get the the same result. The fact that we have to make such an approximation comes from the way that we are modelling the mass eigenstates as plane waves. If we were to do the analysis assuming that the mass states were wavepackets instead we would not need the equal momentum (equal energy) assumption and would still get the same answer.</p>
<p>With this we can rewrite the oscillation probability as:</p>
<p><span class="math display">\[\begin{matrix}P(\nu_\alpha \rightarrow \nu_\beta)=\delta_{\alpha\beta} &amp; - &amp; 4{\displaystyle \sum_{i&gt;j}\mathrm{ Re}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*}})\sin^{2}(\frac{\Delta m_{ij}^{2}L}{4E})\\ &amp; + &amp; {\displaystyle 2\sum_{i&gt;j}\mathrm{ Im}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*})\sin(}\frac{\Delta m_{ij}^{2}L}{2E}),\end{matrix}\]</span></p>
<p>For <span class="math inline">\(\delta = 0\)</span> the last term is 0.</p>
</section>
<section id="about-symmetries." class="level3" data-number="3.3.14">
<h3 data-number="3.3.14" class="anchored" data-anchor-id="about-symmetries."><span class="header-section-number">3.3.14</span> About symmetries.</h3>
<ul>
<li>Consequences of CPT invariance:</li>
</ul>
<p><span class="math display">\[P(\nu_\alpha \rightarrow \nu_\beta) = P({\bar \nu_\beta} \rightarrow {\bar \nu_\alpha})\]</span></p>
<ul>
<li>Conditions of CP invariance:</li>
</ul>
<p><span class="math display">\[P(\nu_\alpha \rightarrow \nu_\beta) = P({\bar \nu_\alpha} \rightarrow {\bar \nu_\beta}) \]</span></p>
<ul>
<li>Condition os T invariance:</li>
</ul>
<p><span class="math display">\[P({\nu_\alpha} \rightarrow {\nu_\beta}) = P({\nu_\beta} \rightarrow {\nu_\alpha})\mathrm{\; and\; }P({\bar \nu_\alpha} \rightarrow {\bar \nu_\beta}) = P({\bar \nu_\beta} \rightarrow {\bar\nu_\alpha})\]</span></p>
<p>Only if <span class="math inline">\(U\)</span> is not real we can have CP violation effects ie:</p>
<p><span class="math display">\[P(\nu_\alpha \rightarrow \nu_\beta) - P({\bar \nu_\alpha} \rightarrow {\bar \nu_\beta}) ={ 4 \sum_{i&gt;j}\mathrm{ Im}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*})\sin(}\frac{\Delta m_{ij}^{2}L}{2E})\]</span></p>
</section>
<section id="mass-hierarchy" class="level3" data-number="3.3.15">
<h3 data-number="3.3.15" class="anchored" data-anchor-id="mass-hierarchy"><span class="header-section-number">3.3.15</span> Mass hierarchy</h3>
<p>But this means that neutrinos oscillations can be described in terms of 6 parameters: <span class="math inline">\(\theta_{12}\)</span>, <span class="math inline">\(\theta_{13}\)</span> and <span class="math inline">\(\theta_{23}\)</span> plus 2 mass-squared differences, <span class="math inline">\(\Delta m_{12}^2\)</span> and <span class="math inline">\(\Delta m_{32}^2\)</span> and one CP violating phase <span class="math inline">\(\delta_{CP}\)</span>. Althought we can measured the mass-squared differences in neutrino oscillation experiments, we cannot know the absolute scales nor the mass hierarchy.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://inspirehep.net/files/ce8abf20fa840b880444095bc363c6b2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" data-glightbox="description: .lightbox-desc-28" title="Source: arXiv:1205.2671"><img src="https://inspirehep.net/files/ce8abf20fa840b880444095bc363c6b2.png" class="img-fluid figure-img" alt="Source: arXiv:1205.2671"></a></p>
<figcaption>Source: <a href="https://inspirehep.net/record/1114323">arXiv:1205.2671</a></figcaption>
</figure>
</div>
<p>Where <span class="math inline">\(\Delta m_{12}^2 = \Delta m_{Sol}^2\)</span> and <span class="math inline">\(\Delta m_{31(2)}^2 = \Delta m_{atm}^2\)</span>. Sometimes <span class="math inline">\(\Delta m_{atm}^2\)</span> is defined as: <span class="math display">\[\Delta m_{atm}^2  =\left| m_3^2 - \frac{(m_1^2 + m_2^2)}{2} \right|\]</span></p>
<p>### Measurements Status Assuming <span class="math inline">\(\Delta m_{21}^2 \ll \Delta m_{31}^2 \sim \Delta m_{32}^2\)</span> and small <span class="math inline">\(\theta_{13}\)</span> different detectors can prove different sectors of the oscillation parameters:</p>
<ul>
<li><strong>Atmospheric and Long Baseline Accelerators</strong>:</li>
</ul>
<p><span class="math display">\[\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; c_{23} &amp; s_{23} \\ 0 &amp; -s_{23} &amp; c_{23} \end{pmatrix}\]</span></p>
<p>If <span class="math inline">\(\Delta m_{21}^2L/E \ll 1\)</span> this experiments are sensitive to the oscillation <span class="math inline">\(P(\nu_\mu \rightarrow \nu_\tau) \simeq \sin^2 2\theta_{23}\sin^2\frac{\Delta m_{31}^2}{3E}L\)</span></p>
<ul>
<li><strong>Short Baseline Reactors</strong>: <span class="math display">\[\begin{pmatrix} c_{13} &amp; 0 &amp; s_{13}e^{-i\delta}\\ 0 &amp; 1 &amp; 0\\ -s_{13}e^{i\delta} &amp; 0 &amp; c_{13}\end{pmatrix}\]</span></li>
</ul>
<p>If <span class="math inline">\(\Delta m_{21}^2L/E \ll 1\)</span> this experiments are sensitive to the oscillation <span class="math display">\[ P(\nu_e \rightarrow \nu_e) \simeq 1 - \sin^2 2\theta_{13}\sin^2\frac{\Delta m_{31}^2}{3E}L\]</span></p>
<ul>
<li><strong>Solar and Long Baseline</strong>:</li>
</ul>
<p><span class="math display">\[\begin{pmatrix} c_{12} &amp; s_{12} &amp; 0 \\ -s_{12} &amp; c_{12} &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}\]</span></p>
<p>If <span class="math inline">\(\Delta m_{31}^2L/E \gg 1\)</span> this experimetns are sensitive to the oscillation <span class="math display">\[ P(\nu_e \rightarrow \nu_e) \simeq 1 - \sin^2 2\theta_{12}\sin^2\frac{\Delta m_{12}^2}{3E}L\]</span></p>
</section>
<section id="solar-neutrinos" class="level3" data-number="3.3.16">
<h3 data-number="3.3.16" class="anchored" data-anchor-id="solar-neutrinos"><span class="header-section-number">3.3.16</span> Solar Neutrinos</h3>
<p>Neutrinos from the Sun are produced by some of the fusion reactions in the <span class="math inline">\(pp\)</span> chain or the CNO cycle. The combined effect is:</p>
<p><span class="math display">\[4p \rightarrow ^4He + 2e^+ 2\nu_e\]</span></p>
<p>From the beginning of the solar-neutrino observation a deficit of the electron neutrino predicted by the Standard Solar Model was observed: <em>the solar-neutrino problem</em></p>
<p>In 1999 SNO in Canada started taking data. This experiment was able to detect <span class="math inline">\(\nu_e\)</span> by CC interactions and <span class="math inline">\(\nu_x\)</span> by NC interaction solving the mistery of the solar-neutrino problem. It is now understood as a neutrino flavor oscillation. The results of SNO together with KamLAND (a long baseline neutrino detector) confirmed the Large Mixing Angle solution (LMA) of the solar sector:</p>
<p><span class="math display">\[\sin^2 \theta_{12} \simeq 0.30\]</span> <span class="math display">\[\Delta m_{12}^2 \equiv \Delta m_{\odot}^2 \simeq 8 \times 10^{-5} \mathrm{ \; eV^2}\]</span></p>
</section>
<section id="atmospheric-neutrinos" class="level3" data-number="3.3.17">
<h3 data-number="3.3.17" class="anchored" data-anchor-id="atmospheric-neutrinos"><span class="header-section-number">3.3.17</span> Atmospheric Neutrinos</h3>
<p>First evidence of atmospheric neutrino oscillations came from Super-Kamiokande experiment in 1998. By scanning in zenith angle, is like changing the <span class="math inline">\(L\)</span>.</p>
<p><a href="http://www.quantumdiaries.org/wp-content/uploads/2014/06/IC86Multi_NuMuOsc_results_Pscan_V1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="http://www.quantumdiaries.org/wp-content/uploads/2014/06/IC86Multi_NuMuOsc_results_Pscan_V1.png" class="img-fluid"></a></p>
<p>If atmospheric mixing is non-maximal, it remains to determine in which “octant” the mixing angle <span class="math inline">\(\theta_{23}\)</span> lies. For a <span class="math inline">\(\theta_{23}\)</span> in the first octant (<span class="math inline">\(&lt; 45^{\circ}\)</span>) the mass eigenstate <span class="math inline">\(\nu_3\)</span> is <strong>tau heavy</strong>, i.e., the tau neutrino fraction is larger than the muon neutrino fraction. Conversely, for a <span class="math inline">\(\theta_{23}\)</span> in the second octant (<span class="math inline">\(&gt; 45^{\circ}\)</span>) the state <span class="math inline">\(\nu_3\)</span> is <strong>muon heavy</strong>.</p>
</section>
<section id="reactor-neutrinos" class="level3" data-number="3.3.18">
<h3 data-number="3.3.18" class="anchored" data-anchor-id="reactor-neutrinos"><span class="header-section-number">3.3.18</span> Reactor Neutrinos</h3>
<ul>
<li>Double Chooz: <span class="math inline">\(\sin^2 2\theta_{13} = 0.109 \pm 0.030 \pm 0.025 \neq 0\)</span> at <span class="math inline">\(2.9\sigma\)</span></li>
<li>Daya Bay: <span class="math inline">\(\sin^2 2\theta_{13} = 0.089 \pm 0.010 \pm 0.005 \neq 0\)</span> at <span class="math inline">\(7.7\sigma\)</span></li>
<li>RENO: <span class="math inline">\(\sin^2 2\theta_{13} = 0.113 \pm 0.013 \pm 0.019 \neq 0\)</span> at <span class="math inline">\(4.9\sigma\)</span></li>
</ul>
</section>
<section id="neutrino-oscillations-in-matter." class="level3" data-number="3.3.19">
<h3 data-number="3.3.19" class="anchored" data-anchor-id="neutrino-oscillations-in-matter."><span class="header-section-number">3.3.19</span> Neutrino oscillations in matter.</h3>
<p>The <span class="math inline">\(U_{PMNS}\)</span> matrix must be modified to account for the the fact that electron neutrinos have an extra interaction not present for <span class="math inline">\(\nu_\mu\)</span> and <span class="math inline">\(\nu_\tau\)</span> when travelling through matter. Elastic scattering of <span class="math inline">\(\nu_e\)</span> on electron can occur via exchange of a charged <span class="math inline">\(W\)</span>-boson as well as by exchange of the neutral <span class="math inline">\(Z\)</span>-boson adding a term <span class="math inline">\(V_e = G_F \sqrt{2}N_e\)</span> in the mass differences for electrons.</p>
<p>Without entering in the maths, what happens here is that a resonance effect occurs, ie, even if the mixing angle is small in vacuum it can get amplified in matter. This resonance can be expressed as a condition on the electron density <span class="math inline">\(N_e\)</span> which is appropriate for systems such as stellar interiors (Sun or supernovae too) where provided the core density is high enough, there is always a region in the neutrinos’ path exiting the star where it passes through resonance.</p>
<p>This is known as the <strong>MSW effect</strong> for the theorists who discovered it - Mikheyev, Smirnov, and Wolfenstein.</p>
</section>
<section id="tutorial-iii-calculate-the-probabilities-of-nu_e-rightarrow-nu_x-as-function-of-le" class="level3" data-number="3.3.20">
<h3 data-number="3.3.20" class="anchored" data-anchor-id="tutorial-iii-calculate-the-probabilities-of-nu_e-rightarrow-nu_x-as-function-of-le"><span class="header-section-number">3.3.20</span> Tutorial III: Calculate the probabilities of <span class="math inline">\(\nu_e \rightarrow \nu_x\)</span> as function of L/E</h3>
<div id="956d556c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> PMNS_Factory(t12, t13, t23, d):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    s12 <span class="op">=</span> np.sin(t12)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    c12 <span class="op">=</span> np.cos(t12)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    s23 <span class="op">=</span> np.sin(t23)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    c23 <span class="op">=</span> np.cos(t23)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    s13 <span class="op">=</span> np.sin(t13)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    c13 <span class="op">=</span> np.cos(t13)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    cp  <span class="op">=</span> np.exp(<span class="ot">1j</span><span class="op">*</span>d)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([[ c12<span class="op">*</span>c13, s12<span class="op">*</span>c13, s13<span class="op">*</span>np.conj(cp) ],</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                  [<span class="op">-</span>s12<span class="op">*</span>c23 <span class="op">-</span> c12<span class="op">*</span>s23<span class="op">*</span>s13<span class="op">*</span>cp, c12<span class="op">*</span>c23 <span class="op">-</span> s12<span class="op">*</span>s23<span class="op">*</span>s13<span class="op">*</span>cp, s23<span class="op">*</span>c13],</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                  [ s12<span class="op">*</span>s23 <span class="op">-</span> c12<span class="op">*</span>s23<span class="op">*</span>s13<span class="op">*</span>cp,<span class="op">-</span>c12<span class="op">*</span>s23 <span class="op">-</span> s12<span class="op">*</span>c23<span class="op">*</span>s13<span class="op">*</span>cp, c23<span class="op">*</span>c13]])</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> posc(a, b, U, dm2, LEratio):</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Gives the oscillation probability for nu(a) -&gt; nu(b)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">    for PMNS matrix U, and L in km and E in GeV, and dm2 in eV^2</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>):</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            arg <span class="op">=</span> <span class="fl">5.068</span><span class="op">*</span>dm2[i<span class="op">+</span>j<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>LEratio</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>            mxe <span class="op">=</span> np.conj(U[a,i])<span class="op">*</span>U[b,i]<span class="op">*</span>U[a,j]<span class="op">*</span>np.conj(U[b,j])</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>            s <span class="op">+=</span> <span class="op">-</span><span class="dv">4</span><span class="op">*</span>mxe.real<span class="op">*</span>np.sin(<span class="fl">0.25</span><span class="op">*</span>arg)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>mxe.imag<span class="op">*</span>np.sin(<span class="fl">0.50</span><span class="op">*</span>arg)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> a <span class="op">==</span> b: s <span class="op">+=</span> <span class="fl">1.0</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>t12 <span class="op">=</span> np.arcsin(<span class="fl">0.312</span><span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>t13 <span class="op">=</span> np.arcsin(<span class="fl">0.0251</span><span class="op">**</span><span class="fl">0.5</span>) <span class="co">#Controlls the size of the small wiggles.</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#t13 = np.arcsin(0.0)</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>t23 <span class="op">=</span> np.arcsin(<span class="fl">0.42</span><span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>dm2 <span class="op">=</span> [ <span class="fl">7.58E-05</span>, <span class="fl">2.27E-03</span>, <span class="fl">2.35E-03</span>]</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> PMNS_Factory(t12, t13, t23, delta)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>LE <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">36000</span>, <span class="dv">3600</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>Pe <span class="op">=</span> posc(<span class="dv">0</span>, <span class="dv">0</span>, U, dm2, LE)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>Pm <span class="op">=</span> posc(<span class="dv">0</span>, <span class="dv">1</span>, U, dm2, LE)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>Pt <span class="op">=</span> posc(<span class="dv">0</span>, <span class="dv">2</span>, U, dm2, LE)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>ax.plot(LE, Pe, <span class="st">'-'</span>, label<span class="op">=</span><span class="vs">r'$\nu_e \rightarrow \nu_e$'</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>ax.plot(LE, Pm, <span class="st">'k'</span>, label<span class="op">=</span><span class="vs">r'$\nu_e\rightarrow\nu_\mu$'</span>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>ax.plot(LE, Pt, <span class="st">'r'</span>, label<span class="op">=</span><span class="vs">r'$\nu_e\rightarrow\nu_\tau$'</span>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"L/E (km/GeV)"</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"Probability $\nu_e \rightarrow \nu_x$"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="chap3_files/figure-html/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="chap3_files/figure-html/cell-8-output-1.png" width="985" height="385" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="what-else" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="what-else"><span class="header-section-number">3.4</span> What else?</h2>
<ul>
<li><p>Pressure and temperature effects in the muon and neutrino fluxes.</p></li>
<li><p>Sterile neutrinos, are there more than 3 neutrinos? What does cosmology tell us, what do experiements tell us? (LSND and reactor anomalies)</p></li>
</ul>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-7">Source: Particle Data Group</span>
<span class="glightbox-desc lightbox-desc-10">Source: Particle Data Group</span>
<span class="glightbox-desc lightbox-desc-12">Source: Allkofer et. al.&nbsp;Phys. Lett. B36, 425 (1971). Jokisch et. al.&nbsp;Phys. Rev.&nbsp;D19, 1368 (1979)</span>
<span class="glightbox-desc lightbox-desc-14">Source: <a href="http://arxiv.org/abs/1210.5154">arXiv:1210.5154</a></span>
<span class="glightbox-desc lightbox-desc-24">Calculated neutrino cross sections taken from <a href="http://arxiv.org/abs/1309.1764">arXiv:1309.1764</a></span>
<span class="glightbox-desc lightbox-desc-28">Source: <a href="https://inspirehep.net/record/1114323">arXiv:1205.2671</a></span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Yanez:2023lsy" class="csl-entry" role="listitem">
Yañez, Juan Pablo, and Anatoli Fedynitch. 2023. <span>“<span class="nocase">daemonflux: DAta-drivEn MuOn-calibrated Neutrino Flux</span>,”</span> February. <a href="https://arxiv.org/abs/2303.00022">https://arxiv.org/abs/2303.00022</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap2.html" class="pagination-link  aria-label=" &lt;span="" rays&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Cosmic Rays</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap4.html" class="pagination-link" aria-label="<span class='chapter-number'>4</span>&nbsp; <span class='chapter-title'>Multimessenger Astronomy</span>">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multimessenger Astronomy</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","closeEffect":"zoom","selector":".lightbox","descPosition":"bottom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>