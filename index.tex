% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{svg}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={AstroParticles},
  pdfauthor={J. A. Aguilar},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{AstroParticles}
\author{J. A. Aguilar}
\date{2024-01-31}

\begin{document}
\maketitle

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\chapter*{Preface}\label{preface}
\addcontentsline{toc}{chapter}{Preface}

\markboth{Preface}{Preface}

This is a book on astroparticle physics created from markdown and
executable code in \texttt{python}.

\section*{Why Python?}\label{why-python}
\addcontentsline{toc}{section}{Why Python?}

\markright{Why Python?}

Although certainly is not a requirement to understand the physics
processes involved in astroparticle phenomena, it is beneficial to
resolve numerically some of the proposed problems in order to better
assimilate the concepts discussed during this course. The python
programming language is used as a tool for constructing these numerical
solutions. The advantage is that there exist complete mathematical
libraries (\texttt{numpy/scipy}) for python, astronomical and analysis
toolboxes (\texttt{astropy/healpy}), as well as powerful graphical
visualization frameworks (matplotlib), which make it possible to easily
construct problem solvers in a matter of minutes along with its
graphical output. The idea is also to familiarize with what has become
one of the most popular analysis tools in the high-energy physics as
well as in the astronomy communities. A long this week we will use the
following python modules related with astroparticle physics:

\begin{itemize}
\tightlist
\item
  \texttt{astropy}
\item
  \texttt{healpy}
\item
  \texttt{gammapy}
\item
  \texttt{crdb}
\end{itemize}

\textbf{References will be added}

\subsection*{Disclaimer and
Acknowledgments}\label{disclaimer-and-acknowledgments}
\addcontentsline{toc}{subsection}{Disclaimer and Acknowledgments}

These notes are far from original work. I limited myself to read the
literature on the subject, assimilate and also re-elaborate concepts
into what I hope is a coherent story, useful to give a feeling of how
wonderful our universe and Nature are. There is an endless list of
people that inspired these notes and many references. Particularly, we
acknowledge: T.K. Gaisser, F. Halzen, K. Hanson, Alexander Kappes,
Carlos de los Heros, Stefano Gabici, T. Montaruli, and a long etc.

\bookmarksetup{startatroot}

\chapter{Basic Concents and
Notations}\label{basic-concents-and-notations}

\section{The Computational Framework}\label{the-computational-framework}

In this part we are going to review the concepts that we will use in the
rest of the course. It will also serve to set up the conventions, units,
etc.

\subsection{Natural Units}\label{natural-units}

In high energy physics and astro-particle physics it is very common to
use the natural units where \(\hbar = c = 1\). The correspondence
between natural units and physical units can be established by use of

\[\hbar = 6.58 \times 10^{-16} {\;\mathrm{GeV}\cdot \mathrm{ ns}} = 1\;\Rightarrow 1\;\mathrm{GeV} = 1.52 \times 10^{15}\;{\mathrm{ns}^{-1}}\]

\[c = 30.0\;\mathrm{cm/ns} = 1 \Rightarrow 30\;\mathrm{cm} = 1\;\mathrm{ns}\]

In these units there is then only one fundamental dimension:

\begin{itemize}
\tightlist
\item
  Energy and momentum, usually expressed in GeV
\item
  Time and space are GeV\(^{-1}\)
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial I: Working with Units}\vspace{3mm}

Along these notes you are going to find different tutorials in
\texttt{python} dealing with will help to develop your programing skills
in and solve some numerical problems. In this case we are going to see
an easy way to work with different units which is uing the module
\texttt{units} that exist for example in
\href{http://astropy.readthedocs.org/en/latest/units/}{\texttt{astropy}}:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ astropy.units }\ImportTok{as}\NormalTok{ u}
\ImportTok{from}\NormalTok{ astropy }\ImportTok{import}\NormalTok{ constants }\ImportTok{as}\NormalTok{ const}
\ImportTok{from}\NormalTok{ IPython.display }\ImportTok{import}\NormalTok{ display, Markdown}

\NormalTok{M\_Earth }\OperatorTok{=} \FloatTok{5.97E24} \OperatorTok{*}\NormalTok{ u.kg}
\NormalTok{M\_Sun }\OperatorTok{=} \FloatTok{1.99E30} \OperatorTok{*}\NormalTok{ u.kg}
\NormalTok{M\_MW  }\OperatorTok{=} \FloatTok{1E12} \OperatorTok{*}\NormalTok{ M\_Sun}
\CommentTok{\#By adding the quantity u.kg you can print directly the mass in Kg}
\NormalTok{display(Markdown (}\SpecialStringTok{f"Mass Earth is: }\SpecialCharTok{\{}\NormalTok{M\_Earth}\SpecialCharTok{\}}\SpecialStringTok{"} \OperatorTok{\%}\NormalTok{M\_Earth))}
\end{Highlighting}
\end{Shaded}

Mass Earth is: 5.97e+24 kg

Note that the variables defined above already have their units
\texttt{attached} to them, so when you make a \texttt{print} or similar
statement it will provide as well the units as a string.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{R\_Earth }\OperatorTok{=} \FloatTok{6.371E6} \OperatorTok{*}\NormalTok{ u.m }\CommentTok{\# meters}
\NormalTok{R\_Sun }\OperatorTok{=} \FloatTok{6.955E8} \OperatorTok{*}\NormalTok{ u.m }\CommentTok{\# meters}
\NormalTok{AU }\OperatorTok{=} \FloatTok{1.496E11} \OperatorTok{*}\NormalTok{ u.m }\CommentTok{\# meters}
\end{Highlighting}
\end{Shaded}

We the radius we can calculate the mean density of Earth and Sun. We
will show that units are preserved along calculations:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{vol\_sphere }\OperatorTok{=} \KeywordTok{lambda}\NormalTok{ r: }\DecValTok{4}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{/}\DecValTok{3}\OperatorTok{*}\NormalTok{r}\OperatorTok{**}\DecValTok{3}
\NormalTok{rho\_Sun }\OperatorTok{=}\NormalTok{ M\_Sun }\OperatorTok{/}\NormalTok{ vol\_sphere(R\_Sun)}
\NormalTok{rho\_Earth }\OperatorTok{=}\NormalTok{ M\_Earth }\OperatorTok{/}\NormalTok{ vol\_sphere(R\_Earth)}

\CommentTok{\#A unit can be changed calling the .to(u.unit) method}
\NormalTok{display(Markdown (}\VerbatimStringTok{rf"$\textbackslash{}rho\_}\CharTok{\{\{}\VerbatimStringTok{\textbackslash{}oplus}\CharTok{\}\}}\VerbatimStringTok{$ = }\SpecialCharTok{\{}\NormalTok{rho\_Earth}\SpecialCharTok{.}\NormalTok{to(u.g}\OperatorTok{/}\NormalTok{u.cm}\OperatorTok{**}\DecValTok{3}\NormalTok{)}\SpecialCharTok{:.2f\}}\VerbatimStringTok{"}\NormalTok{))}
\NormalTok{display(Markdown (}\VerbatimStringTok{rf"$\textbackslash{}rho\_}\CharTok{\{\{}\VerbatimStringTok{\textbackslash{}odot}\CharTok{\}\}}\VerbatimStringTok{$ = }\SpecialCharTok{\{}\NormalTok{rho\_Sun}\SpecialCharTok{:.2f\}}\VerbatimStringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\(\rho_{\oplus}\) = 5.51 g / cm3

\(\rho_{\odot}\) = 1412.12 kg / m3

We can use this module to make different transformations of uings, for
example from light years to meters:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ly }\OperatorTok{=} \DecValTok{1} \OperatorTok{*}\NormalTok{ u.lyr}

\NormalTok{display(Markdown (}\SpecialStringTok{f"Number of seconds for light to travel from Sun to Earth: }\SpecialCharTok{\{}\FloatTok{1.}\OperatorTok{/}\NormalTok{const}\SpecialCharTok{.}\NormalTok{c}\SpecialCharTok{.}\NormalTok{to(u.AU}\OperatorTok{/}\NormalTok{u.s)}\SpecialCharTok{:.2e\}}\SpecialStringTok{"}\NormalTok{))}
\NormalTok{display(Markdown (}\SpecialStringTok{f"Meters in a light year: }\SpecialCharTok{\{}\NormalTok{ly}\SpecialCharTok{.}\NormalTok{to(u.m)}\SpecialCharTok{:.2e\}}\SpecialStringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Number of seconds for light to travel from Sun to Earth: 4.99e+02 s / AU

Meters in a light year: 9.46e+15 m

Assuming that the Galaxy is roughly a disk 50 kpc in diameter and 500 pc
thick we can now calculate its density:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{V\_Gal }\OperatorTok{=}\NormalTok{  np.pi }\OperatorTok{*}\NormalTok{ (}\DecValTok{25000}\OperatorTok{*}\NormalTok{u.pc)}\OperatorTok{**}\DecValTok{2} \OperatorTok{*} \DecValTok{500}\OperatorTok{*}\NormalTok{u.pc}

\NormalTok{display(Markdown (}\SpecialStringTok{f"Volume of the Milky Way is approximately: }\SpecialCharTok{\{}\NormalTok{V\_Gal}\SpecialCharTok{.}\NormalTok{to(u.m}\OperatorTok{**}\DecValTok{3}\NormalTok{)}\SpecialCharTok{:.2e\}}\SpecialStringTok{"}\NormalTok{))}
\NormalTok{M\_Gal }\OperatorTok{=} \FloatTok{1E12} \OperatorTok{*}\NormalTok{ M\_Sun}
\NormalTok{rho\_Gal }\OperatorTok{=}\NormalTok{ M\_Gal }\OperatorTok{/}\NormalTok{ V\_Gal}
\NormalTok{display(Markdown (}\SpecialStringTok{f"Average density of Milky Way is }\SpecialCharTok{\{}\NormalTok{rho\_Gal}\SpecialCharTok{.}\NormalTok{to(u.g}\OperatorTok{/}\NormalTok{u.cm}\OperatorTok{**}\DecValTok{3}\NormalTok{)}\SpecialCharTok{:.2e\}}\SpecialStringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Volume of the Milky Way is approximately: 2.88e+61 m3

Average density of Milky Way is 6.90e-23 g / cm3

\end{tcolorbox}

\subsection{Larmor Radius and
Rigidity}\label{larmor-radius-and-rigidity}

Larmor radius, or gyroradius, \(r_L\), is the radius of the orbit of a
charged particle moving in a uniform, perpendicular magnetic field,
obtained by simply equating the Lorentz force with the centripetal
force/

It is defined as:
\[q v B = \frac{mv^2}{r_L} \rightarrow r_L = \frac{p}{ZeB}\]

where \(p\) has replaced \(mv\) in the classical limit. However, this
also holds for the relativistic generalization by considering \(p\) to
be the relativistic 3-momentum. There are several adaptations of this
formula, tuned to units natural to various scenarios. One such is

\[r_L \simeq  1 \;\mathrm{ kpc} \left(\frac{p}{10^{18}\;\mathrm{ eV}\cdot{c}}\right)\left(\frac{1}{Z}\right)\left(\frac{\mu\mathrm{ G}}{B}\right)\]

In cosmic ray physics, one often sees references in the literature to
the \textbf{rigidity} of a particle, defined as:

\[
R \equiv r_L B c = \frac{pc}{Ze}
\]

note that the rigidity, \(R\) has units of Volts.

\subsection{Superposition model}\label{superposition-model}

Another concept that we will use frecuently in cosmic-ray physics is the
\emph{superpositoin model}. In the superposition model, a nucleus with
mass \(A\) and energy \(E(A)\) is considered as \(A\) independent
nucleons with energy \(E_0\). In a spallation process the energy per
nucleon is approximately cosnserved therefore:

\[A + p \rightarrow A_1 + A_2\]

\[\begin{alignedat}{2}
&E(A) &= &A E_0,\\
&E(A_1) &= &A_1 E_0,\\
&E(A_2) &= &A_2 E_0
\end{alignedat}\]

\subsection{Cross sections, number density, lifetime, and interaction
lengths}\label{cross-sections-number-density-lifetime-and-interaction-lengths}

The \textbf{cross-section} of a reaction is a very important parameter.
It can be considered as the effective area for a collision between a
target and a projectile. The cross-section of an interaction depends on
interaction force, the energy of the particle, etc\ldots{}

Cross-section is typically measured in surface, \(\mathrm{cm}^2\) or
``barns'':

\[ 1 \mathrm{ barn} = 10^{-24} \mathrm{cm}^2\]

The unit barn comes from the expression ``big as a barn'' as in the past
physisits saw with surprise that interactions were more frequent than
expected, and they thought the nucleus was in fact bigger than they
thought\ldots{} big as a barn.

If a flux of \emph{projectile} particles are crossing a volume of
\emph{target} particles with cross section \(\sigma_N\) then the
disapperance of flux will be proportional to the initial number, the
length travelled and number of target particles:

\[ \mathrm{d} I = -I n \sigma_N \mathrm{d} x \]

where \(n\) is the \textbf{number density}, ie, the number of particles
per volume unit:

\[ n = \frac{N}{V} \]

note that the number density is related with the mass density as:

\[n = \frac{N_A}{M} \rho_m = \frac{\rho_m}{m_N}\]

where \(N_A\) is the avogadro number, \(M\) is the total mass of a mol
and \(m_N\) is the mass of is the mass of a single particles N making up
the volume. Solving the equation above we have:

\[I = I_0 e^{-\frac{x}{n\sigma_N}}\]

where we can define:

\[\lambda = \frac{1}{n\sigma_N}\]

as the \textbf{interaction length}. Likewise if projectile particles are
travelling at speed \(v\), the length travelled can be expressed as
\(\mathrm{d}x = v \mathrm{d} t\) giving a similar expression with a time
constant:

\[\tau = \frac{1}{n v\sigma_N}\]

Known as the \textbf{lifetime}. If several processes are taking place,
we need to replace \(n\sigma_N\) as \(\sum n_i\sigma_i\), which gives:

\[\frac{1}{\tau_{total}} = \frac{1}{\tau_1} + \frac{1}{\tau_2} + ... + \frac{1}{\tau_n}\]

\section{Coordinates and Time}\label{coordinates-and-time}

In this section we are going to review a bit the geography around our
Galaxy as well as the different systems in which we can reference to
objects in the sky (coordinate systems) or events (time standards).

\subsection{Milky Way}\label{milky-way}

The Sun is \textbf{7.6-8.7 kpc} from the Galactic Center where there
appears to be a supermassive black hole of \textbf{1 million solar
masses} (\(M_{\odot} = 1.99\times 10^{30}\) Kg) which coincides with a
radio source known as \textbf{Sagittarius A*}.

\begin{figure}[H]

{\centering \includesvg[width=0.7\textwidth,height=\textheight]{index_files/mediabag/Galactic_centre_orbi.svg}

}

\caption{Source: Wikipedia}

\end{figure}%

The trayectories of stars around Str A* can be used to estimate the mass
of the black hole. It is the up to now, best prove of the existance of a
black hole. Although it is a galaxy with a black hole in their center,
the Milky Way is not considered to have an Active Galactic Nuclei due to
the low mass of the black hole. If we assume the Milky Way to have a
cylindrical shape it will have a radius of \textbf{30 kpc} and thickness
of \textbf{300 pc}. Its mass is estimated to be
\(5.8 \times 10^{11} M_{\odot}\).

\subsection{Local Group}\label{local-group}

The Milky Way is surrounded by 54 known satellite galaxies (most of them
dwarf galaxies) in a group known as the \textbf{Local Group} (A dwarf
galaxy has \(\sim\) billion stars compared to our Milky Ways 200-400
billion stars). The most notably are the Large Magellanic Cloud (50 kpc)
and the Small Magellanic Cloud (60 kpc). The LMC mass is
\(10^{10} M_{\odot}\). Next nearest full-fledged galaxy is Andromeda or
M31 (\(1.5\times 10^{12} M_{\odot}\)) at a distance of approximately
\textbf{780 kpc}. The group contains also other galaxies MW, M31, M33
(Triangulum Galaxy) and it has volume of diameter of about \textbf{3
Mpc}.

\begin{figure}[H]

{\centering \includegraphics[width=0.7\textwidth,height=\textheight]{index_files/mediabag/5_Local_Galactic_Gro.png}

}

\caption{Source: Wikipedia}

\end{figure}%

\subsection{Virgo Supercluster}\label{virgo-supercluster}

The Local Group is itself contained within the \emph{Virgo Supercluster}
or \emph{Local Supercluster} (LC) of galaxies extending out to about 33
Mpc. It has a total mass of \(10^{15}M_{\odot}\)

\subsection{Time scales and time
standards}\label{time-scales-and-time-standards}

There are several time standards or ways to specify time. A time
standard can affect the rate (ie, how long is a day) or reference or
point in time, or both. Some standards are:

\begin{itemize}
\item
  \href{http://en.wikipedia.org/wiki/Solar_time\#Mean_solar_time}{Mean
  solar time} There are two solar times, the aparent one (also called
  true one) which depends on latitude and the year and the Mean solar
  time which the time of \emph{mean} sun, the difference between the two
  is called the
  \href{http://en.wikipedia.org/wiki/Solar_time\#mediaviewer/File:Equation_of_time.svg}{equation
  of time}. The length of the mean solar day is slowly increasing due to
  the tidal acceleration of the Moon by the Earth and the corresponding
  slowing of Earth's rotation by the Moon.
\item
  \href{http://en.wikipedia.org/wiki/Universal_Time}{Universal Time
  (UT0, UT1)} Is a time scale based on the mean solar day, defined to be
  as uniform as possible despite variations in Earth's rotation
\item
  \href{http://en.wikipedia.org/wiki/International_Atomic_Time}{International
  Atomic Time} Is the primary international time standard from which
  other time standards, including UTC, are calculated. TAI is kept by
  the BIPM (International Bureau of Weights and Measures), and is based
  on the combined input of many atomic clocks around the world.
\item
  \href{http://en.wikipedia.org/wiki/Coordinated_Universal_Time}{Coordinated
  Universal Time (UTC)} is an atomic time scale designed to approximate
  Universal Time. UTC differs from TAI by an integral number of seconds.
  UTC is kept within 0.9 second of UT1 by the introduction of one-second
  steps to UTC. The difference with UT1 is known as DUT1.
\end{itemize}

\subsection{Time representations: JD and
MJD}\label{time-representations-jd-and-mjd}

These are not technically standards (or scales), they are just
reprentations (formats) of the aforementioned standards typically used
in Astronomy:

\begin{itemize}
\item
  \href{http://en.wikipedia.org/wiki/Julian_day}{Julian Date} Is the
  count of days elapsed since Greenwich mean noon on 1 January 4713
  B.C., Julian proleptic calendar. Note that this day count conforms
  with the astronomical convention starting the day at noon, in contrast
  with the civil practice where the day starts with midnight (in popular
  use the belief is widespread that the day ends with midnight, but this
  is not the proper scientific use).
\item
  \href{http://en.wikipedia.org/wiki/Julian_day}{Modified Julian Date}
  Is defined as MJD = JD - 2400000.5. The half day is subtracted so that
  the day starts at midnight in conformance with civil time reckoning.
  There is a good reason for this modification and it has to do with how
  much precision one can represent in a double (IEEE 754) variable.
  Julian dates can be expressed in UT, TAI, TDT, etc. and so for precise
  applications the timescale should be specified, e.g.~MJD 49135.3824
  TAI.
\end{itemize}

\subsection{Time in experiments}\label{time-in-experiments}

Practically speaking, in experiments time comes from one or more of the
following sources:

\begin{itemize}
\item
  \textbf{Atomic clocks (Cs, Rb)} -They use the microwave signal that
  electrons in atoms emit when they change energy levels. These have
  very good short term performance but a Rb clock left by itself will
  wander by several ns per day. Cs clocks are perhaps better by a factor
  of 100x.
\item
  \textbf{GPS} - The GPS gives precision timing too. The system consists
  of the space segment of O(30) satellites each equipped with Caesium
  atomic clocks and each constantly getting corrections from the central
  control facility. GPS broadcasts navigation and time messages
  synchronized to this ultraprecise time from which the user segment can
  extract time and space coordinates accurate to O(10) ns and meters,
  respectively. GPS time is based on the 86400 second day. It indirectly
  accounts for leap years. There are \emph{no} leap seconds in GPS time.
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial II: Using Time Standards in \texttt{Astropy}}\vspace{3mm}

Time conversions and coordinate conversions are best left to well-tested
libraries. SLALIB is a famous set of Fortran libraries that do several
transformation. For python I will use \texttt{Astropy}. The
\href{http://www.astropy.org/}{Astropy Project} is a community effort to
develop a single core package for Astronomy in Python and foster
interoperability between Python astronomy packages. Is included by
default in the Anaconda distribution.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ astropy.time }\ImportTok{import}\NormalTok{ Time}
\ImportTok{import}\NormalTok{ datetime}
\NormalTok{i }\OperatorTok{=}\NormalTok{ datetime.datetime.now()}
\BuiltInTok{print}\NormalTok{ (}\SpecialStringTok{f"Today\textquotesingle{}s date and time: }\SpecialCharTok{\{}\NormalTok{i}\SpecialCharTok{.}\NormalTok{isoformat()}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\NormalTok{times }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}1999{-}01{-}01T00:00:00.123456789\textquotesingle{}}\NormalTok{, i.isoformat()]}
\NormalTok{t }\OperatorTok{=}\NormalTok{ Time(times, }\BuiltInTok{format}\OperatorTok{=}\StringTok{\textquotesingle{}isot\textquotesingle{}}\NormalTok{, scale}\OperatorTok{=}\StringTok{\textquotesingle{}utc\textquotesingle{}}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Today\textquotesingle{}s julian date (UTC) is }\SpecialCharTok{\{}\NormalTok{t[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{.}\NormalTok{jd}\SpecialCharTok{:.2f\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Today\textquotesingle{}s modified julian date (UTC) is }\SpecialCharTok{\{}\NormalTok{t[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{.}\NormalTok{mjd}\SpecialCharTok{:.2f\}}\SpecialStringTok{"}\NormalTok{)}

\NormalTok{dt }\OperatorTok{=}\NormalTok{ t[}\DecValTok{1}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ t[}\DecValTok{0}\NormalTok{]}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"The time difference in mjd is }\SpecialCharTok{\{}\NormalTok{dt}\SpecialCharTok{.}\NormalTok{value}\SpecialCharTok{:.2f\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"The time difference in seconds is }\SpecialCharTok{\{}\NormalTok{dt}\SpecialCharTok{.}\NormalTok{sec}\SpecialCharTok{:.2f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Today's date and time: 2024-10-01T09:08:28.228623
Today's julian date (UTC) is 2460584.88
Today's modified julian date (UTC) is 60584.38
The time difference in mjd is 9405.38
The time difference in seconds is 812624913.11
\end{verbatim}

\end{tcolorbox}

\subsection{Coordinate System}\label{coordinate-system}

Coordinate systems are used to map objects position in the sky. They can
divided into local coordiantes and celestial coordinate systems:

\subsubsection{Local coordinates}\label{local-coordinates}

These are those that depend on from where on Earth you observe, ie they
have the observer's local position as reference. For example the
horizontal coordinate system is expressed in terms of \textbf{altitude}
(or elevation or zenith) angle and \textbf{azimuth}. These coordinates
are not useful to inequivocally identify the position of an object in
the sky since celestials object local coordinates change with time.

\subsubsection{Celestial coordinate
systems}\label{celestial-coordinate-systems}

Those systems are independent of the observer's local position. Two of
the mostly used coordinates systems in astroparticle are:

\begin{itemize}
\tightlist
\item
  \textbf{Equatorial coordinates}: It's defined by an origin at the
  center of the Earth, a fundamental plane consisting of the projection
  of the Earth's equator onto the celestial sphere. Coordinates are give
  by \textbf{right ascension} and \textbf{declination}.
\end{itemize}

\begin{figure}[H]

{\centering \includegraphics{index_files/mediabag/images/eq_coordinates.pdf}

}

\caption{Equatorial coordinate system}

\end{figure}%

\begin{itemize}
\tightlist
\item
  \textbf{Galactic coordinates}: The \textbf{galactic longitude},
  \(\ell\) is the angular distance Eastward (counterclockwise looking
  down on the Galaxy from the GNP) from the Galactic Center and the
  \textbf{galactic latitude}, \(b\), is the angular distance outside of
  the plane of the Galaxy, positive up, negative down. Note that having
  a large galactic latitude is neither a necessary nor a sufficient
  condition for an object being extragalactic. This is how to get the
  image of the Galactic plane on the celestial sphere.
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial III: Coordinate Transformations}\vspace{3mm}

Let's do some ``representation'' of the galactic plane. We generate some
random points using numpy following a 2-dimensional gaussian in the
\(\ell\): \(-\pi, +\pi\) and \(b\):\(-\pi/2, +\pi/2\) space. Now we are
going to use \texttt{matplotlib} to make plots, for that we are going to
call the magic command \texttt{\%matplotlib\ inline} to make the plots
appear inside the notebook:

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{\%}\NormalTok{matplotlib inline}
\ImportTok{import}\NormalTok{ matplotlib.pylab }\ImportTok{as}\NormalTok{ plt}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}font.family\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{"STIXGeneral"}

\CommentTok{\#We call random.multivariate\_normal to generate randon normal points at 0}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\CommentTok{\#Lets use the inline figure format as svg}
\OperatorTok{\%}\NormalTok{config InlineBackend.figure\_format }\OperatorTok{=} \StringTok{\textquotesingle{}svg\textquotesingle{}}

\NormalTok{disk }\OperatorTok{=}\NormalTok{ np.random.multivariate\_normal(mean}\OperatorTok{=}\NormalTok{[}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{], cov}\OperatorTok{=}\NormalTok{np.diag([}\DecValTok{1}\NormalTok{,}\FloatTok{0.001}\NormalTok{]), size}\OperatorTok{=}\DecValTok{5000}\NormalTok{)}
\CommentTok{\#disk is a list of pairs [l, b] in radians}
\BuiltInTok{print}\NormalTok{(disk[}\DecValTok{0}\NormalTok{:}\DecValTok{10}\NormalTok{])}
\NormalTok{f }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{7}\NormalTok{,}\DecValTok{5}\NormalTok{))}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{, projection}\OperatorTok{=}\StringTok{\textquotesingle{}aitoff\textquotesingle{}}\NormalTok{)}
\CommentTok{\#There are several projections: Aitoff, Hammer, Lambert, MollWeide}
\NormalTok{ax.set\_title(}\StringTok{"Galactic}\CharTok{\textbackslash{}n}\StringTok{ Coordinates"}\NormalTok{)}
\NormalTok{ax.grid(}\VariableTok{True}\NormalTok{)}
\NormalTok{ll }\OperatorTok{=}\NormalTok{ disk[:,}\DecValTok{0}\NormalTok{]}
\NormalTok{bb }\OperatorTok{=}\NormalTok{ disk[:,}\DecValTok{1}\NormalTok{]}
\CommentTok{\#ax.set\_axis\_bgcolor("black")}
\CommentTok{\#ax.tick\_params(axis=\textquotesingle{}x\textquotesingle{}, colors=\textquotesingle{}white\textquotesingle{})}
\NormalTok{ax.plot(ll, bb, }\StringTok{\textquotesingle{}o\textquotesingle{}}\NormalTok{, markersize}\OperatorTok{=}\DecValTok{2}\NormalTok{, alpha}\OperatorTok{=}\FloatTok{0.3}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[-2.2527975  -0.03154108]
 [ 0.6933868  -0.0099334 ]
 [ 0.21160924 -0.03277955]
 [ 0.30372429  0.02432369]
 [ 0.94376598  0.02052159]
 [ 0.09814675  0.00635769]
 [-1.260434    0.02960544]
 [-0.68698196  0.02242948]
 [-1.193989   -0.00565016]
 [-0.43707746 -0.0181796 ]]
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{index_files/mediabag/chap1_files/figure-pdf/gal-eq-output-2.pdf}

}

\caption{Galaxy in Galactic Coordiantes}

\end{figure}%

Now let's plot it in equatorial coordinates (right ascension,
declination).

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ astropy }\ImportTok{import}\NormalTok{ units }\ImportTok{as}\NormalTok{ u}
\ImportTok{from}\NormalTok{ astropy.coordinates }\ImportTok{import}\NormalTok{ SkyCoord}

\NormalTok{c\_gal }\OperatorTok{=}\NormalTok{ SkyCoord(l}\OperatorTok{=}\NormalTok{ll}\OperatorTok{*}\NormalTok{u.radian, b}\OperatorTok{=}\NormalTok{bb}\OperatorTok{*}\NormalTok{u.radian, frame}\OperatorTok{=}\StringTok{\textquotesingle{}galactic\textquotesingle{}}\NormalTok{)}
\NormalTok{c\_gal\_icrs }\OperatorTok{=}\NormalTok{ c\_gal.icrs}
\end{Highlighting}
\end{Shaded}

Because \texttt{matplotlib} needs the coordinates in radians and between
\(-\pi\) and \(\pi\), not 0 and \(2\pi\), we have to convert them.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ra\_rad }\OperatorTok{=}\NormalTok{ c\_gal\_icrs.ra.wrap\_at(}\DecValTok{180} \OperatorTok{*}\NormalTok{ u.deg).radian}
\NormalTok{dec\_rad }\OperatorTok{=}\NormalTok{ c\_gal\_icrs.dec.radian}

\NormalTok{plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{7}\NormalTok{,}\DecValTok{5}\NormalTok{))}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{, projection}\OperatorTok{=}\StringTok{"mollweide"}\NormalTok{)}
\NormalTok{ax.set\_title(}\StringTok{"Equatorial coordinates"}\NormalTok{)}
\NormalTok{plt.grid(}\VariableTok{True}\NormalTok{)}
\NormalTok{ax.plot(ra\_rad, dec\_rad, }\StringTok{\textquotesingle{}o\textquotesingle{}}\NormalTok{, markersize}\OperatorTok{=}\DecValTok{2}\NormalTok{, alpha}\OperatorTok{=}\FloatTok{0.3}\NormalTok{)}
\NormalTok{plt.show()}
\CommentTok{\#NOTE: Normally right ascension is plotted from right (0 deg.) to left (360 deg.)}
\end{Highlighting}
\end{Shaded}

\includegraphics{index_files/mediabag/chap1_files/figure-pdf/cell-10-output-1.pdf}

\end{tcolorbox}

\section{Special Relativity}\label{special-relativity}

\subsection{Introduction}\label{introduction}

Why is it important?

\[\gamma = \sqrt{\frac{1}{1-\beta^2}}\;, \beta = \frac{v}{c}\]

\begin{itemize}
\tightlist
\item
  Jets emitted by supermassive black holes have:
  \(\gamma \approx 30 \rightarrow \beta = 0.9984\)
\item
  Electrons spiraling in B-field lines of pulsars have:
  \(\gamma \sim 10^7\)
\item
  Lorentz factors of protons of \(10^{20}\) eV:
  \(\gamma = \frac{E}{m^0_p c^2} = \frac{10^{20}}{1\times 10^9} = 10^{11}\)
\end{itemize}

Two principles:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \emph{The Principle of Relativity} -- The laws by which the states of
  physical systems undergo change are not affected, whether these
  changes of state be referred to the one or the other of two systems in
  uniform translatory motion relative to each other
\item
  \emph{The Principle of Invariant Light Speed}-- ``\ldots{} light is
  always propagated in empty space with a definite velocity {[}speed{]}
  c which is independent of the state of motion of the emitting body.''
\end{enumerate}

\subsection{Lorentz Transformations}\label{lorentz-transformations}

As a simple case, consider a reference frame \emph{O} and and observer
in another frame \emph{O'} moving at constant speed \(\beta\) along the
\(x\) axis:

\begin{center}
\includesvg{images/Lorentz.svg}
\end{center}

A Lorentz transformation or \emph{boost} is the transformation from one
inertial reference frame to another. In general it is a \((4\times4)\)
matrix which encapsulates the system of equations describing the
transformation (in natural units).

\[\begin{aligned}
t' &= \gamma(t - \beta x) \\
x' &= \gamma(x - \beta t) \\
y' &= y \\
z' &= z
\end{aligned}\]

The matrix form of this transformation is

\[x'^\mu = {\Lambda^\mu}_\nu x^\nu, \; {\Lambda^\mu}_\nu =
\begin{pmatrix}
\gamma & -\beta\gamma & 0 & 0 \\
-\beta\gamma & \gamma & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}\]

This is just a particular case of a Lorentz transformation (there is
nothing special on the x-axis) and a variable invariant under a Lorentz
transformation is called \emph{Lorentz invariant or scalar}.

The line element \(\Delta s^2\) is a Lorentz invariant:

\[\Delta s^2 = \Delta t^2 - \Delta x^2 - \Delta y^2 -\Delta z^2 \]

This can be rewritten as the inner product of a 4-vector \(x^{\mu}\):

\[\Delta s^2 = x^2 \equiv x^\mu x_\mu = g_{\mu\nu} x^\mu x^\nu\]

where \emph{metric tensor} \(g_{\mu\nu}\) is:

\[g_{00} = + 1, g_{11} = g_{22} = g_{33} = - 1 , g_{\mu\nu} = 0, \;\mathrm{ for}\; \mu \neq\nu\]

is called the \textbf{Minkowski space}.

\subsection{Consequences of Lorentz
transformations}\label{consequences-of-lorentz-transformations}

Lorentz transformation have the following (some of them really bizarre)
consequences:

\begin{itemize}
\tightlist
\item
  \textbf{Relativity of simultaneity.} \(\Delta t' = 0\) in \(O'\)
  doesn't imply \(\Delta t = 0\) in \(O\):
\end{itemize}

\[\Delta t' = \gamma(\Delta t - \beta \Delta x)\]

\begin{itemize}
\tightlist
\item
  \textbf{Time dilatation.} If \(\Delta x = 0\) i.e.~the ticks of one
  clock:
\end{itemize}

\[\Delta t' = \gamma \Delta t\]

\begin{itemize}
\item
  \textbf{Length contraction.} For events satisfying \(\Delta t' = 0\):

  \[\Delta x' = \frac{\Delta x}{\gamma}\]
\item
  \textbf{Equivalence of mass and energy.}
\end{itemize}

In 1905, Einstein gave his first derivation of the mass-energy
equivalence by studing, in different reference frames, the energy
balance of a body emiting electromagnetic radiation. You can replace
\emph{body} with a \emph{cat} and check a quick proof of the mass energy
equivalence in this video:

\begin{figure}

\centering{

\url{https://www.youtube.com/watch?v=hW7DW9NIO9M}

}

\caption{\label{fig-minute}Source: Minute Physics}

\end{figure}%

\section{Relativistic kinematics}\label{relativistic-kinematics}

\subsection{Four-vectors}\label{four-vectors}

We saw that position vectors in Minkowski space become 4-vectors with
zeroth component. \(x^0 = t\), identified with time. Likewise momentum
4-vector has \(p^0 = E\):

\[ {\mathbf P} = (E, \vec{p})\]

\[ {\mathbf X} = (t, \vec{x})\]

We saw that the inner product in Minkowski space is invariant under
Lorentz transformations. In this case, the Lorentz invariant is:

\[  s = p_\mu p^{\mu} = m_0^2 = E^2 -{\vec p\cdot \vec p} \rightarrow E^2 = {\vec p\cdot \vec p} +m_0^2\]

which is the \emph{relativistic energy-momentum relationship}.

\[ E = m = \gamma m_0\]

One can derive the expresions for relativistic 3-momentum and kinetic
energy:

\[|{\vec p}|= \beta E\]

\[E_{kin} \equiv E - m_0 = (\gamma -1) m_0\]

\subsection{Transformation to the Center-of-Momentum Frame
(COM)}\label{transformation-to-the-center-of-momentum-frame-com}

As a concrete example of how 4-vectors aid real calculations, let's take
the classic case of a transformation to the center-of-momentum frame
(COM), that is, a coordinate frame where the total three-momentum
\(\vec p = 0\). In this case the invariant square of a system is equal
to the total COM energy square or:

\[\sqrt{s} = E_{COM}\]

In the case of a two-particle system with particles A and B with
energies \((E_A)\) and \((E_B)\), and 3-momenta \((\vec{p}_A)\) and
\((\vec{p}_B)\):

\[\begin{aligned}{2}
s = p^2 &= (E_A + E_B)^2 - (\vec{p}_A + \vec{p}_B)^2 \\
    &= m_A^2 + m_B^2 + 2E_AE_B - 2(\vec{p}_A \cdot \vec{p}_B)\\
    &= m_A^2 + m_B^2 + 2E_AE_B( 1 - \beta_A\beta_B\cos \theta)\\
    &= E_{COM}^2
\end{aligned}\]

where we used the fact that:
\[\vec{p}_A \cdot \vec{p}_B = |\vec{p}_A ||\vec{p}_B|\cos\theta\]

and

\[ |\vec{p}| = E\beta \]

The energy available for new particle creation is
\(\epsilon = E_{COM} - m_B - m_A\). If \(E_A \gg m_A\) and
\(E_B \gg m_B\) then:

\[\epsilon^2 \approx 2 (E_A E_B - \vec{p}_A \vec{p}_B ).\]

\subsection{Fixed-target experiment}\label{fixed-target-experiment}

If the target particle B is at rest in the laboratory system (as is the
case in accelerator fixed-target experiments or UHE cosmic rays striking
nucleons in the atmosphere, or \ldots) then \((E_B = m_B)\) and
\((\vec{p}_B = 0)\). In this case,

\[E_{COM}^2 = m_A^2 + m_B^2 + 2E_Am_B.\]

which in the ultra-relativistic limit where energies are much higher
than the masses \((E \gg m)\) simplifies to

\[\epsilon = E_{COM} \simeq \sqrt{2m_BE_A}.\]

Equivalently, the threshold energy of the beam particle A needed to
produce a particle of mass \((m_*)\) at rest in the boosted frame is:

\[E_{A,\mathrm{thresh}} = \frac{m_*^2}{2m_B}.\]

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-tip-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Example 1: Pion production}]

Considering the photoproduction of pion on a target proton at rest mass:
\[\gamma + p \rightarrow p + \pi^0\]

\[\begin{alignedat}{2}
 \sqrt{s} = \sqrt{m_p^2 + 2E_\gamma m_p} &\geq m_p + m_{\pi^0}\\
m_p^2 + 2 E_\gamma m_p &\geq m_p^2 + m^2_{\pi^0} + 2 m_p^2 m^2_{\pi^0}
\end{alignedat}\]

\[E_\gamma \geq m_{\pi^0} + \frac{m^2_{\pi^0}}{2 m_p} \approx 145 \mathrm{ \; MeV}\]

\end{tcolorbox}

\subsection{Collider experiment}\label{collider-experiment}

In the case of a collider experiment where beam particles A and B are
counter-circulating in an accelerator and collide head-on, then

\[{\vec p}_{A}\cdot{\vec p}_{B} = -|{\vec p}_{A}||{\vec p}_{B}|\]

and the equation of the 3-momenta \({\vec p}_A\) becomes

\[
s = E_{COM}^2 = m_A^2 + m_B^2 + 2(E_AE_B + |{\vec p}_{A}||{\vec p}_{B}|) \rightarrow \epsilon^2 \simeq 4E_AE_B,
\]

in the relativistic limit where mass can be ignored. This in turn has
the consequence that in a collider experiment the energy available in
the COM to produce new particles rises linearly with beam energy when
\(E_A = E_B\).

Nevertheless, it is still the case that the COM energies probed by
astroparticles exceeds the LHC's reach by a factor of 10!

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-tip-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Example 2: UHECR protons}]

Consider an UHECR proton at \(E_p = 10^{10}\;\mathrm{ GeV}\) interacting
with a proton (\(m_p = 1 \mathrm{ GeV}\)) at rest in the atmosphere,
what is the energy in the COM frame?

\[E_{COM} = \sqrt{2 m_p^2 + 2 E_p m_p} \simeq 142\;\; \mathrm{ TeV} \]

\end{tcolorbox}

\subsection{Two-body decay in COM}\label{two-body-decay-in-com}

The COM is also useful to estimate the energy of two particles from the
decay of a particle with mass \(M\). If a particle A decays into \(m_1\)
and \(m_2\), we have that in the COM the particle A has
\({\vec p_A} = {\vec p_{COM}} = 0\). Then the invariant is given by:

\[ s = M^2 = (E_1 + E_2)^2 -  (\vec{p}_1 + \vec{p}_2)^2 \]

where \({\vec p_1} = -{\vec p_2}\). The energies in the COM are given
by:

\[ M^2 = (E_1 + E_2)^2 \rightarrow M = E_1 + E_2 \]

\[E_1^2 = p_1^2 + m_1^2\;\;\;\mathrm{ and}\;\; E_2^2 = p_2^2 + m_2^2\]

since \(|{\vec p_1}| = |{\vec p_2}|\) we can make the substraction:

\[E_1^2 - E_2^2 = m_1^2 - m_2^2 \rightarrow E_2^2 = E_1^2 - m_1^2 + m_2^2\]

sustituing \(E_2^2\) in \(M^2 = E_1^2 + E_2^2 + 2E_1 E_2\) and using
\(E_2 = M - E_1\) we have:

\[M^2 = E_1^2 + E_1^2 - m_1^2 + m_2^2 + 2E_1(M- E_1) \]
\[M^2 = 2E_1^2 - m_1^2 + m_2^2 - 2E_1^2 + 2E_1M\]

\[E_1 = \frac{1}{2M}(M^2 + m_1^2 - m_2^2)\]

likewise we can prove:

\[E_2 = \frac{1}{2M}(M^2 + m_2^2 - m_1^2)\]

and the momentum:

\[{|\vec p_1|^2} = E_1^2 - m_1^2 = \frac{1}{4M^2}(M^4 - 2M^2(m_1^2 + m_2^2) + (m_1^2 + m_2^2)^2) = {|\vec p_2|^2}\]

Energies and momentums are fixed, the only unknowns are the angles.

\section{Cosmology}\label{cosmology}

\subsection{Red-shift}\label{red-shift}

Red-shift is the shift (towards red) in the electromagnetic spectrum and
is defined as:

\[z=\frac{\lambda_{obs} - \lambda_{emit}}{\lambda_{emit}}\]

If a source of the light is moving away from an observer, then redshift
(z \textgreater{} 0) occurs; if the source moves towards the observer,
then blueshift (z \textless{} 0) occurs. This is true for all
electromagnetic waves and is explained by the Doppler effect.
Consequently, this type of redshift is called the \emph{Doppler
redshift}.

\subsection{Relativistic Redshift}\label{relativistic-redshift}

\begin{center}
\includegraphics{index_files/mediabag/images/redshift.pdf}
\end{center}

The wavefront moves with velocity \(c\), but at the same time the source
moves away with velocity \(v\). Afte a time \(t_s\) the source has
receded \(vt\). The crest of the wave emission is at
\(\lambda+v t_s=ct_s\). The period in the reference system of the source
is given by:

\[t_s = \frac{\lambda}{c-v} = \frac{c}{(c-v)f_s} = \frac{1}{(1-\beta)f_s}.\]

Remember that when a reference \(O_s\) was moving at speed \(\beta\)
from a another reference \(O_{o}\), the time relation was:

\[\Delta t_s = \gamma(\Delta t_{o} - \beta \Delta x_{o}).\]

Since \(\Delta x_{o} =0\) (we are just measuring when the crest of the
waves arrive), then the time observed \(t_{o}\) in the reference system
O is given:

\[t_o = \frac{t_s}{\gamma}.\]

The corresponding observed frequency is
\[f_o = \frac{1}{t_o} = \gamma (1-\beta) f_s = \sqrt{\frac{1-\beta}{1+\beta}}\,f_s.\]

The ratio

\[\frac{f_s}{f_o} = \sqrt{\frac{1+\beta}{1-\beta}},\]

is called the \emph{Doppler factor} of the source relative to the
observer.

The corresponding wavelengths are related by

\[\frac{\lambda_o}{\lambda_s} = \frac{f_s}{f_o} = \sqrt{\frac{1+\beta}{1-\beta}},\]

and the resulting redshift

\[z = \frac{\lambda_o - \lambda_s}{\lambda_s} = \frac{f_s - f_o}{f_o},\]

can be written as

\[z = \sqrt{\frac{1+\beta}{1-\beta}} - 1.\]

When interpreted as a relativistic Doppler shift from object receeding
at velocity \(\beta\), this is:

\[\lambda_o = \sqrt{\frac{1+\beta}{1-\beta}}\lambda_s \simeq (1+\beta)\lambda_s\]

In the non-relativistic limit (when \(v \ll c\)) this redshift can be
approximated by \(z \simeq \beta = \frac{v}{c}\) corresponding to the
classical Doppler effect.

\subsection{Hubble expansion}\label{hubble-expansion}

When ploting their redshift (ie speed) as function of distance (measured
with the techniques we saw, parallax, etc.) in 1929 Hubble found a
correlation between redshift and radial distance from Earth:

\begin{center}
\includegraphics{images/unnamed.gif}
\end{center}

\[v = H_0 r, \; H_0 = 72\;\mathrm{ km/s/Mpc}\]

Note that \(H_0\) has only units of time\(^{-1}\) we explicitely write
the other dimensions to better understand its meaning.

But Doppler redshift does not depends on distance! So this not a doppler
redshift but a \textbf{Cosmological redshift}. In this case the redshift
is not due to relative velocities, the photons instead increase in
wavelength and redshift because the spacetime through which they are
traveling is expanding.

But we said that for midly relativistic objects (and galaxies are moving
at midly relativistic speeds) we can approximate \(z \approx \beta\) so
we \emph{can use \(z\) to estimate distances!}:

\[r \simeq \frac{c}{H_0}z \simeq 4000\;\mathrm{ Mpc}\cdot z\]

For small \(v\) over distance \(r\) the \textbf{velocity is proportional
to the distance}. Note that however this only holds only for \emph{small
redshifts!}.

For larger redshifts other relations with the distance need to be
invoked.

\subsubsection{Age of the Universe (first
approximation)}\label{age-of-the-universe-first-approximation}

If we assume that the rate of expansion (ie H) is essentially constant
(it is not!) the age of the Universe can be estimated by this relation:

\[\frac{d r}{dt} = H_0 r \rightarrow \int \frac{1}{r}dr =\int H_0 dt\]

\[ \mathrm{ In} r = H_0 t \rightarrow r = e^{H_0 t}\]

where Universe increases by a factor \(e\) every
\(t_{\mathrm{Hubble}} = \frac{1}{H_0} = 14\times 10^9\mathrm{ yr}\)
which is the \textbf{Hubble time}.

\subsubsection{Are we expanding?}\label{are-we-expanding}

\begin{quote}
\href{https://www.youtube.com/watch?v=5U1-OmAICpU}{Brooklyn is not
expanding!} \emph{Annie Hall}
\end{quote}

\section{Cosmological principle}\label{cosmological-principle}

The \emph{cosmological principle} is the notion that the distribution of
matter in the Universe is \textbf{homogeneous} and \textbf{isotropic}
when viewed on a large enough scale.

\begin{itemize}
\tightlist
\item
  \textbf{Homogeneity} states that the distribution of matter is even in
  each epoch.
\item
  \textbf{Isotropy} states that there are no prefered directions in the
  distribution of matter in space.
\end{itemize}

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{index_files/mediabag/2df_slice_blue_big.gif}
\end{center}

The
\href{http://en.wikipedia.org/wiki/Observable_universe\#End_of_Greatness}{End
of Greatness} is an observational scale discovered at roughly 100 Mpc
where the lumpiness seen in the large-scale structure of the universe is
homogenized and isotropized, this together with the isotropy of the CMB
reinforced the idea of the \textbf{Cosmological Principle}.

However, in 2013 a new structure \textbf{3 Gpc} wide has been
discovered, the \href{http://arxiv.org/abs/1311.1104}{Hercules--Corona
Borealis Great Wall}, which puts doubt on the validity of the
cosmological principle.

\subsection{Friedmann--Lemaître-Robertson-Walker}\label{friedmannlemauxeetre-robertson-walker}

Despite seing all galaxies receding, we are not at the center of the
Universe. The common interpretation of the expansion is that we are
living in a Universe that can be thought of lying on the surface of a
balloon. Distances between objects (points on the ballon) on this
manifold are expressed as:

\[r(t) = R(t)r_0\]

where \(R(t)\) is a scale factor, depending on the time, and \(r_0\) is
a \emph{comoving coordinate} without time dependence or current distance
if we assume \(R(0) = 1\), but sometimes its better to explicitelly use
a \emph{normalized} scale factor as \(a(t) = R(t)/R(0)\)

So we are looking for a Universe that is isotropic, homogeneous and it
is expanding. The metric that describes such a Universe is given by the
\textbf{Friedmann--Lemaître-Robertson-Walker} metric:

\[ds^2 = dt^2 - R(t)^2 d \Sigma(k)^2 \]
\[= dt^2 - a^2(t)R^2_0\left[\frac{dr^2}{1 - kr^2} + r^2(d\theta^2  + sin^2\theta d\phi^2)\right]\]

where \(d\Sigma(k)\) refers to the spatial 3-dimentional metric
depending on the curvature parameter \(k\) which takes the discrete
values +1, 0, -1, corresponding to a closed, open or spacially flat
geometry, and we used the normalized form of the scale factor
\(a(t) = R(t)/R_0\).

\begin{figure}[H]

{\centering \includegraphics[width=0.6\textwidth,height=\textheight]{index_files/mediabag/universe-shape-1024x.jpg}

}

\caption{Source: quantum-bits.org}

\end{figure}%

The evolution of the scale parameter as in the case of wavelength (see
Exercises):

\[a(t) = \frac{1}{1+z}.\]

\subsection{Friedman Equations}\label{friedman-equations}

The dynamics's of the FLRW metric is governed by the Einstein's
equations. Einstein's original field equations are:

\[R_{\mu\nu} - \frac{1}{2}Rg_{\mu\nu} = 8 \pi GT_{\mu\nu}.\]

In Newtonian gravity, the source is mass. In special relativity, is a
more general concept called the energy-momemtum tensor, which may be
modeled as a perfect fluid for which:

\[T_{\mu\nu} = (\rho + p)U_\mu U_\nu + pg_{\mu\nu},\]

where \(U_\mu\) is the fluid four-velocity in co-moving coordinates,
\(\rho\) is an energy density and \(p\) is the isotropic pressure. The
FLRW metric solution to the Einstein equations can be reduced to the two
\textbf{Friedmann equations}:

\[H^2 \equiv \left(\frac{\dot a}{a}\right)^{2} =  \frac{8\pi G}{3}\rho - \frac{kc^{2}}{a^2R^2_0},\]

and

\[\frac{\ddot a}{a} = -\frac{4\pi G}{3}(\rho + 3p).\]

\subsection{Cosmological Constants}\label{cosmological-constants}

Given the Friedmann equations we can calculate for any value of \(H\)
the critical density such as the geometry is flat (\(k=0\)):

\[\rho_{crit} = \frac{3H^2}{8\pi G}\]

It is convenient to measure the the total energy density in terms of
critical density by introducing the density parameters:

\[\Omega\equiv\frac{\rho}{\rho_{crit}} = \left(\frac{8\pi G}{3H^2}\right)\rho\]

In general the energy density will have contributions of distinct
components so whe can defined:

\[\Omega_i\equiv\frac{\rho_i}{\rho_{crit}} = \left(\frac{8\pi G}{3H^2}\right)\rho_i\]

where \(i\) stands for the different components of the energy density as
we will see later: matter (or dust), radiation, cosmological density,
curvature density.

For the special case of \(a(t_0) = 1\), ie, today, we have the formula:

\[H_0^2\Omega_0 = \frac{8\pi G}{3}\rho_0\]

\subsection{The Cosmological Constant}\label{the-cosmological-constant}

Einstein was interested in finding \(\dot{a} = 0\) (ie static)
solutions. This can be achieved if \(k= + 1\) and \(\rho\) is
appropriately tuned. But \(\ddot a\) will not vanish in this case.
Einstein therefore modified his equations to:

\[R_{\mu\nu} - \frac{1}{2}Rg_{\mu\nu} = 8 \pi GT_{\mu\nu} + \Lambda g_{\mu\nu},\]

where the \(\lambda\) term is put in the rhs of the equation as it is
interpreted as an effective energy-momentum tensor for the vacuum. With
this modification the Friedmann equations become:

\[
\begin{aligned}
H^2  &=  \left(\frac{\dot a}{a} \right)^2 = \frac{8\pi G}{3}\rho + \frac{\Lambda}{3} - \frac{kc^{2}}{a^2R^2_0} \\
\frac{\ddot a}{a} &= -\frac{4\pi G}{3}(\rho + 3p) +  \frac{\Lambda}{3}
\end{aligned}
\]

The discovery by Hubble that the Universe is expanding eliminated the
empirical need for a static world. However, we believe that \(\Lambda\)
is actually nonzero, so Einstein was right after all. Assuming that
cosmological constant is due to the vacuum energy, most quantum field
theories predict a \(\Lambda\) that is 120 orders of magnitude larger
than the observational values! this is so-called \textbf{cosmological
constant problem}.

\subsection{Evolution of the Cosmological
Constants}\label{evolution-of-the-cosmological-constants}

In general the energy density will have contributions of distinct
components which will evolve differently with the Universe expansion:

\begin{itemize}
\tightlist
\item
  Massive particles with negligible velocities are known in cosmology as
  \emph{dust} or simply \emph{matter}. Their density scales as the
  number density times their rest mass. Their number density scales as
  the inverse of the volume while the rest mass is constant:
  \(\rho_M \propto a^{-3}\)
\item
  Relativistic particles are known as \emph{radiation} (although it is
  not only photons) and their energy density is the number density times
  the particle energy, the latter is proportional to \(a^{-1}\) (as they
  redshift with expansion) and so: \(\rho_r \propto a^{-4}\)
\item
  Vacuum energy does not change as universe expand so we can define a
  \(\rho_\Lambda \equiv \frac{\Lambda}{8\pi G} \propto a^0\)
\item
  It is useful to pretend that \(-ka^{-2}R_0^{-2}\) represents an
  effective \emph{curvature energy density} defining
  \(\rho_k \equiv -(3k/8\pi G R^2_0)a^{-2}\).
\end{itemize}

Given this evolution it is possible to write:

\[ H^2(t) = H^2_0 [\Omega^0_M(1+z)^3 + \Omega^0_r(1+z)^4 + \Omega^0_k(1+z)^2 +\Omega^0_\Lambda]\]

\subsection{Observational results}\label{observational-results}

\begin{itemize}
\item
  There are good reasons to believe that the energy density of radiation
  is much less than matter, as photon contrinute only to
  \(\Omega_r \sim 5 \times 10^{-5}\) mostly in the CMB. Therefore is
  useful to parametrize the universe today as
  \(\Omega_k = 1 - \Omega_M - \Omega_\Lambda\).
\item
  \textbf{Direct measures of the Hubble constant.}. The most reliable
  result on the Hubble constant comes from the
  \href{http://iopscience.iop.org/0004-637X/553/1/47}{Hubble Space
  Telecope Key Project}. They use the Cepheids to obtain distances to 31
  galaxies (They also use Type Ia Supernovae). A recent study with over
  600 Cepheids yielded the number
  \(H_0 = 73.8 \pm 2.4 \mathrm{\;km\;s^{-1}\; Mpc^{-1}}\). The indirect
  measurement from \emph{Planck} Collaboration gives somehow a lower
  value (this discrepancy as well as the comic distance-ladder method
  are under investigation).
\item
  \textbf{Supernovae.} Two major studies, the Supernova Cosmology
  Project and the High-\(z\) Supernova Search Team, found evidence for
  an accelerating Universe. When combined with the CMB data indicating
  flatness (ie
  \(\Omega_k = 0 \rightarrow \Omega_M + \Omega_\Lambda = 1\)), the
  best-fit values were \(\Omega_M \approx 0.3\) and
  \(\Omega_\Lambda \approx 0.7\))
\item
  \textbf{Cosmic Microwave Background.} See next section.
\end{itemize}

\subsection{Cosmic Microwave
Background}\label{cosmic-microwave-background}

The cosmic microwave background (CMB) is electromagnetic radiation that
remains from the time when photons decoupled from matter shortly after
the recombination of electrons and protons into neutral hydrogen atoms.
Once photons decoupled from matter, they traveled freely through the
universe without interacting with matter. For an observer today this CMB
is observed as a distribution of temperatures (from black body
radiation) at on a two-dimensional sphere. This temperature
distribution, however, was shown to have anisotropies. If we denote
\(\Delta T (\theta, \phi)\) the temperature difference measured in the
direction
(\(\sin\theta \cos \theta, \sin\theta \sin\theta , \cos\theta\)) with
respect to \(T_0 =\) 2.725 K, the average temperature we can decompose
these anisotropies over the bases of spherical harmonics, the so called
\(Y_{\ell m} (\theta, \phi)\), the same way a we can decompose a
function in a curved space over sines and cosines by the Fourier
transform:

\[\frac{\Delta T}{T} = \sum_{\ell m} a_{\ell m} Y_{\ell m} (\theta, \phi)\]

This decomposition tell us the amount of anisotropy at a given the
multipole moment \(\ell\) or angular scale
\(\theta = \frac{180^{\circ}}{\ell}\)

\[C_\ell = \langle |a_{\ell m}|^2 \rangle\]

\begin{figure}[H]

{\centering \includegraphics[width=0.7\textwidth,height=\textheight]{index_files/mediabag/Planck_power_spectru.jpg}

}

\caption{Source: ESA}

\end{figure}%

The power spectrum of the CMB represents the anisotropies of the CMB as
a function of the angular scale. The typical spectrum features a plateu
at large angular scales (small \(\ell\)) followed by some oscillatory
features (aka acoustic peaks or \emph{Doppler peak}). These peaks
represent the oscillation of photon-baryon fuild around the decoupling.
The first peak at \(\ell \sim 200\) probes the spatial geometry, while
the relative heights probe the baryon density. The position of the first
peak constrains the spatial geometry in a way consistent with a flat
Universe (\(\Omega_k \sim 0\))

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Build your own Universe}]

You can build your own Universe
\href{https://lambda.gsfc.nasa.gov/education/cmb_plotter/}{here}

\end{tcolorbox}

\subsection{Before Planck}\label{before-planck}

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/eso0419d.jpg}
\end{center}

\subsection{After Planck}\label{after-planck}

Planck showed that the amount of dark energy in the Universe is
appreciably less than we had previously thought, while the amount of
dark-and-normal matter is appreciably greater than we thought.

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/Lambda_Matter.jpg}
\end{center}

\subsection{Cosmography}\label{cosmography}

Using the Huble equation we are going to derive some quantities related
to the measurement of the Universe.

\subsubsection{Age of the Universe}\label{age-of-the-universe}

We have shown the evolution of the Hubble expansion as a function of the
redshift using the clousure parameters. We know that

\[H(z) = \frac{\dot a}{a} = -\left(\frac{\mathrm{ d}z/\mathrm{ d}t}{(1+z)}\right) \rightarrow \mathrm{ d}t = -\frac{\mathrm{ d}z}{(1+z)H(z)}\]

And so the age of the universe can be calculated as (where \(z=0\)
corresponds to today \(t_0\)):

\[\int_{0}^{t_0} \mathrm{ d} t = t_0 = \frac{1}{H_0} \int^\infty_0 \frac{\mathrm{ d}z}{E(z)}\]

where we defined the following function:

\[E(z)\equiv \sqrt{\Omega_M(1+z)^4 + \Omega_r(1+z)^5 + \Omega_k(1+z)^3 +\Omega_\Lambda(1+z)}.\]

Assuming a flat Universe \(\Omega_k =0\) and ignoring the radiation
\(\Omega_r \ll \Omega_M\) the integral gets simplified to:

\[H_0 t_0 = \frac{1}{3\sqrt{1 - \Omega_M}}\mathrm{ In}\left(\frac{1+\sqrt{1 - \Omega_M}}{1 - \sqrt{1- \Omega_M}}\right)\]
where we used \(1 = \Omega_\Lambda + \Omega_M.\)

For \(\Omega_M = 0.70\) and \(\Omega_\Lambda = (1 - \Omega_M) = 0.30\)
one finds \(H_0 t_0 = 0.964\) so that
\(t_0 \approx \frac{0.96}{H_0} = 13.5\) Gyr. Which is similar to the
assumption we did with a constant \(H_0\).

\subsubsection{Comoving distance (Line of
Sight)}\label{comoving-distance-line-of-sight}

The comoving distance between two nearby objects in the Universe is the
distance between them which remains constant with epoch if the two
objects are moving with the \emph{Hubble flow}. That an object follows
the \emph{Hubble flow} if there is no peculiar velocities, ie, the only
reason the 2 objects separate is due to the expansion of the Universe
and not because the have relative velocities among them. The comoving
distance has the expansion factored out and therefore remains constant
with epoch. You can think of it as the distance measured with a ruler
that also expands with the Universe. Using the same argument as above
with the age of the Universe we can multiplying by the speed of light we
can derive:

\[D_c(z) = \int_{t}^{t_0} c\mathrm{ d} t = \frac{c}{H_0} \int^z_0 \frac{\mathrm{ d}z^\prime}{E(z^\prime)}.\]

This is the comoving distance along the \emph{line of sight}. Ie, is the
comoving distance from a galaxy at redshift \(z\) from us. If we want to
estimate, let's say, the distance between 2 galaxies at the same
redshift but separated in angle \(\Delta \theta\), then the distance is
given by \(D_M \Delta \theta\) where \(D_M\) is the \emph{transverse
comoving distance}. For a flat Universe \(D_M = D_c\) but if the
curvature is not zero, the relationship depends on the trigonometric
functions \(\sinh\) (for a closed Universe) and \(\sin\) (for an open
Universe) to account for the curvature of spacetime.

\subsubsection{Luminosity distances}\label{luminosity-distances}

The luminosity distance defined in cosmology is defined as the distace
in which an object with intrinsic luminosity \(L\) is observed with flux
\(f\), ie:

\[ f = \frac{L}{4\pi d_L^2}.\]

This in terms of bolometric values, however sometimes we only observe a
given bandwidth in frequency, ie, we have to replace
\(f\rightarrow f(\nu_o)\) and \(L \rightarrow L(\nu_{e})\) where
\(\nu_o\) and \(\nu_e\) are the observed and emitted frequencies. Since
the luminosity is defined as energy delivered over interval of time, we
can approximate it as:

\[ L(\nu_e) = \frac{Nh\nu_e}{\Delta t_e},\]
\[ L(\nu_o) = \frac{Nh\nu_o}{\Delta t_o},\]

being \(N\) the number of photos. However the photons emitted are
redshifted and photons observed at \(\nu_o\) were emitted at
\((1+z)\nu_o\). The time intervals are also related by the expansion of
the Universe as:

\[\frac{\Delta t_e}{\Delta t_o} = \frac{1}{(1+z)}.\]

So we have that the emitted luminosity and the observed luminosity are
related as:

\[L(\nu_o) = \frac{L(\nu_e)}{(1+z)^2}.\]

The observed luminosity is smaller than the emitted luminosity. On the
other hand the relation between the observed flux and observed
luminosity is the same as in a non-expanding Universe. ie:

\[f(\nu_o) = \frac{L(\nu_o)}{4\pi D_c^2},\]

where \(D_c\) is the co-moving distance. Putting everything together we
have that:

\[f(\nu_o) = \frac{1}{(1+z)^2}\frac{L(\nu_e)}{4\pi D_c^2} = \frac{L(\nu_e)}{4\pi D_L^2},\]
so we have the relation between the luminosity distance and the
co-moving distance as:

\[D_L = D_c(1+z).\]

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial IV: Age of the Universe}\vspace{3mm}

In the about the age of the Universe we calculated an analytical
solution for a given condition. No we are goign to use \texttt{python}
to numerically solve the look-back time for any given set of
cosmological parameters. For that we are going to rewrite the loopback
formula in terms of the scale factor \(a\) since we have the redshift
scale relation:

\[(1+z) = \frac{1}{a}\]

we can prove that:

\[\frac{\mathrm{ d}z}{1 +z} = -\frac{\mathrm{ d}a}{a}\]

Therefore the equation above that relates \(\mathrm{d}t\) with redshift
we can rewrite it at:

\[ \mathrm{ d}t = \frac{\mathrm{d}a}{H(a)a} \]

with

\[  H^2(a) = H^2_0 [\Omega^0_M a^{-3} + \Omega^0_r a^{-4} + \Omega^0_k a^{-2} +\Omega^0_\Lambda] \]

We need to numerically integrate the right hand side of the equation.
However, for some parameters this integration is circular, reaching a
\(a_{max}\) then the \(H^2(a_{max}) = 0\)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#We take the current value of H0 from the astropy package}

\ImportTok{from}\NormalTok{ astropy.cosmology }\ImportTok{import}\NormalTok{ Planck13}
\NormalTok{H0 }\OperatorTok{=}\NormalTok{ Planck13.H(}\DecValTok{0}\NormalTok{).value}

\CommentTok{\#We define the friedman equation ignoring the radiation component omega\_r \textless{}\textless{}}
\KeywordTok{def}\NormalTok{ friedman(a, omega\_M, omega\_lambda):}
\NormalTok{    omega\_k }\OperatorTok{=} \DecValTok{1} \OperatorTok{{-}}\NormalTok{ omega\_M }\OperatorTok{{-}}\NormalTok{ omega\_lambda}
\NormalTok{    H2 }\OperatorTok{=}\NormalTok{ H0}\OperatorTok{**}\DecValTok{2} \OperatorTok{*}\NormalTok{ (omega\_M }\OperatorTok{*}\NormalTok{ a}\OperatorTok{**{-}}\DecValTok{3} \OperatorTok{+}\NormalTok{ omega\_k }\OperatorTok{*}\NormalTok{ a}\OperatorTok{**{-}}\DecValTok{2} \OperatorTok{+}\NormalTok{ omega\_lambda)}
    \ControlFlowTok{return}\NormalTok{ H2}

\ImportTok{import}\NormalTok{ scipy.integrate }\ImportTok{as}\NormalTok{ integrate}

\CommentTok{\#This is a simple integration, it does not take into account a possible Big Crunch}
\CommentTok{"""}
\CommentTok{def calculate\_times(omega\_m, omega\_lambda):}
\CommentTok{    t0 = integrate.quad(lambda x: 1/x * 1/np.sqrt(friedman(x,omega\_m, omega\_lambda)), 0, 1)[0]}
\CommentTok{    times = []}
\CommentTok{    scales = np.arange(0.1, 2, 0.01)}
\CommentTok{    for a in scales:}
\CommentTok{        time = integrate.quad(lambda x: 1/x * 1/np.sqrt(friedman(x,omega\_m, omega\_lambda)), 0, a)[0]}
\CommentTok{        times.append(H0*(time {-} t0))  }

\CommentTok{    return np.array(times), np.array(scales)}
\CommentTok{"""}

\CommentTok{\#This integration takes into account a Big Crunch}
\KeywordTok{def}\NormalTok{ calculate\_times(omega\_m, omega\_lambda):}
    \CommentTok{\#Lets check if there is a maximal, ie, if H\^{}2(a) = 0}
\NormalTok{    astep }\OperatorTok{=} \FloatTok{0.001}
\NormalTok{    amax }\OperatorTok{=} \DecValTok{3}
\NormalTok{    scales }\OperatorTok{=}\NormalTok{ np.arange(}\FloatTok{0.1}\NormalTok{, amax, astep)}

\NormalTok{    f }\OperatorTok{=}\NormalTok{ friedman(scales, omega\_m, omega\_lambda)}
\NormalTok{    ia, }\OperatorTok{=}\NormalTok{ np.where(np.diff(np.sign(f)))}

    \ControlFlowTok{if} \BuiltInTok{len}\NormalTok{(ia) }\OperatorTok{!=} \DecValTok{0}\NormalTok{:}
\NormalTok{        amax }\OperatorTok{=}\NormalTok{ scales[ia[}\DecValTok{0}\NormalTok{]]}
    
\NormalTok{    tmax }\OperatorTok{=}\NormalTok{ integrate.quad(}\KeywordTok{lambda}\NormalTok{ x: }\DecValTok{1}\OperatorTok{/}\NormalTok{x }\OperatorTok{*} \DecValTok{1}\OperatorTok{/}\NormalTok{np.sqrt(friedman(x,omega\_m, omega\_lambda)), }\DecValTok{0}\NormalTok{, amax }\OperatorTok{{-}}\NormalTok{ astep)[}\DecValTok{0}\NormalTok{]}
    \CommentTok{\#time today a = 1}
\NormalTok{    t0 }\OperatorTok{=}\NormalTok{ integrate.quad(}\KeywordTok{lambda}\NormalTok{ x: }\DecValTok{1}\OperatorTok{/}\NormalTok{x }\OperatorTok{*} \DecValTok{1}\OperatorTok{/}\NormalTok{np.sqrt(friedman(x,omega\_m, omega\_lambda)), }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)[}\DecValTok{0}\NormalTok{]}

    \CommentTok{\#Empty x,y for the plots}
\NormalTok{    times }\OperatorTok{=}\NormalTok{ []}
\NormalTok{    scale }\OperatorTok{=}\NormalTok{ []}
    \ControlFlowTok{for}\NormalTok{ a }\KeywordTok{in}\NormalTok{ scales:}
        \ControlFlowTok{if}\NormalTok{ a }\OperatorTok{\textless{}}\NormalTok{ amax: }\CommentTok{\#If a \textless{} amax we do the typical integral 0 {-}\textgreater{} a}
\NormalTok{            time }\OperatorTok{=}\NormalTok{ integrate.quad(}\KeywordTok{lambda}\NormalTok{ x: }\DecValTok{1}\OperatorTok{/}\NormalTok{x }\OperatorTok{*} \DecValTok{1}\OperatorTok{/}\NormalTok{np.sqrt(friedman(x,omega\_m, omega\_lambda)), }\DecValTok{0}\NormalTok{, a)[}\DecValTok{0}\NormalTok{]}
\NormalTok{            times.append(H0}\OperatorTok{*}\NormalTok{(time }\OperatorTok{{-}}\NormalTok{ t0)) }\CommentTok{\#We calibrate at {-}t0 to place all curves together}
\NormalTok{            scale.append(a)}
        \ControlFlowTok{if}\NormalTok{ a }\OperatorTok{\textgreater{}=}\NormalTok{ amax }\KeywordTok{and} \DecValTok{2}\OperatorTok{*}\NormalTok{amax }\OperatorTok{{-}}\NormalTok{ a }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{: }\CommentTok{\#If a \textgreater{} amax we are out the domain we integrate backwards}
\NormalTok{            time }\OperatorTok{=} \DecValTok{2}\OperatorTok{*}\NormalTok{tmax }\OperatorTok{{-}}\NormalTok{ integrate.quad(}\KeywordTok{lambda}\NormalTok{ x: }\DecValTok{1}\OperatorTok{/}\NormalTok{x }\OperatorTok{*} \DecValTok{1}\OperatorTok{/}\NormalTok{np.sqrt(friedman(x,omega\_m, omega\_lambda)), }\DecValTok{0}\NormalTok{, }\DecValTok{2}\OperatorTok{*}\NormalTok{amax }\OperatorTok{{-}}\NormalTok{ a)[}\DecValTok{0}\NormalTok{]}
\NormalTok{            times.append(H0}\OperatorTok{*}\NormalTok{(time }\OperatorTok{{-}}\NormalTok{ t0))}
\NormalTok{            scale.append(}\DecValTok{2}\OperatorTok{*}\NormalTok{amax }\OperatorTok{{-}}\NormalTok{ a)}
    \ControlFlowTok{return}\NormalTok{ np.array(times), np.array(scale)}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{))}

\NormalTok{omega\_M }\OperatorTok{=} \FloatTok{0.3}
\NormalTok{omega\_lambda }\OperatorTok{=} \FloatTok{0.7}
\NormalTok{x, y }\OperatorTok{=}\NormalTok{ calculate\_times(omega\_M, omega\_lambda)}
\NormalTok{ax.plot(x, y, label}\OperatorTok{=}\VerbatimStringTok{fr"$\textbackslash{}Omega\_M =$ }\SpecialCharTok{\{}\NormalTok{omega\_M}\SpecialCharTok{:.2f\}}\VerbatimStringTok{, $\textbackslash{}Omega\_\textbackslash{}Lambda =$ }\SpecialCharTok{\{}\NormalTok{omega\_lambda}\SpecialCharTok{:.2f\}}\VerbatimStringTok{"}\NormalTok{)}

\NormalTok{omega\_M }\OperatorTok{=} \FloatTok{1.0}
\NormalTok{omega\_lambda }\OperatorTok{=} \DecValTok{0}
\NormalTok{x, y }\OperatorTok{=}\NormalTok{ calculate\_times(omega\_M, omega\_lambda)}
\NormalTok{ax.plot(x, y, lw }\OperatorTok{=} \DecValTok{2}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{fr"$\textbackslash{}Omega\_M =$ }\SpecialCharTok{\{}\NormalTok{omega\_M}\SpecialCharTok{:.2f\}}\VerbatimStringTok{, $\textbackslash{}Omega\_\textbackslash{}Lambda =$ }\SpecialCharTok{\{}\NormalTok{omega\_lambda}\SpecialCharTok{:.2f\}}\VerbatimStringTok{"}\NormalTok{)}

\NormalTok{omega\_M }\OperatorTok{=} \FloatTok{0.3}
\NormalTok{omega\_lambda }\OperatorTok{=} \DecValTok{0}
\NormalTok{x, y }\OperatorTok{=}\NormalTok{ calculate\_times(omega\_M, omega\_lambda)}
\NormalTok{ax.plot(x, y, lw }\OperatorTok{=} \DecValTok{2}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{fr"$\textbackslash{}Omega\_M =$ }\SpecialCharTok{\{}\NormalTok{omega\_M}\SpecialCharTok{:.2f\}}\VerbatimStringTok{, $\textbackslash{}Omega\_\textbackslash{}Lambda =$ }\SpecialCharTok{\{}\NormalTok{omega\_lambda}\SpecialCharTok{:.2f\}}\VerbatimStringTok{"}\NormalTok{)}

\NormalTok{omega\_M }\OperatorTok{=} \DecValTok{4}
\NormalTok{omega\_lambda }\OperatorTok{=} \DecValTok{0}
\NormalTok{x, y }\OperatorTok{=}\NormalTok{ calculate\_times(omega\_M, omega\_lambda)}
\NormalTok{ax.plot(x, y, lw }\OperatorTok{=} \DecValTok{2}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{fr"$\textbackslash{}Omega\_M =$ }\SpecialCharTok{\{}\NormalTok{omega\_M}\SpecialCharTok{:.2f\}}\VerbatimStringTok{, $\textbackslash{}Omega\_\textbackslash{}Lambda =$ }\SpecialCharTok{\{}\NormalTok{omega\_lambda}\SpecialCharTok{:.2f\}}\VerbatimStringTok{"}\NormalTok{)}


\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{"upper left"}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{ax.set\_xlim(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{,}\FloatTok{1.5}\NormalTok{)}
\NormalTok{ax.set\_ylim(}\FloatTok{0.2}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{"$a(t)$"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{"$H\_0 (t {-} t\_0)$"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{index_files/mediabag/chap1_files/figure-pdf/fig-age-output-1.pdf}

}

\caption{\label{fig-age}Age of the Universe}

\end{figure}%

\end{tcolorbox}

\subsubsection*{References}\label{references}
\addcontentsline{toc}{subsubsection}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-Claus}
Grupen, Claus. n.d. \emph{Astro Particle Physics}.

\bibitem[\citeproctext]{ref-kachelriess2008lecture}
Kachelriess, M. 2008. {``Lecture Notes on High Energy Cosmic Rays.''}
\url{https://arxiv.org/abs/0801.4376}.

\bibitem[\citeproctext]{ref-Kampert_2014}
Kampert, Karl-Heinz, and Peter Tinyakov. 2014. {``Cosmic Rays from the
Ankle to the Cutoff.''} \emph{Comptes Rendus. Physique} 15 (4): 318--28.
\url{https://doi.org/10.1016/j.crhy.2014.04.006}.

\bibitem[\citeproctext]{ref-72925f46-3bcd-305f-ad05-7b07a9fbcf25}
Melia, Fulvio. 2009. \emph{High-Energy Astrophysics}. Vol. 14. Princeton
University Press. \url{http://www.jstor.org/stable/j.ctv21r3q4z}.

\bibitem[\citeproctext]{ref-Workman:2022ynf}
Workman, R. L., and Others. 2022. {``{Review of Particle Physics}.''}
\emph{PTEP} 2022: 083C01. \url{https://doi.org/10.1093/ptep/ptac097}.

\end{CSLReferences}

\bookmarksetup{startatroot}

\chapter{Cosmic Rays}\label{cosmic-rays}

\section{What are Cosmic Rays? An historic
perspective}\label{what-are-cosmic-rays-an-historic-perspective}

To explain cosmic rays, we need to go back about 100 years to the year
1912 when Victor Hess concluded a series of balloon flights equipped
with an electroscope. He measured how ionization in the atmosphere
increased as he moved away from the Earth's surface. The origin of this
ionization had to be some type of radiation, and since it increased with
altitude, the origin couldn't be terrestrial. In other words, there
existed, and still exdists, radiation coming from outer space. For this
milestone, Victor Hess is known as the discoverer of cosmic rays.
However, it would be unfair to attribute the merit solely to Hess, as
many physicists before him had already paved the way that would
culminate in his famous balloon flights: Theodor Wulf, Karl Bergwitz,
and Domenico Pacini, among others, laid the foundations for one of the
branches of particle physics that would dominate the field for the next
40 years until the advent of the first particle accelerators in the
early 1950s.

\begin{figure}[H]

{\centering \includegraphics[width=0.5\textwidth,height=\textheight]{images/Electroscope_showing_induction.png}

}

\caption{Electroscope charged by induction. Source: Sylvanus P. Thompson
(1881) Elementary Lessons in Electricity and Magnetism, MacMillan, New
York, p.16, fig.~12}

\end{figure}%

From the begining, cosmic rays were mysterious: What was their origin?
What were these ionizing rays? During the 1920s, Bruno Rossi and Robert
Millikan engaged in a lively debate on the nature of cosmic rays.
Millikan proposed that cosmic rays were ``ultra''-gamma rays, photons of
very high energy created in the fusion of hydrogen in space. Rossi's
measurements, showing an East-West asymmetry in the intensity of cosmic
rays, suggested instead that cosmic rays must be charged particles,
disproving Millikan's theories. There is a famous anecdote in which
Rossi, during the introductory talk at a conference in Rome, said:
\textgreater{} Clearly, Millikan is resentful because a young man like
me has shattered his beloved theory, so much so that from that moment
on, he refuses to acknowledge my existence'' A hundred years later, we
know that Rossi was indeed correct. The majority, 90\%, of cosmic rays
are protons and other heavy nuclei. The ratio of nuclei faithfully
follows the atomic abundance found in our Solar System, indicating that
the origin of these particles is stellar. There are some exceptions; for
example, lithium, beryllium, and boron are nuclei that we can find among
cosmic rays in a proportion greater than in our environment. These
nuclei are actually produced by the fragmentation of heavier ones, such
as carbon, during their journey through space. Thus, the abundance ratio
between carbon and boron provides information about how long carbon has
been traveling through space.

The spectrum, or the number of particles per unit area and time as a
function of energy, has also been measured in great detail over the last
30 years thanks to the work of numerous experiments. The cosmic ray
spectrum is remarkable in both its variation and energy range. The
number of particles, or flux, covers 32 orders of magnitude, so we find
that the least energetic particles reach Earth at a rate of one particle
per square meter every second. On the other hand, the most energetic
ones arrive at a rate of one particle per square kilometer per year.
This is why physicists have had to develop various experimental
techniques to measure the spectrum of cosmic rays in its entirety: from
particle detectors sent into space on satellites or attached to the
International Space Station, to experiments deployed on large surfaces
of the Earth to detect the most energetic cosmic rays, such as the
Pierre Auger Observatory covering an area of about 3000 km2 on the high
plateau of the Pampa Amarilla in Malargüe, Argentina.

But what makes cosmic rays truly fascinating is the amount of energy
these particles can reach, far superior to what can be achieved today
with the most powerful accelerator built by humans with the Large Hadron
Collider (LHC) at the European Organization for Nuclear Research (CERN)
in Geneva. The LHC is an underground ring with a length of 27 km located
on the Franco-Swiss border near Geneva, Switzerland, using powerful
magnets to accelerate protons to 99.99\% of the speed of light. Despite
the impressiveness of this experiment, if we were to accelerate
particles to the energies of cosmic rays with the same technology, we
would need an accelerator the size of the orbit of Mercury. The speed of
cosmic rays is so high that the effects of space-time relativity are
considerable. For example, although the radius of our Galaxy is about
100,000 light-years, due to the temporal contraction of special
relativity, the most energetic cosmic rays would experience they will
experience the journey in just 10 seconds. When cosmic rays reach Earth,
they encounter 10 kilometers of atmosphere which, along with the Earth's
magnetic field, fortunately acts as a shield and protects us from
radiation. However, when cosmic rays collide with atoms in the
atmosphere, they trigger a shower of new particles. This shower is known
as secondary cosmic rays, and in it, we can find a diverse array of new
particles. This is why, for many years, the physics of cosmic rays was
the only way for particle physicists to discover and study new
particles. Thus, following in Hess's footsteps, during the 1940s, many
physicists moved from the laboratory to hot air balloons equipped with
bubble chambers (a primitive version of a particle detector) to study
this myriad of new particles. Among the new particles discovered were,
for example, the first particle of antimatter: the positron, a
positively charged electron, as well as the muon, with properties
similar to the electron but with greater mass.

But what is the origin of cosmic rays? Which sources in the Universe are
capable of accelerating particles to such energies? That is the question
that, despite 100 years since Victor Hess's discovery, physicists have
not been able to fully answer. The main reason is, however, easy to
understand. Cosmic rays, being charged particles, are deflected by
magnetic fields during their journey through the Universe. Both the
Milky Way and intergalactic space are immersed in magnetic fields, so
when cosmic rays reach Earth, their direction has little or nothing to
do with the original direction, making it impossible to do
\emph{astronomy}. However, despite this disadvantage, we can deduce some
things about their origin based on, for example, their energy. We know
that low-energy cosmic rays must come from our own Galaxy because the
magnetic fields of the Milky Way would confine them until they
eventually interact with Earth. On the other end of the spectrum,
extremely high-energy cosmic rays (UHECRs) must come from outside our
own Galaxy since they are so energetic that the magnetic fields of their
respective galaxies would not be able to retain them. The exact turning
point in energy between these two origins is uncertain. So far, we have
been unable to undoubtivously observe a cosmic-ray source. One of the
main candidates for the source of galactic cosmic rays are supernova
remnants. At the end of a star's life cycle, it can explode, releasing a
large amount of mass and energy. What remains behind can be a neutron
star surrounded by all the remnants left from the original star; this is
what is called a supernova remnant. It is more challenging to conceive a
cosmic accelerator capable of accelerating particles up to the energy
equivalent of a soccer ball kicked at 50 km/h, which corresponds to the
energies of UHECRs. Here the list of candidates is considerably reduced
because there are fewer objects in the Universe with the magnetic field
and size sufficient to act as a large particle accelerator. The
candidates are active galactic nuclei and gamma-ray bursts. Active
galactic nuclei are the nuclei of galaxies with a supermassive black
hole at their center. These nuclei show beams of particles in opposite
directions that could function as large accelerators. On the other hand,
gamma-ray bursts are the most violent events known in the Universe, and
their origin and nature would warrant another chapter of this book.
Lasting from a few seconds to a few minutes, these events can illuminate
the entire sky by releasing their energy mainly in the form of very
high-energy photons. But if cosmic rays never point to their source, how
can we ever be sure that active galactic nuclei or gamma-ray bursts are
the true sources of cosmic rays? To answer this puzzle, we need what has
been dubbed as \emph{multi-messenger astronomy}. Thanks to particle
physics, we know that under the conditions in which, for example, a
proton is accelerated to high energies, reactions with the surrounding
matter can occur. These interactions would produce other particles such
as very high-energy photons and neutrinos. Neutrinos are especially
interesting because they are not only neutral and therefore travel in a
straight line without being deflected by magnetic fields, but they are
also weakly interacting particles, so unlike photons, they can traverse
dense regions of the Universe without being absorbed. Future multi
messenger experiments will be able to solve the mystery of cosmic rays.

\section{The Cosmic Ray Spectrum}\label{the-cosmic-ray-spectrum}

Cosmic rays mostly protons accelerated at sites within the Galaxy.

\begin{itemize}
\tightlist
\item
  As they are charged they are deviated in galactic and inter-galactic
  \(\vec{B}\) and solar and terrestrial magnetic fields. Directionality
  only possible for \(E \gt 10^{19}\) eV.
\item
  But interactions with CMB at \(E \sim 10^{19}\) limit horizon tens or
  hundreds of Mpc.
\item
  One century after discovery, origins of cosmic rays, in particular
  UHECR, remain \textbf{unknown}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ crdb}
\ImportTok{import}\NormalTok{ matplotlib.pylab }\ImportTok{as}\NormalTok{ plt}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}font.family\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{"STIXGeneral"}
\NormalTok{plt.rcParams.update(\{}\StringTok{\textquotesingle{}axes.labelsize\textquotesingle{}}\NormalTok{: }\DecValTok{20}\NormalTok{\})}
\NormalTok{plt.rcParams.update(\{}\StringTok{\textquotesingle{}legend.fontsize\textquotesingle{}}\NormalTok{: }\DecValTok{20}\NormalTok{\})}
\NormalTok{plt.rcParams.update(\{}\StringTok{\textquotesingle{}figure.figsize\textquotesingle{}}\NormalTok{: [}\DecValTok{8}\NormalTok{, }\DecValTok{6}\NormalTok{]\})}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.labelsize\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{18}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.labelsize\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{18}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.major.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.minor.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.major.pad\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{8}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.direction\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{\textquotesingle{}in\textquotesingle{}}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.major.size\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{10}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.minor.size\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.major.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.minor.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.major.pad\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{8}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.direction\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{\textquotesingle{}in\textquotesingle{}}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}legend.frameon\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \VariableTok{False}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}lines.linewidth\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}axes.linewidth\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}



\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}

\ImportTok{from}\NormalTok{ crdb.experimental }\ImportTok{import}\NormalTok{ convert\_energy}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{))}
\NormalTok{elements }\OperatorTok{=}\NormalTok{ (}\StringTok{"H"}\NormalTok{, }\StringTok{"He"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"N"}\NormalTok{, }\StringTok{"O"}\NormalTok{, }\StringTok{"Si"}\NormalTok{, }\StringTok{"Fe"}\NormalTok{)}
\NormalTok{elements }\OperatorTok{+=}\NormalTok{ (}\StringTok{"1H{-}bar"}\NormalTok{, }\StringTok{"e{-}+e+"}\NormalTok{, }\StringTok{"AllParticles"}\NormalTok{)}

\NormalTok{tabs }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ energy\_type }\KeywordTok{in}\NormalTok{ (}\StringTok{"EKN"}\NormalTok{, }\StringTok{"ETOT"}\NormalTok{):}
    \ControlFlowTok{for}\NormalTok{ elem }\KeywordTok{in}\NormalTok{ elements:}
\NormalTok{        tab }\OperatorTok{=}\NormalTok{ crdb.query(}
\NormalTok{            elem,}
\NormalTok{            energy\_type}\OperatorTok{=}\NormalTok{energy\_type,}
\NormalTok{            energy\_convert\_level}\OperatorTok{=}\DecValTok{1}\NormalTok{,}
\NormalTok{        )}
        \ControlFlowTok{if}\NormalTok{ energy\_type }\OperatorTok{==} \StringTok{"EKN"}\NormalTok{:}
\NormalTok{            tab }\OperatorTok{=}\NormalTok{ convert\_energy(tab, }\StringTok{"EK"}\NormalTok{)}
\NormalTok{        tabs.append(tab)}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ np.concatenate(tabs).view(np.recarray)}

\CommentTok{\#Lets ignore data without systematic errors}
\NormalTok{mask }\OperatorTok{=}\NormalTok{ (tab.err\_sys[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (tab.err\_sta[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{/}\NormalTok{ tab.value }\OperatorTok{\textless{}} \FloatTok{0.5}\NormalTok{)}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[mask]}
\NormalTok{ax.set\_xlim(}\FloatTok{1e{-}2}\NormalTok{, }\FloatTok{5e11}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ elem }\KeywordTok{in}\NormalTok{ elements:}
\NormalTok{    ma }\OperatorTok{=}\NormalTok{ tab.quantity }\OperatorTok{==}\NormalTok{ elem}

\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[ma]}
    \ControlFlowTok{if} \BuiltInTok{len}\NormalTok{(t) }\OperatorTok{==} \DecValTok{0}\NormalTok{:}
        \ControlFlowTok{continue}
\NormalTok{    sta }\OperatorTok{=}\NormalTok{ np.transpose(t.err\_sta)}
\NormalTok{    color }\OperatorTok{=} \StringTok{"k"} \ControlFlowTok{if}\NormalTok{ elem }\OperatorTok{==} \StringTok{"AllParticles"} \ControlFlowTok{else} \VariableTok{None}
\NormalTok{    ax.errorbar(t.e, t.value, sta, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, color}\OperatorTok{=}\NormalTok{color)}
\NormalTok{ax.loglog()}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"$E\_k$ d$J$/d$E\_k$ [1/(m$\^{}2$ s sr)]"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"$E\_k$ [GeV]"}\NormalTok{)}
\NormalTok{ax.grid()}

\NormalTok{m }\OperatorTok{=} \DecValTok{1}
\NormalTok{km }\OperatorTok{=} \FloatTok{1e3} \OperatorTok{*}\NormalTok{ m}
\NormalTok{s }\OperatorTok{=} \DecValTok{1}
\NormalTok{sr }\OperatorTok{=} \DecValTok{1}
\NormalTok{hour }\OperatorTok{=} \DecValTok{60}\OperatorTok{**}\DecValTok{2} \OperatorTok{*}\NormalTok{ s}
\NormalTok{day }\OperatorTok{=} \DecValTok{24} \OperatorTok{*}\NormalTok{ hour}
\NormalTok{month }\OperatorTok{=} \DecValTok{30} \OperatorTok{*}\NormalTok{ day}
\NormalTok{year }\OperatorTok{=} \DecValTok{356} \OperatorTok{*}\NormalTok{ day}
\NormalTok{century }\OperatorTok{=} \DecValTok{100} \OperatorTok{*}\NormalTok{ year}

\ControlFlowTok{for}\NormalTok{ flux\_ref }\KeywordTok{in}\NormalTok{ (}
        \StringTok{"1/m\^{}2/s/sr"}\NormalTok{,}
        \StringTok{"1/m\^{}2/day/sr"}\NormalTok{,}
        \StringTok{"1/m\^{}2/year/sr"}\NormalTok{,}
        \StringTok{"1/km\^{}2/day/sr"}\NormalTok{,}
        \StringTok{"1/km\^{}2/century/sr"}\NormalTok{,}
\NormalTok{    ):}
\NormalTok{        v }\OperatorTok{=} \BuiltInTok{eval}\NormalTok{(flux\_ref.replace(}\StringTok{"\^{}2"}\NormalTok{, }\StringTok{"**2"}\NormalTok{))}
\NormalTok{        label }\OperatorTok{=}\NormalTok{ flux\_ref.replace(}\StringTok{"\^{}2"}\NormalTok{, }\StringTok{"$\^{}2$"}\NormalTok{)}
\NormalTok{        ax.axhline(y}\OperatorTok{=}\NormalTok{v, color}\OperatorTok{=}\StringTok{"0.4"}\NormalTok{, lw }\OperatorTok{=} \DecValTok{2}\NormalTok{)}
\NormalTok{        ax.text(}
                \DecValTok{10}\OperatorTok{**}\DecValTok{11}\NormalTok{,}
\NormalTok{                v }\OperatorTok{*} \FloatTok{1.1}\NormalTok{,}
\NormalTok{                label,}
\NormalTok{                va}\OperatorTok{=}\StringTok{"bottom"}\NormalTok{,}
\NormalTok{                ha}\OperatorTok{=}\StringTok{"right"}\NormalTok{,}
\NormalTok{                color}\OperatorTok{=}\StringTok{"0.4"}\NormalTok{,}
\NormalTok{                zorder}\OperatorTok{=}\DecValTok{0}\NormalTok{,}
\NormalTok{            )}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{chap2_files/figure-pdf/fig-cr-output-1.pdf}

}

\caption{\label{fig-cr}All particle cosmic ray spectrum}

\end{figure}%

\subsection{Cosmic Ray as function
of\ldots{}}\label{cosmic-ray-as-function-of}

There are four different ways to describe the spectra of the cosmic ray
radiation:

\begin{itemize}
\tightlist
\item
  By \textbf{particles per unit rigidity}. Propagation and deflection on
  magnetic fields depends on the rigidity.
\item
  By \textbf{particles per energy-per-nucleon}. Fragmentation of nuclei
  propagating through the interstellar gas depends on energy per
  nucleon, since that quantity is approximately conserved when a nucleus
  breaks up on interaction with the gas.
\item
  By \textbf{nucleons per energy-per-nucleon}. Production of secondary
  cosmic rays in the atmosphere depends on the intensity of nucleons per
  energy-per-nucleon, approximately independently of whether the
  incident nucleons are free protons or bound in nuclei.
\item
  By \textbf{particles per energy-per-nucleus}. Air shower experiments
  that use the atmosphere as a calorimeter generally measure a quantity
  that is related to total energy per particle.
\end{itemize}

For \(E > 100\) TeV the difference between the kinetic energy and the
total energy is negligible and fluxes are obten presented as
\textbf{particle per energy-per-nucleus}.

For \(E < 100\) TeV the difference is important and it is common to
present \textbf{nucleons per kinetic energy-per-nucleon}. This is the
usual way of presenting the spectrum for nuclei with different masses:
the conversion in energy per nucleus is not trivial.

\subsection{Primary Cosmic Rays}\label{primary-cosmic-rays}

The energy spectrum of primary nucleons from GeV to \textasciitilde{}
100 TeV is given by:

\[I(E) \approx 1.8 \times 10^4 \left(\frac{E}{1\; \mathrm{GeV}}\right)^{-2.7} \frac{\mathrm{nucleons}}{\mathrm{m}^2\; \mathrm{s\;sr\;GeV}}\]

Where \(\alpha \equiv 1+ \gamma = 2.7\) is the differential spectral
index and \(\gamma\) the integral spectral index. The composition of the
bulk of cosmic rays are: 80\% protons, 15\% He, and the rest are heavier
nuclei: C, O, Fe and other ionized nuclei and electrons (2\%)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{elements }\OperatorTok{=}\NormalTok{ \{}
    \StringTok{"H"}\NormalTok{: }\DecValTok{0}\NormalTok{,}
    \StringTok{"He"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{2}\NormalTok{,}
    \StringTok{"C"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{4}\NormalTok{,}
    \StringTok{"O"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{6}\NormalTok{,}
    \StringTok{"Ne"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{8}\NormalTok{,}
    \StringTok{"Mg"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{10}\NormalTok{,}
    \StringTok{"Si"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{12}\NormalTok{,}
    \StringTok{"S"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{14}\NormalTok{,}
    \StringTok{"Ar"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{16}\NormalTok{,}
    \StringTok{"Ca"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{18}\NormalTok{,}
    \StringTok{"Fe"}\NormalTok{: }\OperatorTok{{-}}\DecValTok{21}\NormalTok{,}
\NormalTok{\}}
\NormalTok{xlim }\OperatorTok{=} \FloatTok{1e{-}2}\NormalTok{, }\FloatTok{1e6}

\NormalTok{tabs }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ elem }\KeywordTok{in}\NormalTok{ elements:}
\NormalTok{    tabs.append(crdb.query(elem, energy\_type}\OperatorTok{=}\StringTok{"EKN"}\NormalTok{))}

\NormalTok{tab }\OperatorTok{=}\NormalTok{ np.concatenate(tabs).view(np.recarray)}
\CommentTok{\# use our energy range}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[(xlim[}\DecValTok{0}\NormalTok{] }\OperatorTok{\textless{}}\NormalTok{ tab.e) }\OperatorTok{\&}\NormalTok{ (tab.e }\OperatorTok{\textless{}}\NormalTok{ xlim[}\DecValTok{1}\NormalTok{])]}
\CommentTok{\# we don\textquotesingle{}t want upper limits}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[}\OperatorTok{\textasciitilde{}}\NormalTok{tab.is\_upper\_limit]}
\CommentTok{\# statistical errors less than 100 \%}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[np.mean(tab.err\_sta, axis}\OperatorTok{=}\DecValTok{1}\NormalTok{) }\OperatorTok{/}\NormalTok{ tab.value }\OperatorTok{\textless{}} \DecValTok{1}\NormalTok{]}
\CommentTok{\# skip balloon data}
\NormalTok{mask }\OperatorTok{=}\NormalTok{ crdb.experiment\_masks(tab)[}\StringTok{"Balloon"}\NormalTok{]}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[}\OperatorTok{\textasciitilde{}}\NormalTok{mask]}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{9}\NormalTok{))}
\NormalTok{masks }\OperatorTok{=}\NormalTok{ crdb.experiment\_masks(tab)}
\ControlFlowTok{for}\NormalTok{ exp }\KeywordTok{in} \BuiltInTok{sorted}\NormalTok{(masks):}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[masks[exp]]}
\NormalTok{    first }\OperatorTok{=} \VariableTok{True}
\NormalTok{    color }\OperatorTok{=} \VariableTok{None}
\NormalTok{    marker }\OperatorTok{=} \VariableTok{None}
    \ControlFlowTok{for}\NormalTok{ elem, fexp }\KeywordTok{in}\NormalTok{ elements.items():}
\NormalTok{        f }\OperatorTok{=} \DecValTok{10}\OperatorTok{**}\NormalTok{fexp}
\NormalTok{        t2 }\OperatorTok{=}\NormalTok{ t[t.quantity }\OperatorTok{==}\NormalTok{ elem]}
        \ControlFlowTok{if} \BuiltInTok{len}\NormalTok{(t2) }\OperatorTok{==} \DecValTok{0}\NormalTok{:}
            \ControlFlowTok{continue}
\NormalTok{        sta }\OperatorTok{=}\NormalTok{ np.transpose(t2.err\_sta)}
\NormalTok{        l }\OperatorTok{=}\NormalTok{ ax.errorbar(t2.e, t2.value}\OperatorTok{*}\NormalTok{f, sta}\OperatorTok{*}\NormalTok{f, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, color}\OperatorTok{=}\NormalTok{color, label }\OperatorTok{=}\NormalTok{ exp }\ControlFlowTok{if}\NormalTok{ first }\ControlFlowTok{else} \VariableTok{None}\NormalTok{)}
\NormalTok{        first }\OperatorTok{=} \VariableTok{False}
\NormalTok{        color }\OperatorTok{=}\NormalTok{ l.get\_children()[}\DecValTok{0}\NormalTok{].get\_color()}

\ControlFlowTok{for}\NormalTok{ elem, fexp }\KeywordTok{in}\NormalTok{ elements.items():}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[tab.quantity }\OperatorTok{==}\NormalTok{ elem]}
\NormalTok{    ymean }\OperatorTok{=}\NormalTok{ np.exp(np.mean(np.log(t[t.e }\OperatorTok{\textless{}}\NormalTok{ xlim[}\DecValTok{0}\NormalTok{] }\OperatorTok{*} \DecValTok{100}\NormalTok{].value))) }\OperatorTok{*} \DecValTok{10}\OperatorTok{**}\NormalTok{fexp}
\NormalTok{    s }\OperatorTok{=} \SpecialStringTok{f"}\SpecialCharTok{\{}\NormalTok{elem}\SpecialCharTok{\}}\CharTok{\textbackslash{}n}\SpecialStringTok{$}\CharTok{\textbackslash{}\textbackslash{}}\SpecialStringTok{times 10\^{}}\CharTok{\{\{}\SpecialCharTok{\{}\NormalTok{fexp}\SpecialCharTok{\}}\CharTok{\}\}}\SpecialStringTok{$"} \ControlFlowTok{if}\NormalTok{ fexp }\OperatorTok{!=} \DecValTok{0} \ControlFlowTok{else} \SpecialStringTok{f"}\SpecialCharTok{\{}\NormalTok{elem}\SpecialCharTok{\}}\SpecialStringTok{"}
\NormalTok{    ax.text(}\FloatTok{2e{-}3}\NormalTok{, ymean, s, va}\OperatorTok{=}\StringTok{"center"}\NormalTok{, ha}\OperatorTok{=}\StringTok{"center"}\NormalTok{)}

\NormalTok{ax.grid(color}\OperatorTok{=}\StringTok{"0.9"}\NormalTok{)}
\NormalTok{ax.set\_xlim(xlim[}\DecValTok{0}\NormalTok{]}\OperatorTok{/}\DecValTok{30}\NormalTok{, xlim[}\DecValTok{1}\NormalTok{])}
\NormalTok{ax.loglog()}
\NormalTok{ax.legend(}
\NormalTok{    fontsize}\OperatorTok{=}\StringTok{"xx{-}small"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, loc}\OperatorTok{=}\StringTok{"upper left"}\NormalTok{, ncol}\OperatorTok{=}\DecValTok{2}\NormalTok{, bbox\_to\_anchor}\OperatorTok{=}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#ax.legend()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{chap2_files/figure-pdf/fig-primaries-output-1.pdf}

}

\caption{\label{fig-primaries}Cosmic Ray spectrum per element}

\end{figure}%

\subsection{Galactic Cosmic Ray
Composition}\label{galactic-cosmic-ray-composition}

\begin{itemize}
\tightlist
\item
  The chemical composition of cosmic rays is similar to the abundances
  of the elements in the Sun indicating an \textbf{stellar origin of
  cosmic rays}.
\item
  However there are some differences: Li, Be, B are secondary nuclei
  produced in the spallation of heavier elements (C and O). Also Mn, V,
  and Sc come from the fragmentation of Fe. These are usually referred
  as \textbf{secondary cosmic rays}.
\item
  The see-saw effect is due to the fact that nuclei with odd Z and/or A
  have weaker bounds and are less frequent products of thermonuclear
  reactions.
\end{itemize}

By measuring the primary-to-secondary ratio we can infer the propagation
and diffusion processes of CR.

\begin{figure}[H]

{\centering \includegraphics{images/composition_2.png}

}

\caption{Cosmic ray composition. Source: CRDB}

\end{figure}%

\subsection{Electrons}\label{electrons}

The spectrum of electrons is expected to steepen because the radioactive
energy loss in the Galaxy. Electrons will lose energy primarly due to
synchrotron radiation and Compton scattering.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tab }\OperatorTok{=}\NormalTok{ crdb.query(}\StringTok{"e{-}+e+"}\NormalTok{, energy\_type}\OperatorTok{=}\StringTok{"EK"}\NormalTok{)}

\NormalTok{xlim }\OperatorTok{=} \DecValTok{1}\NormalTok{, }\FloatTok{1e4}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[(xlim[}\DecValTok{0}\NormalTok{] }\OperatorTok{\textless{}}\NormalTok{ tab.e) }\OperatorTok{\&}\NormalTok{ (tab.e }\OperatorTok{\textless{}}\NormalTok{ xlim[}\DecValTok{1}\NormalTok{])]}

\NormalTok{exclude\_exp }\OperatorTok{=}\NormalTok{ (}\StringTok{"Balloon"}\NormalTok{, }\StringTok{"LEE"}\NormalTok{)}
\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ i, (exp, mask) }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(crdb.experiment\_masks(tab).items()):}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[mask]}
\NormalTok{    f }\OperatorTok{=}\NormalTok{ t.e}\OperatorTok{**}\DecValTok{3} \CommentTok{\#We plot Flux*E**3}
\NormalTok{    sta }\OperatorTok{=}\NormalTok{ np.transpose(t.err\_sta)}
    \ControlFlowTok{if}\NormalTok{ exp }\KeywordTok{in}\NormalTok{ exclude\_exp: }\CommentTok{\# Let\textquotesingle{}s exclide ballon experiments}
        \ControlFlowTok{continue}
\NormalTok{    ax.errorbar(}
\NormalTok{        t.e, t.value}\OperatorTok{*}\NormalTok{f, sta}\OperatorTok{*}\NormalTok{f, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, label}\OperatorTok{=}\NormalTok{exp}
\NormalTok{    )}

\NormalTok{ax.set\_xlim(}\OperatorTok{*}\NormalTok{xlim)}
\NormalTok{ax.set\_ylim(}\DecValTok{1}\NormalTok{, }\FloatTok{8e2}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"E$\_k$ [GeV]"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"E$\_k\^{}3$ dJ/dE$\_k$ [GeV$\^{}2$ / (m$\^{}2$ s sr)]"}\NormalTok{)}
\NormalTok{ax.legend(fontsize}\OperatorTok{=}\StringTok{"xx{-}small"}\NormalTok{, ncol}\OperatorTok{=}\DecValTok{3}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, bbox\_to\_anchor}\OperatorTok{=}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{ax.loglog()}
\NormalTok{ax.grid(color}\OperatorTok{=}\StringTok{"0.9"}\NormalTok{)}
\NormalTok{ax.loglog()}
\NormalTok{ax.legend(}
\NormalTok{    fontsize}\OperatorTok{=}\StringTok{"xx{-}small"}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, loc}\OperatorTok{=}\StringTok{"upper left"}\NormalTok{, ncol}\OperatorTok{=}\DecValTok{2}\NormalTok{, bbox\_to\_anchor}\OperatorTok{=}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{chap2_files/figure-pdf/fig-cr-electrons-output-1.pdf}

}

\caption{\label{fig-cr-electrons}Spectrum of \(e^-+e^+\) cosmic rays}

\end{figure}%

The plot above shows the (\(e^− + e^+\)) spectrum, only PAMELA data
refers only to \(e^−\). As can be seen there are several features worth
noting:

\begin{itemize}
\tightlist
\item
  The proton spectrum is also shown multiplied by 0.01, which means that
  electrons contribute only 1\% to the CR.
\item
  For \(E \leq\) 20 GeV the spectra is dominated by solar modulations
  and somehow follows the proton spectrum.
\item
  At about 5 GeV there is a change in the spectrum. Sometimes identified
  as the energy when electrons start too loose energy, and therefore the
  spectrum becomes steeper.
\item
  For \(E >\) 50 GeV spectra is well fitted with a power law of
  \(\sim 3.1\) for \(e^−\) and \(\sim 2.7\) for \(e^+\). Since \(e^−\)
  domimate over \(e^+\) the overall spectrum (\(e^− + e^+\)) also
  follows a spectral index of \(\sim 3\). Electron spectrum is much
  steeper than the proton one.
\item
  The sum spectrum (\(e^− + e^+\)) has a sharp break at \(E \simeq\) 1
  TeV, however this is dominated by the \(e^−\) with an estimate of a
  ratio of 3 − 4 in \(e^−/e^+\).
\item
  There is an excess measured by ATIC at \(\sim 700\) GeV. The existance
  of that feature has, however, never been confirmed by other
  experiments (Fermi, DAMPE, HESS).
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Question}]

Assuming the electron flux is only 1\% of the protons. Is it the Earth
positive charged-up?

\end{tcolorbox}

\subsection{Antimatter}\label{antimatter}

\begin{itemize}
\tightlist
\item
  As antimatter is rare in the Universe today, all antimatter we observe
  are by-product of particle interactions such as Cosmic Rays
  interacting with the interstellar gas.
\item
  The PAMELA and AMS-02 satellite experiments measured the positron to
  electron ratio to increase above 10 GeV instead of the expected
  decrease at higher energy.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{5}\NormalTok{))}

\NormalTok{tab }\OperatorTok{=}\NormalTok{ crdb.query(}\StringTok{"e+/e{-}+e+"}\NormalTok{, energy\_type}\OperatorTok{=}\StringTok{"EK"}\NormalTok{)}

\NormalTok{xlim }\OperatorTok{=} \FloatTok{0.8}\NormalTok{, }\FloatTok{1e3}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[(xlim[}\DecValTok{0}\NormalTok{] }\OperatorTok{\textless{}}\NormalTok{ tab.e) }\OperatorTok{\&}\NormalTok{ (tab.e }\OperatorTok{\textless{}}\NormalTok{ xlim[}\DecValTok{1}\NormalTok{])]}

\NormalTok{experiments }\OperatorTok{=}\NormalTok{ (}\StringTok{"AMS01"}\NormalTok{, }\StringTok{"AMS02"}\NormalTok{, }\StringTok{"PAMELA"}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ i, (exp, mask) }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(crdb.experiment\_masks(tab).items()):}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[mask]}
\NormalTok{    sta }\OperatorTok{=}\NormalTok{ np.transpose(t.err\_sta)}
    \ControlFlowTok{if}\NormalTok{ exp }\KeywordTok{in}\NormalTok{ experiments:}
\NormalTok{        ax.errorbar(t.e, t.value, sta, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, label}\OperatorTok{=}\NormalTok{exp)    }
        
\NormalTok{ax.set\_xlim(}\OperatorTok{*}\NormalTok{xlim)}
\NormalTok{ax.set\_ylim(}\DecValTok{0}\NormalTok{, }\FloatTok{0.3}\NormalTok{)}
\NormalTok{ax.grid(color}\OperatorTok{=}\StringTok{"0.4"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"$E\_k$ [GeV]"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"$\textbackslash{}frac\{e\^{}+\}\{e\^{}{-}+e\^{}+\}$"}\NormalTok{)}
\NormalTok{ax.legend(}
\NormalTok{    ncol}\OperatorTok{=}\DecValTok{1}\NormalTok{,}
\NormalTok{    loc}\OperatorTok{=}\StringTok{"upper left"}\NormalTok{,}
\NormalTok{)}
\NormalTok{ax.semilogx()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{chap2_files/figure-pdf/fig-positrons-output-1.pdf}

}

\caption{\label{fig-positrons}Positron excess}

\end{figure}%

This excess might hint to to contributions from individual nearby
sources (supernova remnants or pulsars) emerging above a background
suppressed at high energy by synchrotron losses.

\section{Galactic Cosmic Rays}\label{galactic-cosmic-rays}

\subsection{Propagation of Cosmic
Rays}\label{propagation-of-cosmic-rays}

One trivial argument to discriminate between a Galacic or extra-Galactic
origin of the origin of cosmic rays is to check whether or not the
larmor radius, \(r_L\), of cosmic ray particles is of the order of the
size of the Galaxy. As we showed, we can express the larmor radius as:

\[r_L \simeq  1 \;\mathrm{kpc} \left(\frac{E}{10^{18}\;\mathrm{eV}}\right)\left(\frac{1}{Z}\right)\left(\frac{\mu\mathrm{G}}{B}\right)\]

and so the maximum energy to contain cosmic rays in the Galaxy is:

\[E < 10^{18}\;\mathrm{eV} \left(\frac{h}{1\;\mathrm{kpc}}\right)\left(\frac{\mu\mathrm{G}}{B}\right)\]

There are many uncertainties in these numbers but we can assume that the
size of the Galactic halo is \(h \sim 1 - 10\; \mathrm{kpc}\), and the
magnetic field in the halo is about \(B \sim 0.1 - 10 \;\mu\mathrm{G}\).
Putting this number gives maximum energy of
\(E_{max} \sim 10^{17} - 10^{20} \;\mathrm{eV}\). Given this result we
can assume that lower energy cosmic rays come from own Galaxy, otherwise
they would have escaped.

\subsubsection{Cosmic-ray Interactions}\label{cosmic-ray-interactions}

Since the bluck of cosmic-ray particles are expected come from the
Galaxy we can now evaluate where and how they will interact during their
travel. There are two chiefly process in which a cosmic-ray particle can
interact:

\begin{itemize}
\tightlist
\item
  \textbf{Coulomb collissions:} They occur when a particle interacts
  with another particle via electric fields.

  \begin{itemize}
  \tightlist
  \item
    The Coulomb cross-section for a 1 GeV particle is
    \(10^{-30} \; \mathrm{cm}^2\).
  \item
    For 1 GeV cosmic-ray propating in the ISM
    (\(n \sim 1 \; \mathrm{cm}^{-3}\)) the mean Coulomb interacion
    length rate is \(1/n\sigma \sim 324100 \; \mathrm{Mpc}\) which is
    much larger than the Galaxy size. Therefore \textbf{coulomb
    collisions can be neglected.}
  \end{itemize}
\item
  \textbf{Spallations processes:} It occurs when C, N, O, Fe nuclei
  impact on intestellar hydrogen. The large nuclei is broken up into
  smaller nuclei. A clear indication of a spallation comes precisely
  from the composition comparison with stellar matter.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sigma }\OperatorTok{=} \FloatTok{1e{-}30} \CommentTok{\#in cm2}
\NormalTok{n }\OperatorTok{=} \DecValTok{1} \CommentTok{\# in cm{-}3}
\NormalTok{l }\OperatorTok{=} \FloatTok{1.}\OperatorTok{/}\NormalTok{(n}\OperatorTok{*}\NormalTok{sigma) }\OperatorTok{*} \FloatTok{3.241e{-}25} \CommentTok{\# in Mpc}
\BuiltInTok{print}\NormalTok{ (}\SpecialStringTok{f"The interaction length for Coulomb collisions is }\SpecialCharTok{\{}\NormalTok{l}\SpecialCharTok{:.2\}}\SpecialStringTok{ Mpc"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
The interaction length for Coulomb collisions is 3.2e+05 Mpc
\end{verbatim}

\subsubsection{The Interstellar Medium
(ISM)}\label{the-interstellar-medium-ism}

Given the low density of the Galactic halo it is clear that the
spallation processes must occur in the Galactic Disk. The Galactic Disk
is mostly populated by the Interstellar Medium or ISM. It is mostly
composed by Hydrogen in 3 different phases:

\begin{itemize}
\item
  Molecular Gas. This phase is the more clumpsy as they gathered in
  molecular clouds that can reach densities of
  \(10^{6} \; \mathrm{cm}^{-3}\) which is still very low for our
  atmosphere standards (14 lower). It is composed of hydrogene in
  molecular form, \(\mathrm{H}_2\), \(\mathrm{CO}\). Sometimes called
  stars nurseries they are stars forming regions.
\item
  Atomic Gas. Made up of neutral atomic Hydrogen (HI in astronomical
  nomenclature). The maps tracing the \(\mathrm{HI}\) that is organized
  in a spiral pattern, like \(\mathrm{H}_2\), and also its structure is
  quite complex, with overdensities and holes.
\item
  Ionized Gas. Is ionized Hydrogen or \(\mathrm{HII}\).
\end{itemize}

The overall density of the ISM is \(\sim 0.1-1 \;\mathrm{cm}^{-3}\). The
interstellar gas is not a an static gas, but rather is subject to a
turbulent motion.

\subsubsection{The Leaky Box Model}\label{the-leaky-box-model}

The \emph{Leaky Box model} is a very simple model used to describe
cosmic-ray confinement. In this simplified phenomenological picture CRs
are assumed be accelerated in the galactic plane and to propagate freely
within a cylindrical box of size \(H\) and radius \(R\) (see
Figure~\ref{fig-leakybox}) and reflected at the boundaries; the loss of
particles is parametrized assuming the existence of a non-zero
probability of escape for each encounter with the boundary (Poisson
process).

\begin{figure}

\centering{

\includegraphics{images/leakybox.jpg}

}

\caption{\label{fig-leakybox}Representation of the \emph{leaky box}
model of the Galaxy}

\end{figure}%

\subsubsection{Primary-to-Secondary
Ratios}\label{primary-to-secondary-ratios}

Since we know the partial cross-section of spallation processes we can
use the secondary-to-primary abundance ratios to infer the gas column
density traversed by the average cosmic ray.

Let us perform a simply estimate of the \emph{Boron-to-Carbon ratio}.
Boron is chiefly produced by Carbon and Oxygen with approximately
conserved kinetic energy per nucleon (see \emph{Superposition
principle}), so we can relate the \emph{Boron source production rate},
\(Q_B(E)\) to the differential density of Carbon by this equation:

\[Q_B(E) \simeq n_{ISM} \beta c \sigma_{f,B} N_C\]

where, \(n_{ISM}\) denotes the average interstellar gas number density
and \(N_C\) is the Carbon density and \(\beta c\) is the Carbon velocity
and \(\sigma_{f,B}\) is the spallation or fragementation cross-section
of Carbon into Boron.

The Boron disappears by escaping the galaxy in Poisson process or
lossing its energy. The disappearence of Boron can be written using a
lifetime \(\tau\) as:

\[D_B = \frac{N_B}{\tau}\]

assuming the amount of Boron in the Galaxy is constant per unit time,
\(\dot{N}_B = 0\), then the production of Boron has to be equal to the
disappearence rate, in other words: \[\dot{N}_B = 0 = Q_B - D_B\]

We can write:

\[\frac{N_B}{N_C} \simeq n_{H} \beta c \sigma_{\rightarrow B}\tau\]

\paragraph{Boron-to-Carbon Ratio}\label{boron-to-carbon-ratio}

The plot below represents the latest measurements from PAMELA and AMS
satellites of the Boron-to-Carbon ratio. The decrease in energy of the
Boron-to-Carbon ratio suggests that high energy CR spend less time than
the low energy ones in the Galaxy before escaping.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tab }\OperatorTok{=}\NormalTok{ crdb.query(}\StringTok{"B/C"}\NormalTok{, energy\_type}\OperatorTok{=}\StringTok{"EKN"}\NormalTok{)}

\CommentTok{\# select only entries with systematic uncertainties}
\NormalTok{mask }\OperatorTok{=}\NormalTok{ tab.err\_sys[:, }\DecValTok{1}\NormalTok{] }\OperatorTok{\textgreater{}} \DecValTok{0}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[mask]}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{5}\NormalTok{))}

\ImportTok{from}\NormalTok{ matplotlib }\ImportTok{import}\NormalTok{ pyplot }\ImportTok{as}\NormalTok{ plt}
\CommentTok{\# Let\textquotesingle{}s plot AMS02 only}
\ControlFlowTok{for}\NormalTok{ i, (exp, mask) }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(crdb.experiment\_masks(tab).items()):}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[mask]}
\NormalTok{    sta }\OperatorTok{=}\NormalTok{ np.transpose(t.err\_sta)}
\NormalTok{    ax.errorbar(t.e, t.value, sta, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, label}\OperatorTok{=}\NormalTok{exp)}


\NormalTok{ax.legend(ncol}\OperatorTok{=}\DecValTok{2}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{ax.set\_xlabel(}\StringTok{"$E\_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{mathrm}\SpecialCharTok{\{kin\}}\StringTok{ / A$ / GeV"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{"B/C"}\NormalTok{)}
\NormalTok{ax.loglog()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics{chap2_files/figure-pdf/fig-cr-all-output-1.pdf}

}

\caption{\label{fig-cr-all}B/C ratio}

\end{figure}%

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial I: Fit the B/C spectrum of AMS-02 data}\vspace{3mm}

We are going to retrive the data and fit it. We are going to use python
to download the data

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tab }\OperatorTok{=}\NormalTok{ crdb.query(}\StringTok{"B/C"}\NormalTok{, energy\_type}\OperatorTok{=}\StringTok{"EKN"}\NormalTok{)}

\CommentTok{\# select only entries with systematic uncertainties}
\NormalTok{mask }\OperatorTok{=}\NormalTok{ tab.err\_sys[:, }\DecValTok{1}\NormalTok{] }\OperatorTok{\textgreater{}} \DecValTok{0}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[mask]}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{4}\NormalTok{))}

\ImportTok{from}\NormalTok{ matplotlib }\ImportTok{import}\NormalTok{ pyplot }\ImportTok{as}\NormalTok{ plt}
\CommentTok{\# Let\textquotesingle{}s plot AMS02 only}
\ControlFlowTok{for}\NormalTok{ i, (exp, mask) }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(crdb.experiment\_masks(tab).items()):}
    \ControlFlowTok{if}\NormalTok{ exp }\OperatorTok{==} \StringTok{"AMS02"}\NormalTok{:}
\NormalTok{        t }\OperatorTok{=}\NormalTok{ tab[mask]}
\NormalTok{        sta }\OperatorTok{=}\NormalTok{ np.transpose(t.err\_sta)}
\NormalTok{        ax.errorbar(t.e, t.value, sta, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, label}\OperatorTok{=}\NormalTok{exp)}
\CommentTok{\#Let\textquotesingle{}s use a simple linear model in log{-}log}
\KeywordTok{def}\NormalTok{ model(x, a, b):}
    \ControlFlowTok{return}\NormalTok{ a  }\OperatorTok{+}\NormalTok{ b }\OperatorTok{*}\NormalTok{ x}

\ImportTok{from}\NormalTok{ scipy.optimize }\ImportTok{import}\NormalTok{ curve\_fit}
\CommentTok{\#We only fit in the linear part, ie when E \textgreater{} 10 GeV and we ignore statistical errors. }
\NormalTok{mask }\OperatorTok{=}\NormalTok{ t.e }\OperatorTok{\textgreater{}} \DecValTok{10}
\NormalTok{popt, pcov }\OperatorTok{=}\NormalTok{ curve\_fit(model, np.log10(t.e[mask]), np.log10(t.value[mask]))}

\NormalTok{ax.plot(t.e[mask], np.power(}\DecValTok{10}\NormalTok{, model(np.log10(t.e[mask]), popt[}\DecValTok{0}\NormalTok{], popt[}\DecValTok{1}\NormalTok{])),  linewidth}\OperatorTok{=}\DecValTok{2}\NormalTok{)}

\NormalTok{ax.legend(ncol}\OperatorTok{=}\DecValTok{2}\NormalTok{, frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{ax.set\_xlabel(}\StringTok{"$E\_}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{mathrm}\SpecialCharTok{\{kin\}}\StringTok{ / A$ / GeV"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{"B/C"}\NormalTok{)}
\NormalTok{ax.loglog()}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"The values are }\CharTok{\textbackslash{}u03B1}\SpecialStringTok{ = }\SpecialCharTok{\{}\DecValTok{10}\OperatorTok{**}\NormalTok{popt[}\DecValTok{0}\NormalTok{]}\SpecialCharTok{:.2\}}\SpecialStringTok{ and }\CharTok{\textbackslash{}u03B2}\SpecialStringTok{ = }\SpecialCharTok{\{}\NormalTok{popt[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{:.2\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
The values are α = 0.44 and β = -0.34
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{chap2_files/figure-pdf/bc-output-2.pdf}

}

\caption{Boron to Carbon ratio}

\end{figure}%

\end{tcolorbox}

Above about 10 GeV/nucleon the \textbf{experimental data} can be fitted
to a test function, therefore the Boron-to-Carbon ratio can be expressed
as:

\[\frac{N_B}{N_C} = n_{H}\beta c \sigma_{f,B} \tau  =0.4 \left(\frac{E}{\mathrm{GeV}}\right)^{-0.3}\]

For energies above 10 GeV/nucleon we can approximate \(\beta \sim 1\),
which leads, using the values of the cross-section, to a life time gas
density of:

\[n_H \tau \simeq 10^{14}\left(\frac{E}{\mathrm{GeV}}\right)^{-0.3} \; \mathrm{s}\;\mathrm{cm}^{-3}\]

\paragraph{Boron Lifetime}\label{boron-lifetime}

But what is this Boron lifetime? The lifetime \(\tau\) for Boron
includes the \textbf{catastrophic loss} time due to the partial
fragmentation of Boron, \(\tau_{f,B}\) and the \textbf{escape
probability} from the Galactic confinement volume, \(T_{esc}\). The
fragmentation cross section is \(\sigma_{f,B} \approx 250\) mbarn so we
find that:

\[n_H \tau_{f,B} = \frac{n_H}{n_H \beta c \sigma_{f,B}} \simeq 1.33 \times 10^{14}\; \mathrm{s}\;\mathrm{cm}^{-3}\]

which is a good match with the loss time bound at \(\sim\) 1 GeV but is
larger at higher energies and does not depend on energy. For example at
1 TeV it is an order of magnitude larger:

\[ n_H\tau(1\; \mathrm{TeV}) \simeq 10^{14} 1000^{-0.3} \sim 1.3 \times 10^{13} \mathrm{\;s\;cm}^{-3}\]

\paragraph{Borom Escape}\label{borom-escape}

It could be that Borom escape the leaky box, but that time will be
\(\tau_{esc} = \frac{H}{c}\) which will be roughly:

\[\tau_{esc} = \frac{300\;\mathrm{pc}}{c} \simeq 3\times 10^{10}\; \mathrm{s}\]

which is too small compared to the effective lifetime found. This seems
to indicate that CR do not travel in straight lines. Let's assume that
the overall process is a convination of both the borom fragmentation and
another process with a lifetime \(T\). By summing the inverse of these
processes (being exponential processes):

\[\tau^{-1} =  n_H \beta c \sigma_{f,B} + T^{-1}\]

and solving for \(T\) we have that:

\[n_H T = \frac{n_H}{\frac{1}{\tau} - \frac{1}{\tau_{f,B}}} \simeq \frac{10^{14} \; \rm{s}\;\rm{cm}^{-3}}{\left(\frac{E}{\mathrm{GeV}}\right)^{-0.3} -0.7} \simeq 10^{14}\left(\frac{E}{\mathrm{GeV}}\right)^{-0.55} \rm{s}\;\rm{cm}^{-3}\]

There no other physical loss process for Boron, so \(T\) really must be
the escape of the galactic confinement (leaky box). But if the box has a
size \(H\), \(T_{esc}\) will be H/c which is the time required by CR
generated in the Galactic plane to escape the box of height \(H\)!
However we know that \(T \gg H/c\). So there must be something else
confining the CR in the galaxy\ldots{} what could it be?

\subsubsection{Dynamics of Charge Particles in Magnetic
Fields.}\label{dynamics-of-charge-particles-in-magnetic-fields.}

Before solving the problem what process in the Galaxy is confining the
cosmic-rays, let's review a bit the dynamics of charge particles in
magnetic fields.

Let's assume the simplest case of a test particle or mass \(m_0\) and
charge \(Ze\) and lorentz factor \(\gamma\) in an uniform static
magnetic field, \({\mathbf B}\).

\[\frac{d}{dt}(\gamma m_0 {\mathbf v}) = Ze ( {\mathbf v} \times {\mathbf B})\]

knowing the expression of \(\gamma\) we derive this:

\[
m_0\frac{d}{dt}(\gamma \mathbf{v}) = m_0\gamma\frac{d {\mathbf v}}{dt} + m_0\gamma^3 {\mathbf v}\frac{ \mathbf{v} \cdot {\mathbf a}}{c^2}\]

In a magnetic field the acceleration is always perpendicular to
\({\mathbf v}\) so \({\mathbf v\cdot a} = 0\) resulting in:

\[m_0\gamma\frac{d{\mathbf v}}{dt} =  Ze ( {\mathbf v} \times {\mathbf B})\]

This equation tell us that there is no change in the \(v_{\parallel}\)
the parallel component of the velocity and the aceleration is only
perpendicular to the magnetic field direction, \(v_{\perp}\). Beacuse
\({\mathbf B}\) is constant this results in a spiral motion around the
magnetic field. Now we are going to test what happens if the magnetic
field is not uniform.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial II: Motion of a charge particle in a slowly changing magnetic
field}\vspace{3mm}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ mpl\_toolkits.mplot3d }\ImportTok{import}\NormalTok{ Axes3D}

\NormalTok{q }\OperatorTok{=} \FloatTok{1.0}
\NormalTok{m }\OperatorTok{=} \FloatTok{10.0}
\NormalTok{dt }\OperatorTok{=} \FloatTok{1e{-}3}
\NormalTok{t0 }\OperatorTok{=} \DecValTok{0}
\NormalTok{t1 }\OperatorTok{=} \DecValTok{10}
\NormalTok{t2 }\OperatorTok{=} \DecValTok{20}


\NormalTok{t }\OperatorTok{=}\NormalTok{ np.linspace(t0, t2, }\BuiltInTok{int}\NormalTok{((t2 }\OperatorTok{{-}}\NormalTok{ t0)}\OperatorTok{/}\NormalTok{dt))}
\NormalTok{n }\OperatorTok{=} \BuiltInTok{len}\NormalTok{(t)}

\NormalTok{r }\OperatorTok{=}\NormalTok{ np.zeros((n,}\DecValTok{3}\NormalTok{))}
\NormalTok{v }\OperatorTok{=}\NormalTok{ np.zeros((n,}\DecValTok{3}\NormalTok{))}

\CommentTok{\#Initial conditions}

\NormalTok{r[}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ [}\FloatTok{0.0}\NormalTok{, }\FloatTok{0.0}\NormalTok{, }\FloatTok{0.0}\NormalTok{]}
\NormalTok{v[}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ [}\FloatTok{2.0}\NormalTok{, }\FloatTok{0.0}\NormalTok{, }\FloatTok{3.0}\NormalTok{]}

\CommentTok{\#B = array([0.0, 0.0, 5.0])}

\NormalTok{B }\OperatorTok{=}\NormalTok{ np.zeros((n,}\DecValTok{3}\NormalTok{))}
\NormalTok{B[}\DecValTok{0}\NormalTok{] }\OperatorTok{=}\NormalTok{ np.array([}\FloatTok{0.0}\NormalTok{, }\FloatTok{0.0}\NormalTok{, }\FloatTok{4.0}\NormalTok{])}
\NormalTok{dB }\OperatorTok{=}\NormalTok{ np.array([}\FloatTok{0.0}\NormalTok{, }\FloatTok{0.0}\NormalTok{, }\FloatTok{5e{-}3}\NormalTok{])}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(n}\OperatorTok{{-}}\DecValTok{1}\NormalTok{):}
\NormalTok{    a   }\OperatorTok{=}\NormalTok{ q}\OperatorTok{/}\NormalTok{m}\OperatorTok{*}\NormalTok{ np.cross(v[i],B[i]) }
\NormalTok{    v[i}\OperatorTok{+}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ v[i] }\OperatorTok{+}\NormalTok{ a}\OperatorTok{*}\NormalTok{dt}
\NormalTok{    r[i}\OperatorTok{+}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ r[i] }\OperatorTok{+}\NormalTok{ v[i}\OperatorTok{+}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{dt}
\NormalTok{    B[i}\OperatorTok{+}\DecValTok{1}\NormalTok{] }\OperatorTok{=}\NormalTok{ B[i] }\OperatorTok{+}\NormalTok{ dB}

\NormalTok{fig }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{8}\NormalTok{,}\DecValTok{8}\NormalTok{))}

\NormalTok{ax }\OperatorTok{=}\NormalTok{ fig.add\_subplot(}\DecValTok{111}\NormalTok{, projection}\OperatorTok{=}\StringTok{\textquotesingle{}3d\textquotesingle{}}\NormalTok{)}

\NormalTok{ax.plot(r[:,}\DecValTok{0}\NormalTok{], r[:,}\DecValTok{1}\NormalTok{], r[:,}\DecValTok{2}\NormalTok{])}

\NormalTok{ax.set\_xlabel(}\StringTok{"$x$"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{"$y$"}\NormalTok{)}
\NormalTok{ax.set\_zlabel(}\StringTok{"$z$"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap2_files/figure-pdf/cell-9-output-1.pdf}

\end{tcolorbox}

\subsubsection{Scattering in Plasma}\label{scattering-in-plasma}

The picture above holds while the gyroradius is larger or smaller than
the variation of the magnetic field. In the first case when
\(R_g \ll (\Delta B)\) the charge particle will follow the substructure
of the magnetic field. In the second case \(R_g \gg (\Delta B)\) the
magnetic field irregularities are transparent to the particle. However
when \(R_g \approx (\Delta B)\) then the particle \emph{sees} the
magnetic irregularities. In this case the particle will scattered almost
inelastically in this irregularities. The picture of a test-particle
moving in a magnetic field is a simplistic one. In reallity cosmic ray
particles propagate in collisionless, high-conductive, magnetized plasma
consisting mainly of protons and electrons and very often the energy
density of cosmic ray particles is comparable to that of the background
medium. As a consequence of that, the electromagnetic field in the
system is severely influenced by the cosmic ray particles and the
description is more complex than the motion of a test charged particle
in a fixed electromagnetic field. This will generate irregularities in
the magnetic field. The \textbf{irregularities in the Galactic magnetic
field} are responsible for the \textbf{diffusive propagation} of cosmic
rays.

\subsubsection{Diffusion of Cosmic Rays}\label{diffusion-of-cosmic-rays}

The results above leads to think that CR experience diffusion in the
galaxy. The equation that we used to relate the Boron production rate by
the Carbon spallation process can be seen as a diffuse equation.

In diffusion the continuity equation states that the variation of the
density \(N\) in time is given by its transfer of flux in area plus the
source contribution:

\[\frac{\partial N}{\partial t}= - \nabla \cdot \mathbf{J} + Q\]

where \(Q\) is intensity of any local source of this quantity and
\(\mathbf{J}\) is the flux.

\textbf{Fick's first law:} the diffusion flux is proportional to the
negative of the concentration gradient in an isotropic medium:

\[\begin{aligned}
\mathbf{J}&=-D \nabla N \\
J_i&=-D \frac{\partial N}{\partial x_i}
\end{aligned}\]

where the proporcionality constant, \(D\), is called diffusion
coefficient. Which leads to the diffusion equation of:

\[\frac{\partial N}{\partial t} =  D\Delta N + Q \]

where \(\Delta\) (or \(\nabla^2\)) is the Laplace operator.

In the Leaky Box model the diffusion equation, ignoring other effects,
can be written as:

\[\frac{\partial N_i}{\partial t} = D\Delta N_i =-\frac{N_i}{T_{esp}}\]

We made use of the fact that the escape probability is constant per unit
time (Poisson process) and so the distribution in time can be writen as:

\[N_i(t) = n_0 e^{-\frac{t}{T_{esc}}}\]

In the absent of collisions and other energy changing processes, the
distribution of cosmic ray path lengths can also be written as:

\[N_i(z) = n_0 e^{-\frac{z}{H}}\]

with \(z\) the travel distance in the z-axis and \(H\) the heigth of the
\emph{box}. Using both expressions of the cosmic ray distribution (in
time and in space), together with the diffusion formula above give us
equation:

\[T_{esp} = \frac{H^2}{D} \]

However we found from the B/C ratio that \(T_{esc} \propto E^{-\delta}\)
with \(\delta = 0.55\), therefore the diffusion coefficient is:

\[ D(E) \propto E^{\delta} \sim E^{0.55}\]

Note that physically \(D = D(z)\) ie, diffussion will depend on distance
to the disc, however in the leaky-box model we assumed that \(D\) is
independent of that, which it is only an approximation.

\subsubsection{The State-of-Art of
Diffusion}\label{the-state-of-art-of-diffusion}

The leaky box model is a very simplistic approximation but more
realistic diffusion models, such as the numerical integration of the
transport equation in the \href{https://galprop.stanford.edu/}{GALPROP}
code (Strong and Moskalenko 1998), lead to results for the major stable
cosmic-ray nuclei, which are equivalent to the Leaky-Box predictions at
high energy. However sofisticated models of transport should include
effects such as:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Diffusion coefficient non spatially constant.
\item
  Anisotropic diffusion (Parallel vs Perpendicular)
\item
  Effect of self-generation waves induced by CR.
\item
  Damping of waves and its effects in CR propagation
\item
  Cascading of modes in wavenumber space
\end{enumerate}

Each of these effects might change the predicted spectra and CR
anisotropies in significant ways.

\subsubsection{Transport Equation on Primary Cosmic
Rays}\label{transport-equation-on-primary-cosmic-rays}

The general simplified transport/dissusion equation that relate the
abundances of CR elements can be given by:

\[\frac{\partial N_i(E)}{\partial t} =\frac{N_i(E)}{T_{esc}(E)} = Q_i(E) - \left(\beta c n_H \sigma_i + \frac{1}{\gamma\tau_i}\right)N_i(E) + \beta c n_H \sum_{k\ge i}\sigma_{k\rightarrow i}N_K(E)\]

where now \(Q_i(E)\) is the \textbf{local production rate by a CR
accelerator}, the middle part reprensents the \textbf{losses due to
interactions} with cross-section \(\sigma_i\) and \textbf{decays for
unestable nuclei} with lifetime \(\tau_i\). The last term is the
\textbf{feed-down production} due to spallation processes of heavier CR.
We can simplified this equation depending if we are dealing with Primary
or Secondary CR:

\begin{itemize}
\tightlist
\item
  Primaries \(\rightarrow\) neglect spallation feed-down.
\item
  Secondaries \(\rightarrow\) neglect production by sources: \(Q_s = 0\)
\end{itemize}

For example, let's assume now a primary CR, \(P\), where feed-down
spallation is not taking place (ie, they are not product of heavier CR)
and no decay (most nuclei are stable, one exception is \(^{10}\)Be which
is unstable and \(\beta\)-decay), the equation can be written as:

\[\frac{N_P(E)}{T_{esc}(E)} = Q_P(E) - \frac{\beta c \rho_H N_P(E)}{\lambda_P(E)} \rightarrow N_P(E) = \frac{Q_P(E)}{\frac{1}{T_{esc}(E)}+\frac{\beta c \rho_H}{\lambda_P(E)}}\]

where we wrote \(n_H = \rho_H/m\) and \(\lambda_P\) is the mean free
path in \(\mathrm{ g / cm}^2\).

While \(T_{esc}\) is the same for all nuclei with same rigidity,
\(\lambda_i\) is different and depends on the mass of the nucleus. The
equation suggests that at low energies the spectra for different nuclei
will be different (eg for Fe interaction dominates over escape) and will
be parallel at high energy if accelerated on the same source. For proton
with interaction lengths \(\lambda_{proton} \gg \lambda_{esc}\) at all
energies so the transport equation gets simplified to:

\[N_{p}(E) = Q_p(E)\cdot T_{esc}(E)\]

ie, we observe at Earth a proton density of
\(N_p(E)\propto E^{-(\gamma +1)} \sim E^{-2.7}\), and \(T_{esc}(E)\)
goes with the inverse of the diffusion coefficient \(D(E)\), ie
\(T_{esc}(E) \propto E^{-\delta}\), then at the production site the
spectrum must follow \(Q_p(E) \propto E^{-\alpha}\) with:

\[\alpha = (\gamma + 1) -\delta \approx 2.1\]

\subsection{Acceleration of Galatic Cosmic
Rays}\label{acceleration-of-galatic-cosmic-rays}

Three questions:

\begin{itemize}
\tightlist
\item
  What is the source of power?
\item
  What is the actual mechanism?
\item
  Can it reproduce the spectral index found? \#\#\# Energy density of
  galactic cosmic-rays
\end{itemize}

In cosmic ray physics we called spectrum to the flux per stero radian,
so the relationship between them is:

\[\Phi (E) = \int_\Omega \mathrm{ d} \Omega I(E) = 4\pi I(E)\]

For all-hemispheres. So we can relate the number density of CR with the
spectrum by:

\[n(E) = \frac{4\pi}{v}I(E)\]

since the flux is just the number density times the velocity.

And so \textbf{kinetic energy density} of CR, \(\rho_{CR}\) is therefore
the integral of the \textbf{energy density spectrum}, \(E\cdot n(E)\):

\[\rho_{CR} = \int E n(E) \mathrm{ d} E =4\pi \int \frac{E}{v}I(E) \mathrm{ d} E\]

assuming for the Galactic CR (and that \(v = c\) for relativistic
particles):

\[ I(E) \approx 1.8 \times 10^4 \left(\frac{E}{1\; \mathrm{GeV}}\right)^{-2.7} \frac{\mathrm{nucleons}}{\mathrm{m}^2\; \mathrm{s\;sr\;GeV}}\]

we can calculate the energy density for cosmic-rays from above the solar
modulations up the \emph{knee}, which is given by:

\[ \rho_{CR} = \frac{4\pi}{c} \frac{1.8}{1 - 1.7} \left[\left(\frac{E_{max}}{1\;\mathrm{GeV}}\right)^{1 -1.7} - \left(\frac{E_{min}}{1\;\mathrm{GeV}}\right)^{1 -1.7}\right] \approx 1\; \mathrm{ev\;cm}^{-3}\]

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ scipy.constants }\ImportTok{as}\NormalTok{ cte}
\ImportTok{from}\NormalTok{ astropy.constants }\ImportTok{import}\NormalTok{ pc}

\NormalTok{cspeed }\OperatorTok{=}\NormalTok{ cte.value(}\StringTok{"speed of light in vacuum"}\NormalTok{) }\OperatorTok{*} \FloatTok{1e2} \CommentTok{\# in cm/s}

\NormalTok{emin }\OperatorTok{=} \FloatTok{1.} \CommentTok{\#GeV}
\NormalTok{emax }\OperatorTok{=} \FloatTok{1e5} \CommentTok{\# 100 TeV}
\NormalTok{rho }\OperatorTok{=} \DecValTok{4} \OperatorTok{*}\NormalTok{ np.pi }\OperatorTok{/}\NormalTok{cspeed }\OperatorTok{*} \FloatTok{1.8} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{{-}} \FloatTok{1.7}\NormalTok{) }\OperatorTok{*}\NormalTok{ (np.power(emax,}\DecValTok{1}\OperatorTok{{-}}\FloatTok{1.7}\NormalTok{) }\OperatorTok{{-}}\NormalTok{ np.power(emin,}\DecValTok{1}\OperatorTok{{-}}\FloatTok{1.7}\NormalTok{)) }\OperatorTok{*} \FloatTok{1e9} \CommentTok{\# in ev cm{-}3}

\BuiltInTok{print}\NormalTok{(}\VerbatimStringTok{r"The energy density is $\textbackslash{}rho\_}\SpecialCharTok{\{CR\}}\VerbatimStringTok{ \textbackslash{}approx }\SpecialCharTok{\%.2f}\VerbatimStringTok{$ $\textbackslash{}mathrm\{ ev/cm\}\^{}}\SpecialCharTok{\{3\}}\VerbatimStringTok{$"} \OperatorTok{\%}\NormalTok{rho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
The energy density is $\rho_{CR} \approx 1.08$ $\mathrm{ ev/cm}^{3}$
\end{verbatim}

This energy density is comparable with the energy density of the CMB
\(\rho_{CMB} \approx 0.25\) eV/cm\(^{3}\)

\subsubsection{Required Power for Galactic Cosmic
Rays}\label{required-power-for-galactic-cosmic-rays}

If we assume this value to be the constant value over the galaxy, the
power required (called \emph{luminosity} in astrophysics) to supply all
the galactic CR and balance the escape processes is:

\[\mathcal{L}_{CR} = \frac{V_D \rho_{CR}}{\tau_{esc} }\sim 4\times 10^{40} \mathrm{\;erg\;s}^{-1}\]

where \(V_D\) is the volume of the galactic disk

\[V_D = \pi R^2 d \sim \pi (15 \mathrm{\;kpc})^2(300 \mathrm{\;pc}) \sim 6 \times 10^{66} \mathrm{\;cm}^3.\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{R }\OperatorTok{=} \DecValTok{15000} \OperatorTok{*}\NormalTok{ pc.to(}\StringTok{"cm"}\NormalTok{).value }\CommentTok{\# radius in Cm}
\NormalTok{h }\OperatorTok{=} \DecValTok{300} \OperatorTok{*}\NormalTok{ pc.to(}\StringTok{"cm"}\NormalTok{).value}
\NormalTok{Vd }\OperatorTok{=}\NormalTok{ np.pi }\OperatorTok{*}\NormalTok{ R }\OperatorTok{**}\DecValTok{2} \OperatorTok{*}\NormalTok{ h}
\BuiltInTok{print}\NormalTok{(}\VerbatimStringTok{r"Galactic Volume is }\SpecialCharTok{\%.1e}\VerbatimStringTok{ $\textbackslash{}mathrm\{ cm\}\^{}\{{-}3\}$"} \OperatorTok{\%}\NormalTok{Vd)}
\NormalTok{evtoerg }\OperatorTok{=}\NormalTok{ cte.value(}\StringTok{"electron volt{-}joule relationship"}\NormalTok{) }\OperatorTok{*} \FloatTok{1e7} 
\NormalTok{tesc }\OperatorTok{=} \FloatTok{1e14} \CommentTok{\# s cm\^{}3 at 1 GeV}
\NormalTok{tesc }\OperatorTok{=}\NormalTok{ tesc}\OperatorTok{/}\FloatTok{0.1} \CommentTok{\# s}
\NormalTok{power }\OperatorTok{=}\NormalTok{ (Vd }\OperatorTok{*}\NormalTok{ rho) }\OperatorTok{*}\NormalTok{ evtoerg }\OperatorTok{/}\NormalTok{ tesc}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Power L \textasciitilde{} }\SpecialCharTok{\{}\NormalTok{power}\SpecialCharTok{:.2e\}}\SpecialStringTok{ erg /s"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Galactic Volume is 6.2e+66 $\mathrm{ cm}^{-3}$
Power L ~ 1.08e+40 erg /s
\end{verbatim}

It was emphasized long ago (Ginzburg \& Syrovatskii 1964) that
supernovae might account for this power. For example a type II supernova
gives an average power output of:

\[\mathcal{L}_{SN} \sim 3 \times 10^{42} \mathrm{\;erg\;s}^{-1}\]

Therefore if SN transmit a few percent of the energy into CR it is
enough to account for the total energy in the cosmic ray beam. That was
called the \textbf{SNR paradigm}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-important-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-important-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Power Required for \textgreater{} 100 TeV}]

The derivation above was considered using the CR flux with an integral
spectral index of \(\gamma = \alpha -1 =  1.7\) which describes well the
CR up to the \emph{knee} (See Section~\ref{sec-knee}). This is the bulk
of cosmic ray density. The power required for the high energy part will
be significantly less due to the steeply falling primary cosmic ray
spectrum. For example assuming an integral index of \(\gamma = 1.6\) for
\(E < 1000\) TeV and \(\gamma = 2\) for higher energy we get:

\[\begin{aligned}
\sim 2 \times 10^{39} {\;\rm\;erg/s\; for\; } E &> 100 \mathrm{\; TeV}\\
\sim 2 \times 10^{38} {\;\rm\;erg/s\; for\; } E &> 1 \mathrm{\;PeV}\\
 \sim 2 \times 10^{37} {\;\rm\;erg/s\; for\; } E &> 10 \mathrm{\;PeV}
 \end{aligned}\] ` which are considerably less than the total power
required for all the cosmic-rays. This power might be available from a
few very energetic sources.

\end{tcolorbox}

\subsubsection{Fermi Acceleration}\label{fermi-acceleration}

Fermi studied how it is posible to transfer macroscopic kinetic energy
of moving magnetized plasma to individual particles. He considered an
iterative process in which for each \emph{encounter} a particle gains
energy which is proportional to the energy.

Let's write the increase in energy as \(\Delta E = \xi E\) after \(n\)
encounters then:

\[E_n = E_0(1 + \xi)^n\]

where \(E_0\) is the injection energy in the \emph{acceleration region}.
If the probability of escaping this \emph{acceleration region} is
\(P_{esc}\) per \emph{encounter}, after \(n\) the remaining probability
is \((1 - P_{esc})^n\). To reach a given energy \(E\) we need:

\[n = \log\left(\frac{E_n}{E_0}\right)/\log(1 + \xi)\]

after each interaction there is a fraction \((1-P_{esc})\) that remain
and the rest escapes the accelerator. If \(N_0\) particles entered the
``encounter'' in the first place, after \(n\) interaction those
remaining are:

\[N(\ge  E_n) = N_0(1- P_{esc})^n\]

These particles will always eventually escape since \(P_{esc}\) is not
0, but for any given number of cycles, \(n\), we can be sure that those
remaining particles (whenever they escape) will have more energy than
those that escaped at the cycle \(n\). We can rewrite:

\[\log\left(\frac{N}{N_0}\right) = n(1 - P_{esc}) \]

equalling \(n\) with the equation above we have:

\[\frac{\log (N/N_0)}{\log (E_n/E_0)} = \frac{\log(1-P_{esc})}{\log(1+ \xi)}\]

For any given energy then we have:

\[N(\ge E) = N_0 \left(\frac{E}{E_0}\right)^{-\gamma}\]

where we defined

\[\gamma = \log\left(\frac{1}{1-P_{esc}}\right)\frac{1}{\log (1+\xi)} \approx \frac{P_{esc}}{\xi} = \frac{1}{\xi}\cdot\frac{T_{cycle}}{T_{esc}}\]

where \(T_{cycle}\) is the characteristic time of acceleration cycle,
and \(T_{esc}\) is the characteristic time to escape the acceleration
region.

Note that \(N(\ge E)\) is the integral spectrum, the differntial
spectrum is given by:

\[ n(E) \propto E^{-1 - \gamma} \]

\paragraph{Fermi Mechanism}\label{fermi-mechanism}

A mechanism working for a time \(t\) will produce a maximum energy:

\[E\leq E_0 (1+\xi)^{t/T_{cycle}}\]

Two characteristic features are apparent from this equation:

\begin{itemize}
\tightlist
\item
  High energy particles take longer to accelerate
\item
  If a given kind of Fermi accelerator has a limited lifetime this will
  be characterize by a maximum energy per particle that can produce. In
  the general mechanism we can imagine a particle encountering something
  moving at a speed \(\beta\). This ``something'' can be for example a
  magnetic cloud.
\end{itemize}

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/fermi_general.jpeg}
\end{center}

In this general approach, the particle might enter at different angles
and exit at difference angles. Let's assume \(O^\prime\) to be the
reference system where the magnetic cloud is in the rest frame. A
particle with energy \(E_1\) in the lab reference system will have total
energy in this reference system given by the boost transformation with
\(\beta\) being the speed of the plasma flow (cloud:

\[E_1^\prime = \gamma E_1 (1 -\beta \cos\theta_1)\]

Before leaving the gas cloud the particle has an anegy \(E_2^\prime\).
If we transform this back to the lab reference system we get:

\[E_2 = \gamma E_2^\prime (1 +\beta \cos\theta_2^\prime)\]

As the particle suffers from colissioness scatterings inside the cloud
the energy in the moving frame just before it escapes is
\(E_2^\prime = E_1^\prime\) and so we can calculate the increment in
energy \(\Delta E = E_2 - E_1\) as:

\[\xi = \frac{\Delta E}{E_1}  = \frac{1 - \beta \cos \theta_1 + \beta\cos\theta_2^\prime - \beta^2\cos\theta_1\cos\theta_2^\prime}{1 - \beta^2} -1\]

\paragraph{Fermi 2nd Order
Acceleration.}\label{fermi-2nd-order-acceleration.}

In the \textbf{second order} (first chronologically) Fermi considered
\emph{encounters} with moving clouds of plasma.

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/Fermi2nd.jpg}
\end{center}

\begin{itemize}
\item
  The scattered angle is uniform so the average value is
  \(\langle \cos\theta_2^\prime\rangle = 0\).
\item
  The probability of collision at angle \(\theta\) with the cloud of
  speed V is proportional to the relative velocity between the cloud and
  the particle \(c\) if we assume it relativistic (factor \(1/2\) is
  there to have a proper normalization):
\end{itemize}

\[\frac{dn}{d\cos \theta_1} = \frac{1}{2}\frac{c - V\cos\theta_1}{c}=\frac{1 -\beta \cos\theta_1}{2}, {\;\; \rm for -1 \leq \cos\theta_1 \leq 1}\]

and so:

\[\langle \cos\theta_1\rangle = \frac{\int \cos\theta_1 \cdot \frac{dn}{d\cos\theta_1} d\cos\theta_1}{\int \frac{dn}{d\cos\theta_1}d\cos\theta_1} = - \frac{\beta}{3}\]

Particles can gain or lose energy depending on the angles, but on
average the gain is

\[\xi = \frac{1 + \frac{1}{3}\beta^2}{1 - \beta^2} \sim \frac{4}{3}\beta^2\]

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-important-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-important-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Problems wih the 2nd order acceleration}]

\begin{itemize}
\tightlist
\item
  The energy increase is second order of \(\beta\) and..
\item
  \ldots{} the random velocities of clouds are relatively small:
  \(\beta \sim 10^{-4}\) !!!
\item
  Some collisions result in energy losses! Only with the average one
  finds a net increase.
\item
  Very little chance of a particle gaining significant energy!
\item
  The theory does not predict the power law exponent
\end{itemize}

\end{tcolorbox}

\paragraph{Fermi 1st Order
Acceleration.}\label{fermi-1st-order-acceleration.}

Let's imagine a shock moving through a plasma. In the reference system
of the \emph{unshocked} plasma the shock front approaches with speed
\(\vec{u_1}\) while the \emph{shocked} plasma (left behind) moves at a
slower velocity \(\vec{V}\) where \(|V| < |u_1|\). If we now changed to
the reference system where the shock-front is at rest the gas
\emph{unshocked} now appears to approach speed \(-\vec{u_1}\) while the
\emph{shocked} plasma recedes with speed
\({-\vec u_2 = (\vec{V} - \vec u_1)}\). A test cosmic ray particle
crossing from any side of the shock, will always face an encounter with
plasma aproaching at speed \(|V|\), hence \(\beta\) now refers to this
speed, the speed of the shocked (downstream) gas in the upstream
reference system.

\begin{figure}

\begin{minipage}{0.33\linewidth}

\centering{

\includegraphics{images/fermi-us-ref.jpg}

}

\subcaption{\label{fig-fermi-upstream}Upstream}

\end{minipage}%
%
\begin{minipage}{0.33\linewidth}

\centering{

\includegraphics{images/fermi-sw-ref.jpg}

}

\subcaption{\label{fig-fermi-sockwave}Shockwave}

\end{minipage}%
%
\begin{minipage}{0.33\linewidth}

\centering{

\includegraphics{images/fermi-ds-ref.jpg}

}

\subcaption{\label{fig-fermi-downstream}Downstream}

\end{minipage}%

\caption{\label{fig-fermi1st}Fermi first order acceleration. Different
referenec systems.}

\end{figure}%

\begin{itemize}
\tightlist
\item
  The outcoming distribution of particles is not now 0, there is an
  asymmetry in the Fermi shock acceleration model, as particle in the
  upstream will re-enter the shock, only those going downstream can
  escape. Therefore the distribution follows the projection of an
  uniform flux on a plane:
\end{itemize}

\[\frac{dn}{d\cos \theta_2^\prime} = 2 \cos\theta_2^\prime{\;\; \rm for\;  0 \leq \cos\theta_2^\prime \leq 1}\]

which gives:

\[\langle \cos\theta_2^\prime\rangle = \frac{\int \cos\theta_2^\prime \cdot \frac{dn}{d\cos\theta_2^\prime} d\cos\theta_2^\prime}{\int \frac{dn}{d\cos\theta_2^\prime}d\cos\theta_2^\prime} = \frac{2}{3}\]

\begin{itemize}
\tightlist
\item
  The incoming angle distribution is also the projection of an uniform
  flux on a plen but this time with \(-1 \leq \cos\theta_1 \leq 0\) and
  so \(\langle \cos \theta_1 \rangle = -2/3\)
\end{itemize}

Particles entering the shockwave and exiting will have a gain of:

\[\xi = \frac{1 + \frac{4}{3}\beta + \frac{4}{9}\beta^2}{1 -\beta^2} - 1 \sim \frac{4}{3}\beta = \frac{4}{3}\frac{u_1 - u_2}{c}\]

\paragraph{Escape Probability}\label{escape-probability}

The escape probability of loss rate of particles is given by the ratio
of the incoming flux and the outgoing flux of particles.

\begin{itemize}
\tightlist
\item
  \textbf{Incoming rate.} Let's assume that the diffusion of particles
  is so effective that close to the shockwave the distribution of
  particles is isotropic. In this case the rate of encounters for a
  plane shock is the projection of an isotropic flux onto the plane
  shock. Let's assume \(n\) to be the density of particles close to the
  shock, because it is isotropic it should follow:
\end{itemize}

\[\mathrm{ d}n = \frac{n}{4\pi}\mathrm{ d}\Omega\]

assuming the particles moving at relativistic speed, the velocity across
the shock is \(c\cos\theta\) therefore the rate of encounters of
particles upstream with the shock is given by:

\[R_{in} = \int \mathrm{ d} n c \cos\theta = \int_0^1 \mathrm{ d} \cos \theta \int_0^{2\pi} \mathrm{ d} \phi\frac{cn(E)}{4\pi}\cos\theta = \frac{cn(E)}{4}\]

where \(n(E)\) is the CR number density.

\begin{itemize}
\tightlist
\item
  \textbf{Outgoing rate.} The outgoing rate is simply the number of
  particles escaping the system. In the shock rest frame, that's all
  particles not returning to the shockwave. In this reference system
  there is an outflow of cosmic-rays adverted downstream. Since
  particles are diffusing in all direction, the net outflow goes with
  the velocity of the downstream speed and is given simply by
  \(R_{out} = n(E) u_2\),
\end{itemize}

Therefore the escape probability is given by:

\[P_{esc} = \frac{R_{in} }{R_{out} }= \frac{4 u_2}{c}\]

which for acceleration at shock gives:

\[\gamma = \frac{P_{esc}}{\xi} = \frac{3}{u_1/u_2 -1}\]

So we get an estimate of the spectral index based on the relative
velocities of the downstream and upstram gas in the sockwave.

\subsubsection{Kinematic Relations at the
Shock}\label{kinematic-relations-at-the-shock}

In order to derive the exact value of the spectral index we need to
obtain a relation between \(u_1\) and \(u_2\) using the kinematics of a
shock wave. This equations are the conservation of mass, the Euler
equation for momentum conservation and conservation of energy:

\begin{itemize}
\item
  \textbf{Conservation of mass}:
  \[\partial_t \rho + \nabla \cdot (\rho\vec{u}) = 0\]
\item
  \textbf{Conservation of momentum (Euler equation)}:
\end{itemize}

\[\rho\frac{\partial \vec{u}}{\partial t} + \rho \vec{u} \cdot(\nabla\vec{u}) = \vec{F} - \nabla P\]

where \(\vec{F}\) is an external force, and \(\nabla P\) is a force due
to a pressure gradient.

\begin{itemize}
\tightlist
\item
  \textbf{Conservation of energy}:
\end{itemize}

\[\frac{\partial}{\partial t} \left(\frac{\rho u^2}{2} + \rho U + \rho\Phi\right) + \nabla\cdot\left[\rho \vec{u}\left(\frac{u^2}{2} + U + \frac{P}{\rho} + \Phi\right)\right] = 0 \]

where this equation accounts for the kinetic, internal, and potential
energy \(\Phi\).

Let's assume a one-dimensional, steady shock in its rest frame
(otherwise time derivates must be taking into account).

Then the first equation becomes simply: \[\frac{d}{dx} (\rho u) = 0\]

and the Euler equation simplifies to:

\[\frac{d}{dx}(P + \rho u^2) = 0\]

In the energy equation we assume \(\Phi = 0\):

\[\frac{d}{dx}\left(\frac{\rho u^3}{2} + (\rho U + P)u\right) = 0 \]

\[\frac{d}{dx}\left[ \rho u \left(\frac{u^2}{2} + U + \frac{P}{\rho}\right) \right] = 0 \]

where U is the internal density per unit volume and we can write \$
\rho U = \frac{P} \{\Gamma -1\}\$, where \(\Gamma = c_p/c_v\) is the
\href{http://en.wikipedia.org/wiki/Heat_capacity_ratio}{adiabatic index}
or heat capacity ratio.

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-important-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-important-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Conditions of discontinuity at the shochwave}]

Let's assume we are in the shock ref system. Applyting these equations
at the discontinuity of the shock we have the three conditions at the
discontinuity of the shock:

\[\begin{aligned}
\rho_1 u_1 &= \rho_2 u_2\\
P_1 + \rho_1 u_1^2 &= P_2 + \rho_2 u_2^2\\
\frac{\rho_1 u_1^2}{2} + \frac{\Gamma}{\Gamma - 1} P_1 &=\frac{\rho_2 u_2^2}{2} + \frac{\Gamma}{\Gamma - 1}  P_2\\
\end{aligned}\]

\end{tcolorbox}

For a gas with \(P = K \rho^\Gamma\) the speed of sound can be written
as \(c_s = \sqrt{\Gamma P / \rho}\) or \(\rho c_s^2 = \Gamma P\). From
the second condition we can write:

\[ P_1 + \rho_1 u_1^2 =  \rho_1 u_1^2 \left( 1 + \frac{P_1}{\rho_1 u_1^2}\right)  = \rho_1 u_1^2 \left( 1 + \frac{c_s^2}{\Gamma u_1^2}\right) = \rho_1 u_1^2 \left(1 + \frac{1}{\mathcal{M_1}\Gamma}\right) \]

For strong shocks \(\mathcal{M_1} \gg 1\) then the presure in the
upstream is neglicable \(P_1 \sim 0\)

We can isolate \(\rho_2\) and \(P_2\) as:

\[\rho_2 = \frac{u_1}{u_2} \rho_1\]

\[P_2 = P_1 + \rho_1 u_1^2 - \rho_1 \frac{u_1}{u_2}u_2^2 = P_1 + \rho_1 u_1 (u_1 - u_2) \sim \rho_1 u_1 (u_1 - u_2)\]

Using these expression ot eliminate \(\rho_2\) and \(P_2\) from the
third (enegy conservation) equation we have:

\[\frac{1}{2}u_1^2 = \frac{1}{2}u_2^2 + \frac{\Gamma}{\Gamma -1}\frac{P_2}{\rho_2} = \frac{1}{2}u_2^2 + \frac{\Gamma}{\Gamma -1} u_2 (u_1 - u_2)\]

grouping by powers of \(u_2\):

\[\left(\frac{\Gamma}{\Gamma -1} - \frac{1}{2}\right) u_2^2 - \frac{\Gamma}{\Gamma -1} u_2u_1 + u_1^2 = 0 \]

multiplying by \(2/u_1^2\):
\[\left(\frac{\Gamma + 1 }{\Gamma -1}\right) t^2 - \frac{2\Gamma}{\Gamma -1} t + 1 = 0\]

where we defined \(t \equiv u_2/u_1\) this quadratic equation has the 2
solutions:

\[ t = 1 \rightarrow u_1 = u_2\]

ie, no shock at all, and a second solution given by:

\[ t = \frac{\Gamma - 1}{\Gamma + 1} \rightarrow \frac{u_2}{u_1} = \frac{\Gamma - 1}{\Gamma +1}\]

for a monatomic gas with 3 degrees of freedom the ratio of specific
heats is \(\Gamma = 1 + 1/f = \frac{5}{3}\), so

\[\frac{u_2}{u_1} = \frac{1}{4}\]

No matter how strong a shock wave is, a mono-atomic gas can only be
compressed by a factor of 4. The spectral index is then:

\[\gamma = \frac{P_{esc}}{\xi} = \frac{3}{u_1/u_2 -1} = 1\]

If one keeps the factors of \(1/\mathcal{M}^2\) (to prove if you are
brave):

\[\gamma \sim 1 + \frac{4}{\mathcal{M}^2} \sim 1.1\]

Which matches remarkably to what we derived to be the differential
spectral index at the accelerator:

\[ n(E) \propto E^{-(\gamma+1)} \sim E^{-2.1} \]

\paragraph{Maximum Energy}\label{maximum-energy}

In an infinite planar shockwave, all particles upstream will encounter
again the shochwave. However particles can advent downstream. In diffuse
shock accelerations, particules will diffuse travelling a distance
\(l_D\) upstream, until they are reached by the shock moving at spead
\(u_1\) in the upstream reference system. Particles will cross when:

\[\begin{aligned}
l_d &\simeq \sqrt{D t_d} \\
l_d &= u_1 t_d \\
t_d &\approx \frac{D}{u_1^2}
 \end{aligned}\]

Assuming a diffusion that depends on energy in the form of
\(D = D_0 E^{\alpha}\) we can get that the maximum energy corresponds
to:

\[E_{max} \leq \left(\frac{u_1^2 t_d}{D_0}\right)^{\frac{1}{\alpha}}\]

where we can assume \(t_d\) to be the time during which the mechanism is
working, ie the livetime of the shockwave \(t_d \sim t_{age}\). From the
equation above we can conclude that the maximum energy:

\begin{itemize}
\tightlist
\item
  increases with time
\item
  depends on: age, shock speed, magnetic field intensity and structure
  (through D)
\item
  is not universal
\item
  \(D\) and therefore \(l_d\) increases with energy, and the each cycle
  energy increases, so the last cycle is the longest
\end{itemize}

We can rewrite the diffusion coefficient as:
\[ D \sim \frac{l_d^2}{t_d} = l_d v \] where \(v\) is the particle
speed. A more detailed analysis gives \(D = \frac{1}{3}l_d v\) where the
factor 3 comes from the 3 dimensions. In other words, the diffussion
coefficient can be understood as the product of the particle velocity
\(v \simeq c\) and its mean free path. At high energies, the mean free
path between scatterings in the turbulent magnetic clous can be
approximate as \(l_d = r_L/r_0\), where \(r_0\) is the size of the
magnetic cloud and \(r_L\) the Larmor radius of the particle. Assuming
that \(r_L \gg r_0\) we can re-write:

\[ D = \frac{r_L c}{3} \sim \frac{1}{3}\frac{E c}{Z eB} \]

Another way to see this, is to assume that mean diffusion path \(l_d\)
cannot be smaller than the Larmor radius, since a magnetic field
irregularities in a smaller scale than the Larmor radisu will be
transparent. This is the regime of the Bohm diffusion and it is possible
in higly turbulent magnetic fields, something that theoreticians think
is possible when CR excite magnetic turbulence at shocks while being
accelerated. This is called magnetic field amplification.

In that case, the diffusion coefficient depends linearly with energy
(\(\alpha = 1\)) and the equation above can be rewritten as:

\[E_{max} \leq 3 \frac{u_1}{c} Z e B (u_1 t_{age})\]

where \(t_{age}\) is the time in which the accelerator is working. Note
that the product \((u_1 t_{age})\) is the radius of a expanding shell.
Using some estimates on the time (\(t_{age} \sim\) 1000 yrs as the
typical SN shockwave) and \(B_{ISM} \sim 3 \mu\)G we can rewrite the
maximum energy for SN shockwaves as:

\[E_{max} \leq Z\times 3 \times 10^4 \mathrm{ GeV}\]

In order words, the shock-wave acceleration shown can accelerate CR
\textbf{up to 100 Z TeV}, but not beyond this. Other acceleration
mechanism are needed for the highest energy cosmic rays. We need very
high magnetic fields (non-lineal acceleration mechanism). In these
cases, even if this object cannot supply the all the galactic cosmic
rays the energy per particle may be orders of magnitude higher than
those possible in shock acceleration by blast waves.

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Hillas Criteria}]

The equation of the maximum energy from shock acceleration can be
rewritten as:

\[E_{max} \leq 10^{18} \mathrm{eV}\; Z \;\beta_s \left(\frac{R}{\mathrm{kpc}}\right)\left(\frac{B}{\mu\mathrm{G}}\right)\]

where \(\beta_s\) is the shock velocity, \(B\) the magnetic field
strength, and \(R = u_1 t_{age}\) is the radius of the expanding
shockwave, or in other words the size of the acceleration reguin. In
1984 Hillas arrived to a similar conclusion just by doing a
back-of-an-envelope assumption that in order for it to accelerate CR
particles to high energies in which he impossed that a condition where
the size of the acceleration region must be at least twice the Larmor
radius. The plot showing possible sources in the parameter space \(B\)
vs \(R\) is usually referred as the Hillas' plot. For relativistic
shockwaves (\(\beta_s \sim 1\)) many sources are able to accelerate
protons up to \(10^{20}\) eV, however for slower shockwaves
(\(\beta_s \sim 1/300\)) the number of source candidates is strongly
reduced.

\begin{center}
\includegraphics[width=0.7\textwidth,height=\textheight]{images/Hillas_plot.png}
\end{center}

\end{tcolorbox}

\subsection{Sources of Galactic Cosmic
Rays}\label{sources-of-galactic-cosmic-rays}

\subsubsection{Supernova Remnants (SNRs)}\label{supernova-remnants-snrs}

\textbf{Supernova remnants (SNR)} remain the most likely candidates for
CR acceleration up to at least \(10^{14} \mathrm{ \; eV}\) via the Fermi
shock mechanism. Supernova explosions are very violent events which
transfer a significant amount of energy in the ISM. The explosion
mechanism can be the carbon deflagration of white dwarts (Type I) or the
core collapse of masssive stars (Type II) but the dynamical evolution of
the supernova remnant (SNR) i.e., the expanding cloud of hot gas in the
ISM is similar:

\begin{itemize}
\item
  \textbf{Free Expansion Phase.} \(M_{ej} \ll M_{sw}\) The shock wave
  moves in the ISM gas a highly supersonic speed. The shock radius
  scales as: \(R_s(t) = v_e t\). Behind the shockfront ISM gas starts to
  accumulate an a reverse shock starts to form. Sometimes we see first
  this reverse shock. At some point the compressed ISM gas equals the
  ejected material, this marks the end of the free expansion phase. It
  last less than 200-300 years.
\item
  \textbf{Sedov-Taylor Phase.} Once the reverse shock reaches the
  nucleus, the interior of the SNR gets very hot that energy losses due
  to radiation are not possible (all atoms are ionized). The cooling of
  the gas is only due to the expansion, that's why this phase is the
  adiabatic phase. The radius goes as \(R \propto t^{2/5}\). When
  temperature reaches the critical value of \(10^{6}\) K ionized atoms
  start to capture free electrons and can lose energy due to
  de-exitation. This is the end of the adiabatic phase. This phase can
  last 20,000 years.
\item
  \textbf{Cooling or Snowplough phase} Due to the effective radiative
  cooling the thermal presure decreases and the expansion slows down.
  More and more interstellar gas is accumulated until the swept-up mass
  is much larger than the ejected material. Finally the shell breaks up
  into clumps probably due to Rayleigh-Taylor inestabilities. This phase
  lasts up to 500,000 years.
\end{itemize}

As we discussed, the \(E_{max}\) depends on how long the accelerator is
active. Therefore an individual CR particel will gain the highest energy
if it starts during the free expansion phase and stays with the shock
front until and through the Sedov phase. There is a caveat, though, the
\(E_{max}\) also depends on the magnetic field, and magnetic fields
during the slow expansion of he Sedov phase are not strong enough to
confine the CR particle. In this case, it seems the maximum CR energy
may only be reached during the pre-Sedov expansion. This is the reason
why young SNR are the main candidates to search for CR injection up to
PeV energies.

\subsubsection{Other Sources of Galactic Cosmic
Rays}\label{other-sources-of-galactic-cosmic-rays}

\begin{itemize}
\item
  \textbf{Neutron stars} Neutron stars, especially young fast-rotating
  pulsars and magnetars have extreme magnetic fields (up to \(10^{12}\)
  G in the case of magnetars) with complex structure that could
  accelerate CR up to the highest energies. These objects are far rarer
  than SNRs, however, only a dozen magnetars are known in the Milky Way,
  although many could exist in the local neighborhood.
\item
  \textbf{Microquasars} are radio-intense X-ray binary stars with
  companion orbiting an accreting black hole. They are particularly
  interesting particle accelerators due to observation of VHE gamma ray
  emission and highly relativistic jets which could provide energy for
  UHECR
\end{itemize}

\section{Extra-Galactic Cosmic Rays: The Knee and
Beyond}\label{extra-galactic-cosmic-rays-the-knee-and-beyond}

\subsection{The Knee}\label{sec-knee}

At energies of about 5 \(\times 10^{15}\) eV a steepening in the
spectrum from \(\gamma \sim 1.7 \rightarrow \gamma \sim 2\) known as the
\emph{knee} takes place. Already Peters in 1959 concluded that it could
be due to:

\begin{itemize}
\tightlist
\item
  Consequence of the breakdown of an acceleration mechanism.
\item
  Increased rate of escape from the galaxy at high energies.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{elements }\OperatorTok{=}\NormalTok{ (}\StringTok{"H"}\NormalTok{, }\StringTok{"He"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"N"}\NormalTok{, }\StringTok{"O"}\NormalTok{, }\StringTok{"Si"}\NormalTok{, }\StringTok{"Fe"}\NormalTok{)}
\NormalTok{elements }\OperatorTok{+=}\NormalTok{ (}\StringTok{"1H{-}bar"}\NormalTok{, }\StringTok{"e{-}+e+"}\NormalTok{, }\StringTok{"AllParticles"}\NormalTok{)}

\NormalTok{tabs }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ energy\_type }\KeywordTok{in}\NormalTok{ (}\StringTok{"EKN"}\NormalTok{, }\StringTok{"ETOT"}\NormalTok{):}
    \ControlFlowTok{for}\NormalTok{ elem }\KeywordTok{in}\NormalTok{ elements:}
\NormalTok{        tab }\OperatorTok{=}\NormalTok{ crdb.query(}
\NormalTok{            elem,}
\NormalTok{            energy\_type}\OperatorTok{=}\NormalTok{energy\_type,}
\NormalTok{            energy\_convert\_level}\OperatorTok{=}\DecValTok{1}\NormalTok{,}
\NormalTok{        )}
        \ControlFlowTok{if}\NormalTok{ energy\_type }\OperatorTok{==} \StringTok{"EKN"}\NormalTok{:}
\NormalTok{            tab }\OperatorTok{=}\NormalTok{ convert\_energy(tab, }\StringTok{"EK"}\NormalTok{)}
\NormalTok{        tabs.append(tab)}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ np.concatenate(tabs).view(np.recarray)}

\ControlFlowTok{with}\NormalTok{ np.errstate(divide}\OperatorTok{=}\StringTok{"ignore"}\NormalTok{):}
\NormalTok{    mask }\OperatorTok{=}\NormalTok{ (tab.err\_sys[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\OperatorTok{\&}\NormalTok{ (tab.err\_sta[:, }\DecValTok{0}\NormalTok{] }\OperatorTok{/}\NormalTok{ tab.value }\OperatorTok{\textless{}} \FloatTok{0.5}\NormalTok{)}
\NormalTok{tab }\OperatorTok{=}\NormalTok{ tab[mask]}

\NormalTok{xlim }\OperatorTok{=} \FloatTok{1e4}\NormalTok{, }\FloatTok{1e11}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\ControlFlowTok{for}\NormalTok{ elem }\KeywordTok{in}\NormalTok{ elements:}
\NormalTok{    tab }\OperatorTok{=}\NormalTok{ tab[(xlim[}\DecValTok{0}\NormalTok{] }\OperatorTok{\textless{}}\NormalTok{ tab.e) }\OperatorTok{\&}\NormalTok{ (tab.e }\OperatorTok{\textless{}}\NormalTok{ xlim[}\DecValTok{1}\NormalTok{])]}
\NormalTok{    ma }\OperatorTok{=}\NormalTok{ tab.quantity }\OperatorTok{==}\NormalTok{ elem}
    \ControlFlowTok{if} \BuiltInTok{len}\NormalTok{(tab) }\OperatorTok{==} \DecValTok{0}\NormalTok{:}
        \ControlFlowTok{continue}  
\NormalTok{    color }\OperatorTok{=} \StringTok{"k"} \ControlFlowTok{if}\NormalTok{ elem }\OperatorTok{==} \StringTok{"AllParticles"} \ControlFlowTok{else} \VariableTok{None}
\NormalTok{    t }\OperatorTok{=}\NormalTok{ tab[ma]}
    \ControlFlowTok{if} \BuiltInTok{len}\NormalTok{(t) }\OperatorTok{==} \DecValTok{0}\NormalTok{:}
        \ControlFlowTok{continue}
\NormalTok{    f }\OperatorTok{=}\NormalTok{ t.e}\OperatorTok{**}\FloatTok{2.7}
\NormalTok{    sta }\OperatorTok{=}\NormalTok{ np.transpose(t.err\_sta)}
\NormalTok{    color }\OperatorTok{=} \StringTok{"k"} \ControlFlowTok{if}\NormalTok{ elem }\OperatorTok{==} \StringTok{"AllParticles"} \ControlFlowTok{else} \VariableTok{None}
\NormalTok{    ax.errorbar(t.e, t.value }\OperatorTok{*}\NormalTok{ f, sta}\OperatorTok{*}\NormalTok{f, fmt}\OperatorTok{=}\StringTok{"."}\NormalTok{, color}\OperatorTok{=}\NormalTok{color, label}\OperatorTok{=}\NormalTok{elem)}

\NormalTok{ax.loglog()}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"$E\_k\^{}}\SpecialCharTok{\{2.7\}}\VerbatimStringTok{$ d$J$/d$E\_k$ [GeV$\^{}}\SpecialCharTok{\{1.7\}}\VerbatimStringTok{$ / (m$\^{}2$ s sr)]"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"$E\_k$ [GeV]"}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{ax.legend(frameon}\OperatorTok{=}\VariableTok{False}\NormalTok{, loc}\OperatorTok{=}\StringTok{"lower center"}\NormalTok{, ncol}\OperatorTok{=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{chap2_files/figure-pdf/cell-12-output-1.pdf}

}

\caption{The Knee of the CR spectrum}

\end{figure}%

A third explanation could be a change in CR interactions at
\({\sqrt s}\sim\) few TeV. The first two explanantions produce a
rigidity dependent \emph{knee}, ie the position of the \emph{knee} for
different nuclei depends on \(Z\), while the third explanation will
depend on \(A\). Experimentally the rigidity dependence is favored.

\begin{center}
\includegraphics[width=0.7\textwidth,height=\textheight]{images/knee.png}
\end{center}

Experimentally at these energies we cannot observe cosmic-rays in a
direct way. We need to start looking at their interactions with the
atmosphere (see lecture 3 on air-shower physics). This imposses
limitation on the precision of the cosmic ray composition. In particular
different models of hadronic interactions have to be assumed.

\subsubsection{The Ankle and the End of the
Spectrum}\label{the-ankle-and-the-end-of-the-spectrum}

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/ankle.png}
\end{center}

\begin{itemize}
\item
  A proton of energies \(10^{18}\) eV has a gyroradious of a kpc in a
  typical magnetic field which hints at an extra-Galactic origin for
  these energies.
\item
  Greissen-Zatsepin and Kuz-min predicted that at energies of
  \(\sim 10^{19}\) eV will interact with the low energy photons of the
  CMB. This interaction leads to a supression of flux above
  \(5\times10^{19}\) eV unless the sources are within a few tens of Mpc.
  This supression is referred as GZK cutoff.
\end{itemize}

\subsubsection{High Energy Composition}\label{high-energy-composition}

\begin{itemize}
\tightlist
\item
  Composition of the high energy CR spectrum involves only two
  archetypes: light nuclei (protons) and heavy nuclei (iron).
\item
  The plots above show Auger / HiRes measurements near GZK cutoff, all
  favoring at least a mixed composition tending toward heavy at the
  higher energies.
\end{itemize}

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/AugerUHECRComp.png}
\end{center}

\subsubsection{Sources of Extra Galactic Cosmic
Rays}\label{sources-of-extra-galactic-cosmic-rays}

As we shaw, CR in supernova remmants or blast waves can only accelerate
CR \textbf{up to 100 Z TeV}. In order to explain CR beyond this energy,
one has to invoke other processes such as Non-Linear Diffusion
Acceleration, or extremely high magnetic fields (as suggested in Hillas
plot).

Binary systems in which a compact object (black hole, neutrino star,
pulsar) is permanentely dragging material for an accompaying object
(normal star or galaxy) and whirled into an accreation disk can generate
enourmouse plasma motions with very strong electromagnetic fields. The
image belowe shows an artistic representation of 4U 0614+091, a X-ray
binary.

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{index_files/mediabag/REFLECTION_4_B.jpg}
\end{center}

\subsubsection{Sources of UHECR: The Disk
Dynamo}\label{sources-of-uhecr-the-disk-dynamo}

Black holes or neutrino stars will have matter acretting around them.
Due to the gravitational pull matter will be ripped of in molecules,
atoms, and ultimately elementary charge particles. The energy gain of
infalling potrons will correspond to the variation in the gravitational
potential. If we equal the variation of gravitational potential to the
kinetic energy of the accretting matter we have in the classical
approach:

\[\frac{1}{2}m_p v^2 = \Delta E = -\int^{R}_\infty G\frac{m_p M}{r^2} = G\frac{m_p M}{R}  \rightarrow v =\sqrt{\frac{2 GM}{R}}\]

where \(M\), \(R\), are the mass and radius of the central compact
object.

\begin{itemize}
\item
  For a neutron star (\(M\approx 2\times10^{30}\) kg, \(R= 10\) km):
  \(\frac{\Delta E}{m_p} \sim 1.32\times 10^{20} \;\mathrm{erg/g}\)
\item
  For a black hole (\(M\approx 10^8 M_\odot\),
  \(R = R_S = 2\frac{GM}{c^2}\)):
  \(\frac{\Delta E}{m_p} \sim 5 \times 10^{20} \;\mathrm{erg/g}\)
\end{itemize}

The variable magnetic field of the neutron stars or black holes are
perpendicular to the direction of the accreation disk generating a
Lorentz force:

\[\vec{F} = e (\vec{v} \times \vec{B}) = e\vec{E}\]

So the energy obtained is

\[E=\int \vec{F}d\vec{s} = e v B\Delta s\]

where \(\Delta s\) is the distance over which the force acts. Under
plausible assumptions (\(v \sim c\), \(B= 10^6\) T, \(\Delta s = 10^5\)
m) energies of \(3\times 10^{19}\) eV are possible.

\subsubsection{Candidates of Extra Galactic Cosmic Rays
Sources}\label{candidates-of-extra-galactic-cosmic-rays-sources}

The two main candidates for ExtraGalactic Cosmic Rays are:

\begin{itemize}
\tightlist
\item
  \textbf{Active Galactic Nuclei (AGN)}
\item
  \textbf{Gamma Ray Bursts}
\end{itemize}

\paragraph{Active Galactic Nuclei
(AGNs)}\label{active-galactic-nuclei-agns}

\begin{itemize}
\item
  Discovered in 1932 by K. Jansky looking for noise in transatlantic
  radio transmission for the Bell Telephone Labs. He found a persistent
  noise in the radio from the centre of the Galaxy too loud to be due to
  thermal black body radiation.
\item
  1953 Ginzburg \& Shklovski suggested it was due to synchrotron
  radiation from highly relativistic electrons, confirmed with discovery
  of predicted polarization in M87 light.
\item
  Sandange labeled 3C48 a quasar or quasi-stellar object (it appeared
  pointlike).
\item
  In 1962 3C273 radio source position was found with precision of 1
  arcsec, which allowed to find the optical counterpart at z = 0.158
  (not 1 star but a galaxy).
\item
  In 1963 Hoyle and Fowler speculated that the tremendous emitted energy
  is due to the gravitational collapse of a very massive object.
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{AGN Classification}]

\begin{itemize}
\tightlist
\item
  There is two broad classes: \textbf{Radio quiet} (90\%) and
  \textbf{Radio Loud} (10\%) depending on the pressence of jets or not.
\item
  The unified model of ANGs suggests that different AGNs are infact the
  same object seen from different angles.
\end{itemize}

\begin{center}
\includegraphics{images/agn_model.png}
\end{center}

\end{tcolorbox}

\paragraph{Gamma-Ray Bursts}\label{gamma-ray-bursts}

\begin{itemize}
\item
  GRBs are short bursts lasting a few seconds of \(\gamma\)-ray photons
  from 0.1 - 1 MeV.
\item
  They were discovered in the 60s by the U.S. Vela satellites, which
  were built to detect gamma radiation pulses emitted by nuclear weapons
  tested in space as the US suspected the URSS might carry on secret
  nuclear tests depiste the
  \href{http://en.wikipedia.org/wiki/Nuclear_Test_Ban_Treaty}{Nuclear
  Test Ban Treaty}.
\item
  They have been hypothesed (given their occurence) to have caused mass
  extintions events (thousand times since life begun), in particular
  they are associated with the
  \href{http://en.wikipedia.org/wiki/Ordovician\%E2\%80\%93Silurian_extinction_event}{Ordovician--Silurian
  extinction}.
\item
  There is some observational evidence suggesting that progenitor of a
  GRB are stars undergoing a catastrophic energy release by the end of
  their lifes \(\rightarrow\) Hypernovas
\end{itemize}

The accepted phenomenological picuted of GRBs is of a expanding
relativistic wind \emph{fireball} dissipating kinetic energy. The
observed \emph{afterglow} on some GRBs result from the collision of the
expanding fireball and the surroundings.

In the fireball, the observed radition is produced by synchrotron
emission of shock accelerated electrons, similar to SNRs. Hence, it is
likely that protons will be also shock accelerated.

The two conditition for GRBs sources of UHECR are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  The proton acceleration time must be smaller that the wind expansion
  time (burst duration).
\item
  The proton synchrotron loss time must exceed the acceleration time.
\end{enumerate}

These two conditions lead to a constrain in the Lorentz boost factor for
GRBs:

\[\gamma \geq 130\left(\frac{E}{10^{20}\mathrm{\; eV}}\right)^{3/4}\left(\frac{0.01\mathrm{\; s}}{\Delta t}\right)^{1/4}\]

which matches what we see from GRBs. However IceCube has
\href{http://arxiv.org/abs/1204.4219}{not seen any neutrino associated
with GRBs} which puts in tension the idea that GRBs can be the only
sources of UHECR.

\subsection*{References}\label{references-1}
\addcontentsline{toc}{subsection}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-Claus}
Grupen, Claus. n.d. \emph{Astro Particle Physics}.

\bibitem[\citeproctext]{ref-kachelriess2008lecture}
Kachelriess, M. 2008. {``Lecture Notes on High Energy Cosmic Rays.''}
\url{https://arxiv.org/abs/0801.4376}.

\bibitem[\citeproctext]{ref-Kampert_2014}
Kampert, Karl-Heinz, and Peter Tinyakov. 2014. {``Cosmic Rays from the
Ankle to the Cutoff.''} \emph{Comptes Rendus. Physique} 15 (4): 318--28.
\url{https://doi.org/10.1016/j.crhy.2014.04.006}.

\bibitem[\citeproctext]{ref-72925f46-3bcd-305f-ad05-7b07a9fbcf25}
Melia, Fulvio. 2009. \emph{High-Energy Astrophysics}. Vol. 14. Princeton
University Press. \url{http://www.jstor.org/stable/j.ctv21r3q4z}.

\bibitem[\citeproctext]{ref-Workman:2022ynf}
Workman, R. L., and Others. 2022. {``{Review of Particle Physics}.''}
\emph{PTEP} 2022: 083C01. \url{https://doi.org/10.1093/ptep/ptac097}.

\end{CSLReferences}

\bookmarksetup{startatroot}

\chapter{Cosmic Rays in the
Atmosphere}\label{cosmic-rays-in-the-atmosphere}

\section{Interactions of CR particles in the
atmosphere}\label{interactions-of-cr-particles-in-the-atmosphere}

\subsection{Introduction}\label{introduction-1}

In this lesson we will the different components of a cosmic air shower
when cosmic rays interact with Earth's atmosphere. As seen in the figure
below, we have 3 main components, the \textbf{electromagnetic
component}, the \textbf{hadronic component} and muons and neutrinos
which can be seen as the \textbf{muonic component}.

\begin{center}
\includegraphics{index_files/mediabag/images/air-shower.pdf}
\end{center}

\subsection{The Atmosphere}\label{the-atmosphere}

Before studying the interactions of cosmic rays in the atmosphere we
need to setup a model that will describe our atmosphere. To study the
cosmic rays interactions in the atmosphere it is useful to define a
parameter that we will call the \textbf{vertical atmospheric depth}
(sometimes also called column density) defined as the integral in
altitude of the atmospheric density \(\rho\) above the observation level
\(h\):

\[X(h) =\int_h^{\infty} \rho(h^\prime)\mathrm{ d}h^\prime\]

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/atmos.png}
\end{center}

\subsubsection{The isothermal model of the
Atmosphere}\label{the-isothermal-model-of-the-atmosphere}

In an isothermal hydrostatic atmosphere a particular layer of gas at
some altitude is static. That means that the downward (towards the
planet) force of its weight, plus the downward force exerted by pressure
in the layer above it, and the upward force exerted by pressure in the
layer below, all sum to zero. Assuming a segment of area \(A\) and
heigth \(\mathrm{ d}h\) we can write this equilibrium of forces as:

\[P\cdot A - (P + \mathrm{ d}P)\cdot A - (\rho A \mathrm{ d}h)g_0  =0\]

\[\mathrm{ d}P = -g_0\rho(h) \mathrm{ d}h\]

Using the ideal gas law:

\[ P = \frac{\rho R T}{M}\]

where \(R\) is the ideal gas constant, \(T\) is temperature, \(M\) is
average molecular weight, and \(g_0\) is the gravitational acceleration
at the planet's surface. We get

\[\frac{\mathrm{ d}P}{P} = -\frac{g_0 M}{R T} \mathrm{ d} h\]

assuming a constant and isothermal gas (const \(T\)) we can integrate a
pressure decreases exponentially with increasing height as:

\[P = P_0 e^{-\frac{g_0 M}{R T} h} \]

where the we can define the \textbf{scale height} as:

\[ h_0 = \frac{R T}{M g_0} \]

Since the temperature is assumed to be constant it follows that \(\rho\)
also changes exponentially as \(\rho = \rho_0 e^{-h/h_0}\) and therefore
the column density can be written as:

\[X = X_0 \mathrm{ e}^{-h/h_0}\]

where \(X_0\) is 1030 g/cm\(^{2}\) is the atmospheric depth at sea
level, h = 0. In particular for the isothermal model we have that the
relation between atmospheric depth (aka column density) and density is:

\[ \rho(X) = \frac{X}{h_0} \]

\paragraph{The Scale Height}\label{the-scale-height}

Using typical values (\(T = 273\) K and \(M = 29\) g/mol) we get that
\(h_0 \sim 8\) km which coincidentally is the approximate height of Mt.
Everest.

In reality the temperature changes and hence the scale height decreases
with increasing altitude until the tropopause.

This equations are valid for vertical particles, for zenith angles
\textless{} 60\(^\circ\) (for which we can ignore the Earth's curvature)
the formula is scaled with \(1/\cos{\theta}\) giving the \emph{slant
depth}

\[X_{slant-depth} = \frac{X}{\cos \theta} \]

\subsection{Energy Losses in the
Atmosphere}\label{energy-losses-in-the-atmosphere}

Charge particles when entering in the atmosphere will suffer different
process of energy losses. We are going to review some of them

\subsubsection{Ionization Losses}\label{ionization-losses}

The \textbf{ionization energy loss} of high energy charged particles
with colission with atomic electrons is given by the Bethe-Block
formula:

\[\left(\frac{\mathrm{ d} E}{\mathrm{ d} x}\right)_{ion}= -\left(\frac{4\pi N_0z^2e^4}{mv^2}\right)\left(\frac{Z}{A}\right)\left\{\log\left[\frac{2mv^2\gamma^2}{I}\right]-\beta^2\right\}\]

where \(m\) is the mass of the electron, \(v\) and \(ze\) are the
velocity and charge of the incoming particle, \(N_0\) is the Avogadro's
number, \(Z\) and \(A\) are the atomic and mass numbers of the atmos in
the medium and \(x\) the path travelled, and \(I\) is the ionization
potential of the medium is approximatively 10 Z eV.

\begin{itemize}
\tightlist
\item
  Since \(Z/A \sim \frac{1}{2}\) in most materials it depends little on
  the medium.
\item
  It varies as \(1/v^2\) at low speed and independent of the incident
  particle mass.
\item
  It reaches a minimum at about \(3Mc^2\) and it increases
  logarithmically until it reaches a plateu value.
\end{itemize}

\subsubsection{Radiation Losses}\label{radiation-losses}

In addition to ionization losses, charge particles also undergo
\textbf{bremsstrahlung} or braking radiation when travelling through a
material given by:

\[\left(\frac{\mathrm{ d} E}{\mathrm{ d} x}\right)_{rad} = -\frac{E}{X_0}\]
where for electrons the \textbf{radiation length} is:

\[\frac{1}{X_0} = 4 \alpha\left(\frac{Z}{A}\right)(Z + 1)^2r_e^2N_0\log\left(\frac{183}{Z^{1/3}}\right)\]

where \(r_e = e^2/4\pi m_e c^2\) is the classical electron radius and
\(\alpha = \frac{1}{137}\) is the fine structure constant.

\begin{itemize}
\tightlist
\item
  Bremsstrahlung is proportional to
  \(\frac{1}{X_0} \propto r^2_{e} \propto 1/m_e^2\). The radiation
  length of a muon will be \((m_\mu/m_e)^2\) times that for an electron.
\item
  Bremsstrahlung is proportional to the energy.
\end{itemize}

The critical energy is the energy at
\((\mathrm{ d}E/\mathrm{ d}x)_{ion} = (\mathrm{ d}E/\mathrm{ d}x)_{rad}\).
Above this energy the radiation process dominates, below the ionization.
For electrons this is roughly \(\epsilon_c \sim 600/Z\) MeV, and for the
atmosphere this is \(\epsilon_e \sim 85\) MeV.

\subsubsection{Cherenkov Radiation}\label{cherenkov-radiation}

When relativistic particles traverse a medium at a speed greater than
the speed of light in that medium it can induce Cherenkov radiation.

\begin{figure}[H]

{\centering \includegraphics{index_files/mediabag/Cherenkov_radiation-.gif}

}

\caption{Source: Wikipedia}

\end{figure}%

Cherenkov light is emitted in the UV and blue region in a narrow cone
with angle:

\[\cos \theta = \frac{ct/n}{\beta c t} = \frac{1}{\beta n}\]

so the threshold for production is \(\beta > \frac{1}{n}\). Most of the
components in the air shower will produced abundant Cherenkov light.

We will see more on Cherenkov radiation on the next lesson about
\(\gamma\)-ray astronomy.

\subsubsection{Pair production}\label{pair-production}

If a photon from bremsstrahlung has enougth energy \(E_\gamma > 2 m_e\)
it can produced a pair of electron positron. The cross-section rises
quickly at the threshod of \(2 m_e\) but in the high energy part it can
be approximated to:

\[\sigma = \frac{7}{9} r_0^2 Z (Z+ 1)\log \left(\frac{183}{3\sqrt{Z}}\right)\]

The pair production cannot occure in vacum, a photon desintegrated to
the pair \(e^-e^+\) will have a null momentum in the CoM system,
therefore a nucleus has to be present to absorb the momemtum. As can be
seen the radiation length \(X_0\) is very similar to the one from
radiation losses. In fact we can write:

\[\frac{1}{X_{pair}} = \frac{7}{9}\frac{1}{X_0}\]

Which means that the \textbf{radiation lengths for braking radiation and
pair production are comparable}.

\subsection{Electromagnetic Shower}\label{electromagnetic-shower}

When photons from radiation losses of electrons, have enough energy to
produce pairs of positrons electrons, these hey also can produce photons
which, in turn, can also produces pairs, etc, etc. This is called an
\textbf{electromagnetic shower}.

\subsubsection{The Heitler Toy-Model}\label{the-heitler-toy-model}

The Heitler toy model explains very well the development of an
electromagnetic shower. As we saw, in the ultrarelativistic limit the
radiation lenghs for pair production and bremsstrahung are comparable.
We can defined a distance \(d_{split} = X_0 \log2\) where an electron
will looses, on average, half of its energy.

An electron with inital energy \(E_0\) in a medium will generate a
photon in a \(d_{split}\) length of energy \(E_0/2\), in the next
radiation length the photon can convert into \(e^+e^-\) each with
energies \(E_0/4\). After \(t\) steps the electrons, positrons will have
energies of \(E(t)=E_0/2^t\). This continues until the electrons,
positrons fall below the critical energy of electrons, \(\epsilon_e\),
and ionization dominates. The process is illustrated in the figure
below, where each step \(n\) corresponds to one \(d_{split}\) length.

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{index_files/mediabag/images/em-shower.pdf}
\end{center}

The Heitler model has the following properties:

\begin{itemize}
\tightlist
\item
  The shower has maximum at:
\end{itemize}

\[t_{max} = \frac{\log(E_0/\epsilon_e)}{\log2}\]

\begin{itemize}
\tightlist
\item
  The maximum number of particles is:
\end{itemize}

\[N_{max} = 2^{t_{max}} = \frac{E_0}{\epsilon_e}\]

\begin{itemize}
\tightlist
\item
  The shower maximum will be at a depth \(X_{max}\):
\end{itemize}

\[X_{max}=d_{split} \frac{\log(E_0/\epsilon_e)}{\log2} = X_0 \log(E_0/\epsilon_e)\]

For air \(\epsilon_e = 85\) MeV and the \textbf{radiation length}
\(X_0 = 36.7 \mathrm{ g/cm}^2\). Actual showers also spread laterally
mostly due to Coulomb scattering. The lateral spread is a few times the
so-called \textbf{Moliere unit} equal to \(21/\epsilon_e\) (MeV).

The \(X_{max}\) prediction of the Heitler model is in good agreement
with Monte Carlo simulations. However, the electron to photon ratio of 2
is not in agreement given that the model predicts only one photon
emitted by bremsstrahlung. Simulations show a ratio of 1/6 since in
reality several photons are emitted and electrons lose energy much
faster than photons do.

\subsection{Hadronic Showers}\label{hadronic-showers}

Before modeling the baryon-induced showers or hadronic showers, we need
to estimate the \emph{nuclean mean free path} in the atmosphere. We can
write the \textbf{standard mean free path} for \(\sigma^{air}_N\)
nucleon-air cross section as:

\[l_N = \frac{1}{n \sigma_N^{air}}\]

where as we saw in the introduction \(n\) is the \textbf{number density}
of targets, in our case air nuclei. This number density can be expresed
as \$n = N\_T/V \$ where \(N_T\)is the total number of air nuclei in
volume \(V\).

The \textbf{density mean free path}, is defined as
\(\lambda_N = \rho_{air} l_N\), where \(\rho_{air} = n \cdot m_{air}\)
where \(m_{air}\) is the mass of air nuclei, that can be written as
\(m_{air} \sim A m_p\). Puttin everything together we have that:

\[\lambda^{air}_N = \rho_{air} l_N = n A m_p\frac{1}{n\sigma_N^{air}} = \frac{A m_{p}}{\sigma_N^{air}}\]

For air \(A\) is average mean the mass number of air nuclei components
(mainly nitrogen, oxygen) and we can assume it to be \(A \sim 14.5\) and
\(\sigma_N^{air} \approx\) 300 mb, which corresponds to
\(\lambda_N^{air} \approx 80\)g/cm\(^{2}\).

Note that this definition of the density mean free path is independent
of the mass density of the medium, so if the density changes with
altitude, like in the case of our atmosphere, the density mean free path
is the same.

\subsubsection{The Heitler-Matthew
Model}\label{the-heitler-matthew-model}

In the Heitler model can be adapted also for hadronic showers. This is
what Matthew did. We can imagine a proton initiating the cascade instead
of a photon/electron, in this case a hadronic air shower will develope:

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/proton_eas.png}
\end{center}

We can assume that the first interaction is defined by the proton mean
free path \(\lambda^{air}_N\). Defining the first interaction point
where the proton will lose (on average) half of its energy this first
interaction length is given as \(\lambda^{air}_{N} \log 2\) where for
protons \(\lambda^{air}_N \approx 80\)g/cm. The following general
interaction is expected:

\[ p + p/n \rightarrow p + n/p + \pi^0 + \pi^{\pm} + K^0 + K^{\pm} + .. \]

We will focus only on pion production (same argument can be done for
kaons). After the first interaction we can use the simplified assumption
that the hadronic interaction produces only \(3N_\pi\) pions. Of those
\$ 2 N\_\pi\$ will be charged pions and \(N_\pi\) will be \(\pi^0\).

\begin{center}
\includegraphics[width=0.8\textwidth,height=\textheight]{index_files/mediabag/images/hadronic-shower.pdf}
\end{center}

We also assume the energy is equally distributed among them, so
\(2/3E_0\) will go to charge pions and \(1/3E_0\) will go to the neutral
pions. The \(\pi^0\) has a very short decay time, so it will decay and
produce an electromagnetic shower. Charge pions will continue generating
hadronic shower in each \(d_{split} = \lambda_{\pi}^{air} \log 2\) with
the mean free path of pions \(\lambda_\pi^{air} \sim 120\)g/cm\(^2\)
until they reach the critical energy where pions decay is more probable
than interactions \(\epsilon_\pi\). On each step we assume that energy
is equally divided among the \(3 N_\pi\) pions. Thefore at each step
\(t\) the energy of the pions is:

\[E_\pi = \frac{E_0}{(3N_\pi)^t} \]

The number of radiation lengths \(t\) to reach the critical energy ie
\(E_\pi = \epsilon_\pi\), and is given (as in the case of EM showers):

\[t_{max} = \frac{\log(E_0/\epsilon_\pi)}{\log(3N_\pi)}\]

Assuming that after that energy all charged pions (ie \(2N_\pi\)) decay
to muons, the number of muons is given by:

\[N_\mu =(2N_\pi)^{t_{max}}\]

introducing \(\beta = \log(2N_\pi)/\log(3N_\pi)\) we have:

\[N_\mu =(E_0/\epsilon_\pi)^\beta \]

This is also called the \emph{multiplicity} and corresponds to the muon
bundles as we will see later. For pions between 1 GeV and 10 TeV an
appropiate number is \(N_\pi = 5\) and in that case \(\beta = 0.85\).
Therefore the number of muons doesn't grow linearly with the intial
energy but a slower rate.

The definition of \(X_{max}\) is somehow less clear than in an EM
shower. Hadronic showers are still dominated by electromagnetic
processes, so we can assume that \(X_{max}\) depends dominantly on the
first generation of \(\pi^0\) EM subshowers. For proton primaries, the
first interaction will be given by the nucleon mean free path where in
this first interaction the proton splits in \(3N_\pi\) particles, so
\(pi^0\) with initial energy \(E_0/3N_\pi\) will initiate an EM shower.
The depth of maximum is then obtained as the sum of the first proton
interaction length and the shower maximum of the first EM sub-shower:

\[X_{max} = \lambda^{air}_N \log2 + X_0 \log\left(\frac{E_0}{3N_\pi\epsilon_e}\right) \]

where again \(\epsilon_e\) is the critical energy of electrons. The
expected values of this formula are low when compared to detailed
simulations because it neglects the contributions of the next one or two
generation of \(\pi^0\) production.

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Superposition model for heavy nuclei air showers}]

We can extend the discussion to heavy nuclei by adopting the
\emph{Superposition model} in which a nucleus of mass A and energy
\(E_0\) essentially generates \(A\) subshowers of energy \(E_0/A\). In
that case the muon multiplicity will be:

\[N_\mu = A \left(\frac{E_0}{A\epsilon_\pi}\right)^\beta \propto E_0^\beta A^{1 - \beta} \]

therefore the muon multiplicity will depend on the CR composition.
Likewise the shower maximum is given by:

\[X^{A}_{max}(E_0) = X_{max}^{p}(E_0) - X_0\log{A}\]

ie, for a given energy \(E_0\) the shower max depends on the mass of the
CR primary and it is typicall smaller than for protons (ie reach the
maximum sooner in the atmosphere). For composition studies therefore it
is necessary to measure \(X_{max}\) and the energy of the shower, which
can be estimated from fluorescence techniques.

\end{tcolorbox}

\section{Muons and Neutrinos}\label{muons-and-neutrinos}

The plot below shows the particle flux surviving after a certain
altitude.

\begin{figure}[H]

{\centering \includegraphics{images/cr_fig3_07.png}

}

\caption{Source: Particle Data Group}

\end{figure}%

We can extract different information from this plot:

\begin{itemize}
\item
  Primaries dominate up to 9 km, secondaries (electrons, pions) roughly
  follow the primary shape. Muons and neutrinos are continously
  produced.
\item
  Vertical fluxes for \(E > 1\) GeV. Points show the \(\mu^-\)
  measurements. Muons and neutrinos are produced in decays of mesons
  which are themselves produced by interactions of CR particles with air
  nuclei.
\item
  They are the dominant flux at sea level and the only ones that can
  penetrate deep underground.
\end{itemize}

Electrons and nucleons fluxes above 1 GeV/\(c\) are about 0.2 and 2
m\(^{-2}\) s\(^{-1}\) sr\(^{-1}\) at sea level. Nucleons are the
degraded remnants of the primary cosmic radiation. At sea level about
1/3 are neutrons.

\subsection{Muons and Neutrinos
Productions}\label{muons-and-neutrinos-productions}

The most important channels for muon and neutrino production are:

\begin{itemize}
\item
  Two body decays
  \[\pi^{\pm} \rightarrow \mu^{\pm} + \nu_{\mu}({ \bar \nu_\mu}) \rm{\;\; (\sim 100\%)}\]
  \[K^{\pm} \rightarrow \mu^{\pm} + \nu_{\mu}({\bar \nu_\mu}) \rm{\;\; (\sim 63.5\%)}\]
\item
  Three body decay
  \[K_L \rightarrow \pi^{\pm} e^{\pm}\nu_e({\bar \nu_e}) \rm{\;\; (\sim 38.7\%)}\]
\end{itemize}

At lower energies, the muon decay is also important:

\[ \mu^{\pm} \rightarrow e^{\pm} + \nu_{e}({\bar \nu_e}) + {\bar \nu_{\mu}}(\nu_\mu)\]

For each of the 2-body decay channels, assuming the muon always decay
the neutrino flavor ratio is:

\[\bf{ \nu_\mu : \nu_e = 2:1}\]

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Mean free path for mesons, \(\pi\), \(K\)}]

Charged pions and Kaons can interact or decay. Both processes have a
mean free path and one or the other will dominate depending on which
mean free path is larger.

The \textbf{decay mean free path} of pions is given by
\(l^d_\pi =\gamma  c \tau_\pi\) where \(\gamma\) is the Lorentz factor
of the pion. Multiplying for density we have the \textbf{density decay
mean free path} as:

\[\lambda^d_\pi = \rho(X) \gamma  c \tau_\pi\]

However the atmosphere density depends on the atmospheric depth as
\(\rho(X) = X/h_0\). In units of \emph{slant depth},
\(X_{sd} = X/\cos\theta\) and expanding \(\gamma = E / m_\pi c^2\) we
can rewrite the density decay free path as:

\[\frac{1}{\lambda^d_\pi(E)} = \frac{m_\pi c^2 h_0}{E c \tau_\pi X_{sd} \cos \theta} = \frac{\epsilon_\pi}{E X_{sd} \cos\theta}\]

where \(E\), \(m_\pi\), \(\tau_\pi\) are the pion energy, mass and
lifetime and we defined:

\[\epsilon_\pi = \frac{c\tau_\pi}{m_\pi c^2 h_0}\]

as a \emph{critial energy}. The crital energy is such that the decay
time equals the vertical atmospheric depth
\(\lambda^d_\pi(\epsilon_\pi) = X_{sd} \cos\theta = X\).

The \textbf{interaction mean free path} is the same as nucleon
\(\lambda_\pi = A m_\pi/\sigma_\pi^{air}\) which as we saw is
indenpendent of \(X\).

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Critical energy for mesons, \(\pi\), \(K\)}]

Decay or interaction dominates depending on whether \(1/\lambda^d_\pi\)
or \(1/\lambda_\pi\) is larger. This in turns depends on the ratio
between the energy \(E\) and the critical energy \(\epsilon_\pi\). For
example, the value of the crital energy for pions is given by:

\[\epsilon_\pi = \frac{c\tau_\pi}{m_\pi c^2 h_0} \approx 115 \;\mathrm{ GeV}\]

So we can distinguish two regimes.

\begin{itemize}
\item
  For \(E \gg \epsilon_\pi\) decay length is much larger than the
  atmospheric depth, so interaction dominates.
\item
  For \(E \ll \epsilon_\pi\) decay dominates is much shorter than the
  atmospheric depth, so the pion will likely decay before interacting.
\end{itemize}

The same formulas can be derived for Kaons.

\end{tcolorbox}

\subsection{Muon Fluxes}\label{muon-fluxes}

The muon energy spectrum at sea level is a direct consequence of the
meson source spectrum. Unlike electrons, muons will decay before
reaching the ground in the GeV energy range. The muon decay length is
given by:

\[ d_\mu = \gamma \tau_\mu c\]

Where \(\tau_\mu\) is the muon lifetime of the order of
\(2.2\times 10^{-6}\) s. So for a muon of 1 GeV we have:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lifetime }\OperatorTok{=} \FloatTok{2.1969811e{-}6} \CommentTok{\# muon lifetime in seconds}
\ImportTok{import}\NormalTok{ scipy.constants }\ImportTok{as}\NormalTok{ cte}
\NormalTok{cspeed }\OperatorTok{=}\NormalTok{ cte.c}
\NormalTok{muon\_mass }\OperatorTok{=}\NormalTok{ cte.value(}\StringTok{"muon mass energy equivalent in MeV"}\NormalTok{) }\OperatorTok{*} \FloatTok{1e{-}3} \CommentTok{\# in GeV}

\NormalTok{energy }\OperatorTok{=} \DecValTok{1} \CommentTok{\# GeV}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"d = }\SpecialCharTok{\{}\NormalTok{(energy}\OperatorTok{/}\NormalTok{muon\_mass)}\OperatorTok{*}\NormalTok{lifetime}\OperatorTok{*}\NormalTok{cspeed}\OperatorTok{*}\FloatTok{1e{-}3}\SpecialCharTok{:.2f\}}\SpecialStringTok{ km"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
d = 6.23 km
\end{verbatim}

Compared to the typical atmospheric altitude of \(h \sim 15\) km it
means that at those energies, muons will not reach the ground.

\subsubsection{Energy regimes of muon
fluxes}\label{energy-regimes-of-muon-fluxes}

Three different regimes are distinguishable:

\begin{itemize}
\tightlist
\item
  \(E_\mu \leq \epsilon_\mu\), where \(\epsilon_\mu \sim 1\) GeV. This
  critical energy is when interaction probability and decay probability
  start to be comparable. Even more the muon energy losses become
  important. As we saw energy losses via ionization is almost constant,
  for muons is about \(\sim 2\) MeV/(g/cm\(^{2}\)) in air (and mostly
  independent on the material). However this is true only above energies
  of 1 GeV, below ionization losses increase drastically as can be seen
  in the figure below.
\end{itemize}

\begin{center}
\includegraphics[width=0.5\textwidth,height=\textheight]{images/muon_energylosses_air.png}
\end{center}

\begin{itemize}
\item
  \(\epsilon_\mu \leq E_\mu \leq \epsilon_{\pi,K}\), where
  \(\epsilon_\pi = 115 {\;\rm GeV}\) and
  \(\epsilon_K = 850 {\;\rm GeV}\). In this range all mesons decay and
  muons spectrum follows the same of the parent spectrum of mesons and
  hence that of the primary CRs. The muon is almost independent of the
  zenith angle.
\item
  \(E_\mu \gg \epsilon_{\pi,K}\), Mesons interaction length starts to be
  comparable to their decay length. This happens first for inclined
  showers and so the muon flux gets suppressed while it also starts to
  depend on the zenith angle (ie on the density of the atmosphere).
\end{itemize}

At even highers energies, above 1 TeV in air, muons will also start to
loose energie via other radiative process (we will see that below when
talking about muons underground).

\subsubsection{Analytical approximation}\label{analytical-approximation}

An approximate extrapolation formula valid when muon decay is negligible
(\(E_\mu > 100/\cos\theta\) GeV) and the curvature of the Earth can be
neglected (\(\theta < 70^{\circ}\)) is given by the Gaisser
parametrization:

\[\frac{\mathrm{d}N_\mu}{\mathrm{d}E_\mu \mathrm{d}\Omega} = \frac{0.14}{\mathrm{cm^2\;s\;sr\;GeV}}\left(\frac{E_\mu}{\mathrm{GeV}}\right)^{-2.7}\left[F_\pi(E_\mu, \theta) + F_K(E_\mu,\theta)\right]\]

where \(F_\pi\) and \(F_K\) represent the contributions from pions and
kaons, respectively:

\[F_\pi(E_\mu, \theta) = \frac{1}{1+\frac{1.1 E_\mu \cos\theta}{115 \;\mathrm{GeV}}}\]

\[F_K(E_\mu, \theta) = \frac{0.054}{1+\frac{1.1 E_\mu \cos\theta}{850\;\mathrm{GeV}}}\]

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial I: Plot the muon flux for two different angles}\vspace{3mm}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ matplotlib.pylab }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}font.family\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{"STIXGeneral"}
\NormalTok{plt.rcParams.update(\{}\StringTok{\textquotesingle{}axes.labelsize\textquotesingle{}}\NormalTok{: }\DecValTok{20}\NormalTok{\})}
\NormalTok{plt.rcParams.update(\{}\StringTok{\textquotesingle{}legend.fontsize\textquotesingle{}}\NormalTok{: }\DecValTok{20}\NormalTok{\})}
\NormalTok{plt.rcParams.update(\{}\StringTok{\textquotesingle{}figure.figsize\textquotesingle{}}\NormalTok{: [}\DecValTok{8}\NormalTok{, }\DecValTok{6}\NormalTok{]\})}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.labelsize\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{18}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.labelsize\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{18}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.major.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.minor.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.major.pad\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{8}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}xtick.direction\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{\textquotesingle{}in\textquotesingle{}}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.major.size\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{10}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.minor.size\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.major.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.minor.width\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{1}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.major.pad\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \DecValTok{8}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}ytick.direction\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \StringTok{\textquotesingle{}in\textquotesingle{}}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}legend.frameon\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \VariableTok{False}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}lines.linewidth\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}
\NormalTok{plt.rcParams[}\StringTok{\textquotesingle{}axes.linewidth\textquotesingle{}}\NormalTok{] }\OperatorTok{=} \FloatTok{1.5}

\KeywordTok{def}\NormalTok{ muons(cangle, E):}
\NormalTok{    a }\OperatorTok{=} \FloatTok{1.}\OperatorTok{/}\NormalTok{(}\FloatTok{1.}\OperatorTok{+} \FloatTok{1.1}\OperatorTok{*}\NormalTok{E}\OperatorTok{*}\NormalTok{cangle}\OperatorTok{/}\FloatTok{115.}\NormalTok{)}
\NormalTok{    b }\OperatorTok{=} \FloatTok{0.054}\OperatorTok{/}\NormalTok{(}\FloatTok{1.}\OperatorTok{+} \FloatTok{1.1}\OperatorTok{*}\NormalTok{E}\OperatorTok{*}\NormalTok{cangle}\OperatorTok{/}\FloatTok{850.}\NormalTok{)}
    \ControlFlowTok{return} \FloatTok{0.14} \OperatorTok{*}\NormalTok{E}\OperatorTok{**{-}}\FloatTok{2.7} \OperatorTok{*}\NormalTok{(a }\OperatorTok{+}\NormalTok{ b)}

\NormalTok{fig }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{)}
\NormalTok{ax.set\_xscale(}\StringTok{"log"}\NormalTok{)}
\NormalTok{ax.set\_yscale(}\StringTok{"log"}\NormalTok{)}
\NormalTok{ax.set\_ylim(}\FloatTok{1e{-}5}\NormalTok{, }\FloatTok{3e{-}1}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"$E\_\textbackslash{}mu\^{}}\SpecialCharTok{\{2.7\}}\VerbatimStringTok{ dN\_\textbackslash{}mu/dE\_\textbackslash{}mu [cm\^{}\{{-}2\}s\^{}\{{-}1\} (GeV)\^{}}\SpecialCharTok{\{1.7\}}\VerbatimStringTok{]$"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"$E\_\textbackslash{}mu(GeV)$"}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{E }\OperatorTok{=}\NormalTok{ np.arange(}\FloatTok{1e0}\NormalTok{, }\FloatTok{1e6}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{ax.plot(E, E}\OperatorTok{**}\FloatTok{2.7}\OperatorTok{*}\NormalTok{muons(np.cos(}\DecValTok{75}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{/}\FloatTok{180.}\NormalTok{),E), label}\OperatorTok{=}\VerbatimStringTok{r"$\textbackslash{}theta = 75\^{}\{\textbackslash{}circ\}$"}\NormalTok{)}
\NormalTok{ax.plot(E, E}\OperatorTok{**}\FloatTok{2.7}\OperatorTok{*}\NormalTok{muons(np.cos(}\DecValTok{0}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{/}\FloatTok{180.}\NormalTok{),E), label}\OperatorTok{=}\VerbatimStringTok{r"$\textbackslash{}theta = 0\^{}\{\textbackslash{}circ\}$"}\NormalTok{)}
\NormalTok{plt.legend()}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap3_files/figure-pdf/cell-3-output-1.pdf}

\end{tcolorbox}

\subsubsection{Measured muon flux}\label{measured-muon-flux}

In reality below 10 GeV muon decay and energy loss become important and
the Gaisser parametrization overestimates the muon flux as can be seen
in the plot below:

\begin{figure}[H]

{\centering \includegraphics[width=0.5\textwidth,height=\textheight]{images/atmmu.png}

}

\caption{Source: Particle Data Group}

\end{figure}%

As can be seen from the measured muon flux has the following
characteristics:

\begin{itemize}
\tightlist
\item
  Muons are the most numerous charged particles at sea level
\item
  The mean energy of muons at the ground is \(\sim\) 4 GeV.
\item
  The integral intensity of vertical muons above 1 GeV/c at sea level is
  \(\approx 70 \mathrm{m}^{-2} \mathrm{s}^{-1} \mathrm{sr}^{-1}\) or
  \(\approx 1 \mathrm{cm}^{-2} \mathrm{min}^{-1}\).
\end{itemize}

\subsection{Muon Bundles}\label{muon-bundles}

Sometimes muons also come in groups or \textbf{bundles} of parallel
muons originated from the same primary CR. Muon bundles sometime look
like a single high energy muon. The multiplicity (number of muons in the
bundle) if can be measured is correlated with the mass of the orignal
CR. The image belowe shows a muon-bundle event observed with the MACRO
underground detector.

\includegraphics{images/macro-bundle.png}

\subsubsection{Charge Ratio}\label{charge-ratio}

The muon charge ratio reflects the excess of \(\pi^+\) over \(\pi^-\)
and \(K^+\) over \(K^-\) and the fact that there are more protons than
neutrons in the primary spectrum.

\begin{figure}[H]

{\centering \includegraphics[width=0.5\textwidth,height=\textheight]{images/muon_ratio.png}

}

\caption{Source: Allkofer et. al.~Phys. Lett. B36, 425 (1971). Jokisch
et. al.~Phys. Rev.~D19, 1368 (1979)}

\end{figure}%

The increase with energy of the ratio is due to an increasing importance
of kaons coming from the process \$ p + N \rightarrow \Lambda +
K\^{}+\$.

Assuming the following reactions for the production of \(\pi^+\) and
\(\pi^{-}\):

\[ p + N \rightarrow p^\prime + N^\prime  + k \pi^+ + k \pi^- + r\pi^0 \]
\[ p + N \rightarrow n + N^\prime  + (k + 1) \pi^+ + k \pi^- + r\pi^0 \]

where \(k\) and \(r\) are the multiplicity of the particle species.
Assuming same cross sections we obtain:

\[ R = \frac{N(\pi^+)}{N(\pi^-)} = \frac{2k+1}{2k} = 1 + \frac{1}{2k} \]

for low energies \(k = 2\) and \(R \sim 1.25\)

\subsection{Neutrinos Fluxes}\label{neutrinos-fluxes}

\begin{itemize}
\item
  Neutrinos are the most abundant CR product at sea level, yet they have
  only recently (compared to other particles) measured due to their
  extremely low cross-section.
\item
  The process giving neutrino fluxes are the same as for the muons (we
  saw already) plus the muon decay. Taking into account the decay of
  pions, kaons and muons gives to a flavor ratio of:
  \(\nu_\mu : \nu_e = 2:1\) and \(\nu_e/{\bar \nu_e} \sim \mu^+/\mu^-\)
\item
  At few GeV (\textgreater{} \(\epsilon_\mu\)) muons will not decay and
  \(\nu_e\) will be supressed as the main source of \(\nu_e\) is the
  muon decay.
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial II: Plot the \(\nu_\mu\) and \(\nu_e\) atmospheric flux using
the package \texttt{DaemonFlux} @Yanez:2023lsy}\vspace{3mm}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ daemonflux }\ImportTok{import}\NormalTok{ Flux}
\NormalTok{fl }\OperatorTok{=}\NormalTok{ Flux(location}\OperatorTok{=}\StringTok{\textquotesingle{}generic\textquotesingle{}}\NormalTok{, use\_calibration}\OperatorTok{=}\VariableTok{True}\NormalTok{, debug}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{egrid }\OperatorTok{=}\NormalTok{ np.logspace(}\DecValTok{0}\NormalTok{,}\DecValTok{5}\NormalTok{)}

\CommentTok{\# Start with a square Figure.}
\NormalTok{fig }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{6}\NormalTok{))}
\NormalTok{gs }\OperatorTok{=}\NormalTok{ fig.add\_gridspec(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }
\NormalTok{                      left}\OperatorTok{=}\FloatTok{0.1}\NormalTok{, right}\OperatorTok{=}\FloatTok{0.9}\NormalTok{, bottom}\OperatorTok{=}\FloatTok{0.1}\NormalTok{, top}\OperatorTok{=}\FloatTok{0.9}\NormalTok{,}
\NormalTok{                      height\_ratios }\OperatorTok{=}\NormalTok{ (}\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{), wspace}\OperatorTok{=}\FloatTok{0.05}\NormalTok{, hspace}\OperatorTok{=}\FloatTok{0.12}\NormalTok{)}
\CommentTok{\# Create the Axes.}
\NormalTok{ax\_1 }\OperatorTok{=}\NormalTok{ fig.add\_subplot(gs[}\DecValTok{0}\NormalTok{])}
\NormalTok{ax\_2 }\OperatorTok{=}\NormalTok{ fig.add\_subplot(gs[}\DecValTok{1}\NormalTok{], sharex}\OperatorTok{=}\NormalTok{ax)}

\NormalTok{ax\_1.plot(egrid, fl.flux(egrid, }\StringTok{"60"}\NormalTok{, }\StringTok{"numuflux"}\NormalTok{)}\OperatorTok{+}\NormalTok{fl.flux(egrid, }\StringTok{"60"}\NormalTok{, }\StringTok{"antinumu"}\NormalTok{), label}\OperatorTok{=}\VerbatimStringTok{r"$\textbackslash{}nu\_\{\textbackslash{}mu\}$ at $\textbackslash{}theta = 60\^{}\textbackslash{}circ$"}\NormalTok{)}
\NormalTok{ax\_1.plot(egrid, fl.flux(egrid, }\StringTok{"60"}\NormalTok{, }\StringTok{"nueflux"}\NormalTok{), label}\OperatorTok{=}\VerbatimStringTok{r"$\textbackslash{}nu\_}\SpecialCharTok{\{e\}}\VerbatimStringTok{$ at $\textbackslash{}theta = 60\^{}\textbackslash{}circ$"}\NormalTok{)}
\NormalTok{ax\_1.legend()}
\NormalTok{ax\_1.loglog()}
\NormalTok{ax\_1.grid()}
\NormalTok{ax\_2.plot(egrid, fl.flux(egrid, }\StringTok{"60"}\NormalTok{, }\StringTok{"numuflux"}\NormalTok{)}\OperatorTok{/}\NormalTok{fl.flux(egrid, }\StringTok{"60"}\NormalTok{, }\StringTok{"nueflux"}\NormalTok{), label}\OperatorTok{=}\VerbatimStringTok{r"\textbackslash{}nu\_\{\textbackslash{}mu\}"}\NormalTok{, lw}\OperatorTok{=}\DecValTok{2}\NormalTok{, color}\OperatorTok{=}\StringTok{"black"}\NormalTok{)}
\NormalTok{ax\_2.grid()}
\NormalTok{ax\_2.set\_xscale(}\StringTok{"log"}\NormalTok{)}
\NormalTok{ax\_2.set\_ylim(}\DecValTok{0}\NormalTok{, }\DecValTok{30}\NormalTok{)}
\NormalTok{ax\_2.set\_xlim(}\DecValTok{1}\NormalTok{, }\FloatTok{1e5}\NormalTok{)}
\NormalTok{ax\_1.set\_xlim(}\DecValTok{1}\NormalTok{, }\FloatTok{1e5}\NormalTok{)}
\NormalTok{ax\_2.set\_xlabel(}\VerbatimStringTok{r"$E\_\textbackslash{}nu$/GeV"}\NormalTok{)}
\NormalTok{ax\_1.set\_ylabel(}\VerbatimStringTok{r"$(E\_\textbackslash{}nu/\textbackslash{}mathrm\{ GeV\})\^{}3 \textbackslash{}Phi\_\textbackslash{}nu (\textbackslash{}mathrm\{ GeV\}\textbackslash{}mathrm\{ \textbackslash{};cm\}\^{}2\textbackslash{}mathrm\{ s\textbackslash{}; sr\})\^{}\{{-}1\}$"}\NormalTok{)}
\NormalTok{ax\_2.set\_ylabel(}\VerbatimStringTok{r"$\textbackslash{}Phi\_\{\textbackslash{}nu\_\textbackslash{}mu\} / \textbackslash{}Phi\_\{\textbackslash{}nu\_e\}$"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Text(0, 0.5, '$\\Phi_{\\nu_\\mu} / \\Phi_{\\nu_e}$')
\end{verbatim}

\includegraphics{chap3_files/figure-pdf/cell-4-output-2.pdf}

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Note}]

In astrophysical sources the ration 2:1 persists.
\hyperref[Charged_pion_decays]{Why pions don't decay in to electrons?}

\end{tcolorbox}

\subsection{Fluxes and Kinematics}\label{fluxes-and-kinematics}

As mentioned neutrinos and muons are strongly correlated. However due
the two-body kinematics, the energy spectra of the \(\nu\)'s and
\(\mu\)'s from mesons decay are different. For example, the energy of
the muon in CoM is given by:

\[E_\mu^{*} = (m_\pi^2 + m_\mu^2)/2m_\pi = 109.8\;\mathrm{MeV}\]

and for the neutrino:

\[E_\nu^{*} = (m_\pi^2 - m_\mu^2)/2m_\pi = 29.8\;\mathrm{MeV}\]

In the laboratory system, the energies are boosted by the Lorentz factor
\(\gamma= E_\pi /m_\pi\), but as can be seen muon carry a much larger
fraction of energy than neutrinos. For energies about
\(1\;\mathrm{TeV}< E_\nu <  10^3\;\mathrm{TeV}\), the angle averaged
atmospheric \(\nu_\mu + {\bar \nu_\mu}\) can be approximated by a power
law spectrum:

\[\frac{\mathrm{d}N_{\nu_\mu + {\bar \nu_\mu}}}{\mathrm{d}E_\nu} = 7.8 \times 10^{-11}\left(\frac{E_\nu}{1\;\mathrm{TeV}}\right)^{-3.6}\mathrm{cm^2\;s^{-1}\;sr^{-1}\;GeV^{-1}}\]

\subsubsection{Fluxes as Function of
Zenith}\label{fluxes-as-function-of-zenith}

Another difference with respect to the muon fluxes is their dependency
with respect to the zenith angle. Since atmospheric muons are not
absorved by the Earth, their spectrum spans to the whole sky. The
following plot shows the calculated neutrino flux at 1,300 m depth with
energies \(E_\nu = 10\) GeV.

\begin{figure}[H]

{\centering \includegraphics[width=0.6\textwidth,height=\textheight]{images/nu_zenith.png}

}

\caption{Source: \href{http://arxiv.org/abs/1210.5154}{arXiv:1210.5154}}

\end{figure}%

The peak at the horizon in the atmospheric neutrino flux is due to the
so-called \emph{secant theta effect}. This effect occurs because pions
and kaons that are produced nearly skimming the Earth have more flight
time in less dense atmosphere, so they have more chance to decay than
interact.

\subsection{Prompt Fluxes}\label{prompt-fluxes}

Apart from kaons and pions, charmed messons will also be produced in the
atmosphere. Charm particles have lifetimes so short (\(10^{-12}\)s) they
almost alway decay before interacting. Muons and neutrinos from charm
decay are called \emph{prompt} muons/neutrinos. They have the following
peculiarities:

\begin{itemize}
\tightlist
\item
  The energy spectrum follows the one of the primary cosmic rays ie that
  of \(\sim E^{-2.7}\).
\item
  Since there is no competition between decay and interaction of the
  charm particle, the \emph{prompt} flux is fully \textbf{isotropic}.
\item
  Since neutrinos are produced in 3-body decays they produced the same
  amount of \(\nu_\mu\) and \(\nu_e\).
\end{itemize}

It is important to note that the prompt fluxes have not been observed
yet.

\section{Particles Underground}\label{particles-underground}

\subsection{Muon Interactions}\label{muon-interactions}

When muon reaches the ground the will experience the following
interactions when travelling through matter with a higher density than
air. The will losse energy mostly through the following processes:

\begin{itemize}
\tightlist
\item
  \textbf{Ionization.} The continuous energy loss of muons passing
  through a medium as it ionize the material along the path. We saw
  however that ionization is mostly independent of the material, as most
  of them have values of \(Z/A \sim 0.5\).
\end{itemize}

\begin{center}
\includegraphics[width=0.4\textwidth,height=\textheight]{index_files/mediabag/images/muon_ionization.pdf}
\end{center}

\begin{itemize}
\tightlist
\item
  \textbf{Bremsstrahlung.} Also called braking radiation. In the
  electric field of a nucleus or atomic electrons, muons can radiate
  high energy photons. If the photon has energy enough it can initiate
  an electromagnetic shower.
\end{itemize}

\begin{center}
\includegraphics[width=0.4\textwidth,height=\textheight]{index_files/mediabag/images/muon_bremsstrahlung.pdf}
\end{center}

\begin{itemize}
\tightlist
\item
  \textbf{Pair production.} A muon can radiate a virtual photon which,
  again in the electric field of a nucleus, can convert into a real
  \(e^+e^-\) pair. As in the case of bremsstrahlung, the pair production
  will initate an electromagnetic shower.
\end{itemize}

\begin{center}
\includegraphics[width=0.4\textwidth,height=\textheight]{index_files/mediabag/images/muon_pair-production.pdf}
\end{center}

\begin{itemize}
\tightlist
\item
  \textbf{Photonuclear interactions.} A muon can radiate a virtual
  photon which directly interacts with a nucleus in the muon propagation
  medium. The interaction is either electromagnetic or following the
  fluctuation of the photon into a quark-antiquark pair (i.e.~a virtual
  vector meson). This interaction will generate an hadronic shower.
\end{itemize}

\begin{center}
\includegraphics[width=0.4\textwidth,height=\textheight]{index_files/mediabag/images/muon_photonuclear.pdf}
\end{center}

\subsection{Muon Energy losses}\label{muon-energy-losses}

The energy losses due to ionization are continuous while in radiation
processes the energy is lost in bursts along the muon path. When a muon
is travelling through a dielectric medium like ice or water, it will
emit cherenkov photons as wells, but due to the stochastics energy
losses electromagnetic and hadronic showers are generated along the muon
track. The following figure illustrates this process:

\begin{center}
\includegraphics[width=0.9\textwidth,height=\textheight]{index_files/mediabag/images/muon_energylosses.pdf}
\end{center}

It is worth noting that photonuclear interactions are subdominant when
compared to bremsstrahlung and pair-production, so most of the showers
will be electromagnetic showers. The equation that describes the energy
loss for muons at high energy can be simplified to:

\[\frac{\mathrm{ d}E_\mu}{\mathrm{ d}X} = -\alpha -\beta E_\mu\]

where \(X\) is the thickness of the material (in \(\mathrm{ g/cm}^2\)),
\(\alpha\) is the energy loss due to ionization and
\(\beta = \beta_{br} + \beta_{pair} + \beta_{ph}\) are the three
discrete energy loss processes: bremsstrahlung, electron-positron
production and electromagnetic interaction with the nuclei. Thickness is
also given sometimes in units of meters water equivalent (1 m.w.e. =
\(10^2 \mathrm{\; g/cm^2}\)). Due to the energy dependency of the
radiative processes, higher energy muons will have more stochastic
energy losses than lower energy muons.

The \textbf{critical energy} is when both losses are equal, ie
\(\epsilon_\mu = \alpha/\beta\). Typical values are
\(\alpha \simeq 2 \mathrm{ \;MeV\;g}^{-1} \mathrm{ \;cm}^2\) and
\(\beta \simeq 4 \times 10^{-6} \;\mathrm{ g^{-1}\;cm^2}\), so
\(\epsilon_\mu \approx 500\) GeV.

The following plots showd simulated muons bundles in
\href{https:icecube.wisc.edu}{IceCube}. The stochastic energy losses are
particular clear in the right figure.

\begin{center}
\includegraphics[width=0.4\textwidth,height=\textheight]{images/musmooth.jpg}
\end{center}
\begin{center}
\includegraphics[width=0.4\textwidth,height=\textheight]{images/mustochastic.jpg}
\end{center}

\subsection{Muon Range}\label{muon-range}

By solving the energy loss equation we can estimate the range \(R\) for
a muon \(E_\mu\), ie the underground depth this muon will reach until
its energy is 0 (in reality the muon when reaching low energies will
decay):

\[ R(E_\mu) = \frac{1}{\beta}\log\left( 1 + \frac{E_\mu}{\epsilon_\mu}\right)\]

Assuming the muon spectrum at sea level can be approximated to a power
law \(I_\mu(>E_\mu) = AE_\mu^{-\gamma}\) and using the relationship
between range and energy we can write the \emph{depth-intensity
relation} (DIR):

\[I_\mu(>E_\mu, R) = A\left[\frac{\alpha}{\beta}(e^{\beta R} - 1)\right]^{-\gamma}\]

The plot below shows the depth-intensity muons for vertical directions.
The grey-area are neutrino-induced muons (horizontal, up-wards)

\begin{center}
\includegraphics{images/muon-depth.png}
\end{center}

\subsection{Neutrino Interactions}\label{neutrino-interactions}

\subsubsection{Weak interaction}\label{weak-interaction}

Neutrinos feel only the weak force thus interactions with matter
mediated by \(W\) and \(Z\) bosons with cross-sections typical of weak
processes. Feynman diagrams factor along two lines:

\begin{itemize}
\tightlist
\item
  Neutral current (NC) interactions - exchange of \(Z\)
\item
  Charged current (CC) interaction - exchange of \(W^{\pm}\)
\end{itemize}

\begin{center}
\includegraphics{index_files/mediabag/images/neutrino-interactions.pdf}
\end{center}

Neutrinos will scatter from electrons as well as nuclear matter.

\begin{itemize}
\item
  For energies \(E_\nu < 1 \mathrm{GeV}\) neutrinos interact with
  hadronds via \textbf{elastic} or \textbf{quasielastic scattering}.
\item
  For energies \(E_\nu \gg 1 \mathrm{GeV}\) neutrinos do not scatter on
  hadronds as a compound of quarks, they start to \emph{see} and
  interact directly with the quarks, this is the so-called \textbf{Deep
  Inelastic Scattering}.
\end{itemize}

\subsection{Neutrino cross-sections at GeV
energies}\label{neutrino-cross-sections-at-gev-energies}

The anti-neutrino cross-section at GeV energies is a factor
\textasciitilde2 lower (naively should be 3, but the factor 2 comes from
the structure function of the nucleus) than the neutrino cross-section
due to the helicity.

\begin{center}
\includegraphics{images/pdg_plot.gif}
\end{center}

At \(E_\nu \gg 1 \mathrm{GeV}\) the total DIS cross-section (ie,
assuming CC and NC together) can be approximated to:

\[\sigma_{\nu p} \simeq 0.69 \times 10^{-38} \left(\frac{E_\nu}{ 1 \rm{\; GeV}}\right) \rm{ \; cm}^2\]
\[\sigma_{\bar{\nu} p} \simeq 0.35 \times 10^{-38}\left(\frac{E_\nu}{ 1 \rm{\; GeV}}\right) \rm{ \; cm}^2\]

Sometimes the cross-section is expressed as \(\nu + N\) where \(N\) is
the nucleon definition as:

\[N = \frac{n+p}{2}\]

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Earth is transparent to GeV neutrinos}]

We are going to calculate the mean free path of neutrinos of energies of
\(\sim GeV\). Note that mean free path can be expressed as:

\[l = \frac{1}{n_N \sigma_{\nu N}}\]

where \(n_N\) is the number density of \emph{nucleons} and not atoms. As
we saw in lecture 2 we can re-express the number density as:

\[n_N = \frac{N_A}{\mathcal{M}}\rho\]

where \(\mathcal{M}\) is the molar mass of one mole of nucleons and
\(\rho\) is the mass density of the medium. However, by definition a mol
of nucleons has a mass of 1 g (Remember that a mol of \(^{12}C\) atoms
has a mass of 12 g). So, we can rewrite as \(n_N = N_A \rho\). Below
there is another way to estimate the mean free path:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ astropy }\ImportTok{import}\NormalTok{ constants }\ImportTok{as}\NormalTok{ ct}
\ImportTok{from}\NormalTok{ astropy }\ImportTok{import}\NormalTok{ units }\ImportTok{as}\NormalTok{ u}
\CommentTok{\#Earth mass}
\BuiltInTok{print}\NormalTok{ (ct.M\_earth)}

\CommentTok{\#Neutron/proton mass}
\BuiltInTok{print}\NormalTok{ (ct.m\_n)}

\CommentTok{\#Earth radius}
\BuiltInTok{print}\NormalTok{ (ct.R\_earth)}

\CommentTok{\#number of nucleons}
\NormalTok{N }\OperatorTok{=}\NormalTok{ ct.M\_earth}\OperatorTok{/}\NormalTok{ct.m\_n }

\CommentTok{\#Earth volume}
\NormalTok{Ve }\OperatorTok{=} \DecValTok{4}\OperatorTok{/}\DecValTok{3}\OperatorTok{*}\NormalTok{np.pi}\OperatorTok{*}\NormalTok{ct.R\_earth}\OperatorTok{**}\DecValTok{3}

\CommentTok{\#Nucleon density}
\NormalTok{Nd }\OperatorTok{=}\NormalTok{ N}\OperatorTok{/}\NormalTok{Ve}

\CommentTok{\#Cross section}
\NormalTok{s }\OperatorTok{=} \FloatTok{1e{-}38} \OperatorTok{*}\NormalTok{ u.cm}\OperatorTok{**}\DecValTok{2}
\CommentTok{\#Mean free path:}
\NormalTok{L }\OperatorTok{=} \DecValTok{1}\OperatorTok{/}\NormalTok{(s }\OperatorTok{*}\NormalTok{ Nd.to(}\DecValTok{1}\OperatorTok{/}\NormalTok{u.cm}\OperatorTok{**}\DecValTok{3}\NormalTok{))}

\BuiltInTok{print}\NormalTok{ (}\SpecialStringTok{f"The mean free path is: }\SpecialCharTok{\{}\NormalTok{L}\SpecialCharTok{.}\NormalTok{to(u.km)}\SpecialCharTok{:.2f\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Name   = Earth mass
  Value  = 5.972167867791379e+24
  Uncertainty  = 1.3422009501651213e+20
  Unit  = kg
  Reference = IAU 2015 Resolution B 3 + CODATA 2018
  Name   = Neutron mass
  Value  = 1.67492749804e-27
  Uncertainty  = 9.5e-37
  Unit  = kg
  Reference = CODATA 2018
  Name   = Nominal Earth equatorial radius
  Value  = 6378100.0
  Uncertainty  = 0.0
  Unit  = m
  Reference = IAU 2015 Resolution B 3
The mean free path is: 304808158.92 km
\end{verbatim}

\end{tcolorbox}

\subsection{Neutrino cross-sections at TeV
energies}\label{neutrino-cross-sections-at-tev-energies}

\begin{itemize}
\item
  At low energies the valence quark parton distribution dominates and
  both the neutrino NC and CC cross-section grows linear with energy
  since the transfer momemtum is \(q^2 \ll M_{W,Z}\) and so the
  propagator term is \(\sim 1/M^2_{W,Z}\)
\item
  Above 10\(^{4}\) GeV where the gauge-boson propagator restricts the
  momentum transfer to values near \(M_{W,Z}\)
  (\(\sim 1/(q^2 - M^2_{W,Z})\)) and damps the cross-section increase.
\end{itemize}

\includegraphics{images/break_cc_new.png}

\subsection{High energy
Cross-Sections}\label{high-energy-cross-sections}

The following shows the neutrino cross section:

\begin{figure}[H]

{\centering \includegraphics{images/uhenucx.png}

}

\caption{Calculated neutrino cross sections taken from
\href{http://arxiv.org/abs/1309.1764}{arXiv:1309.1764}}

\end{figure}%

\begin{itemize}
\item
  At high energies the asymetry between neutrinos and antineutrinos is
  lost due to the interaction with \emph{sea quarks} (\(q\bar{q}\))
\item
  Neutrinos interact mostly with hadrons (quarks) instead of electrons
  due the their larger target mass. However at \(E_\nu \approx 6.3\) PeV
  the Glashow resonance appears: \({\hbar \nu_e} + e \rightarrow W\)
  making the cross-section higher than the one with hadrons.
\end{itemize}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Earth is opaque to PeV neutrinos}]

\begin{itemize}
\item
  At about 100 TeV the mean free path for neutrino-nucleus scattering is
  about 10\(^{10}\) c.m.w.e. which is about the matter thickness along
  the Earth diameter.
\item
  This means that UHE neutrino observatories (like IceCube) the flux of
  neutrinos comming from the nadir is stronly suppressed.
\item
  There is only one exception. A very high energy beam of \(\nu_\tau\)
  at one side of the Earth \(E\gg 1\) PeV can end up at the other side
  as lower energy \(\nu_\tau, \nu_e,\nu_\mu\) thought the \textbf{tau
  regeneration} effect:
  \(\nu_\tau \rightarrow \tau \rightarrow \nu_\tau\)
\end{itemize}

\end{tcolorbox}

\subsection{Neutrino signatures in a neutrino
detector}\label{neutrino-signatures-in-a-neutrino-detector}

\begin{center}
\includegraphics{images/nu_signatures.png}
\end{center}

\begin{itemize}
\tightlist
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi})}
  \setcounter{enumi}{1}
  \tightlist
  \item
    In CC \(\nu_e\) interactions an hadronic and EM shower initiated by
    the \(e\) is produced. About 20\% of the energy goes in the hadronic
    shower and 80\% to the lepton and therfore to the EM shower.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi})}
  \setcounter{enumi}{3}
  \tightlist
  \item
    In CC \(\nu_\tau\) d) interaction again an hadronic and EM shower
    are produced as the \(\tau\) decays almost inmediately to pions or
    other charge leptons. In the decay another \(\nu_\tau\) is produced
    \textbf{tau regeneration effect}. At very high energyes the two
    showers can be separated giving a \emph{double bang} signature or a
    \emph{lollipop} if the first shower happens outside the detector.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi})}
  \setcounter{enumi}{2}
  \tightlist
  \item
    In CC \(\nu_\mu\) the muon only undergoes radiation losses (not
    ionization) and hence the track of the muon can be reconstructed.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi})}
  \tightlist
  \item
    In NC only an hadronic shower is visible.
  \end{enumerate}
\end{itemize}

\subsection{Event rate in an underground
experiment.}\label{event-rate-in-an-underground-experiment.}

An estimate of the detection rate of neutrino events is equivalent to
calculate the rate of a neutrino-induced muon/cascades flux:

\[R(E_{vis}, \theta) = \int_{E_{vis}} P_{\nu\rightarrow l} (E_\nu, E_{vis}) P_{shadow}(\theta, E_\nu) \frac{\mathrm{ d}N_\nu}{\mathrm{ d}E_\nu}\mathrm{ d}E_\nu\]

where:

\begin{itemize}
\tightlist
\item
  \(P_{\nu\rightarrow l}(E_\nu, E_{vis})\) is the probability that a
  neutrino interacts with an nucleus to produce a \(\mu\) or an EM or
  hadronic cascade with a minimum energy \(E_{vis}\) \emph{visible} in
  the detector.
\item
  \(P_{shadow} (\theta, E_\nu)\). Probability of neutrino with zenith
  angle \(\theta\) and energy \(E_\nu\) of being absorved by Earth.
\item
  \({\mathrm{ d}N_\nu}/{\mathrm{ d}E_\nu}\). Neutrino flux at the
  surface.
\end{itemize}

\subsubsection*{\texorpdfstring{Interaction probability:
\(P_{\nu\rightarrow l}\)}{Interaction probability: P\_\{\textbackslash nu\textbackslash rightarrow l\}}}\label{interaction-probability-p_nurightarrow-l}
\addcontentsline{toc}{subsubsection}{Interaction probability:
\(P_{\nu\rightarrow l}\)}

The probability of a neutrino to produce a lepton or shower visible in
the detector can be writen as:

\[P_{\nu \rightarrow l} = N_A \int_{E_{min}}^{E_\nu} \mathrm{ d}E_l \frac{\mathrm{ d}\sigma}{\mathrm{ d}E_l}r_l(E_l, E_{vis})\]

where \(r_l\) is the detection range of the produced lepton/cascade with
energy \(E_l\) ending with the minimal energy \(E_{vis}\), and
\({\mathrm{ d}\sigma}/{\mathrm{ d}E_l}\) is the neutrino cross-section
to produce a lepton/cascade with energy \(E_l\).

At high energy the event rate is dominated by neutrino-induced muons due
to the long range of the high energy muons.

\subsubsection*{\texorpdfstring{Earth Shadow:
\(P_{shadow}\)}{Earth Shadow: P\_\{shadow\}}}\label{earth-shadow-p_shadow}
\addcontentsline{toc}{subsubsection}{Earth Shadow: \(P_{shadow}\)}

The mean free path of neutrinos can be expressed as
\(\lambda = (N_A \sigma_{tot})^{-1}\). The shadow fact then can be
expressed as:

\[P_{shadow} = e^{-N_A \sigma_{tot} X(\theta)}\]

Where \(X(\theta)\) is the column depth travelled by the neutrino
through the Earth with a zenith angle \(\theta\).

See \textbf{Exercises 2} for an evaluation of the event rate in an
underground detector.

\subsection{Neutrino Oscillations}\label{neutrino-oscillations}

Neutrinos are generated in flavor eingenstate however propagation is
done in mass eingenstate, since each planar wave has a different
frecuency given their different masses, the neutrino detected (also in
flavor eingenstate) will have a different interference pattern than the
one generated given rise to neutrino flavor oscillations.

\begin{itemize}
\item
  As a result of these changes in relative phases, neutrinos oscillate
  from one flavor to another as they travel. Low-energy neutrinos
  oscillate in a shorter distance than high-energy neutrinos.
\item
  A curious aspect of quantum physics is that only the
  \textbf{probability of the flavor of neutrino changes as it travels}.
\item
  The neutrino \emph{only becomes a definite flavor when it interacts}
  in a detector - by finding whether an electron, muon, tau is created.
\end{itemize}

\subsection{The PMNS Matrix}\label{the-pmns-matrix}

The Pontecorvo-Maki-Nakagawa-Sakata matrix is the one that relates the
mass eingenstates with the flavor eingenstates:

\[\begin{pmatrix} \nu_e \\ \nu_\mu \\ \nu_\tau \end{pmatrix} = U_{PMNS} \begin{pmatrix} \nu_1 \\ \nu_2 \\ \nu_1 \end{pmatrix}\]

with:

\[
\begin{aligned}
U_{PMNS} &= 
\begin{pmatrix} 
c_{12}c_{13} & s_{12}c_{13} & s_{13}e^{-i\delta} \\
-s_{12}c_{23} - c_{12}s_{23}s_{13}e^{i\delta} & c_{12}c_{23} - s_{12}s_{23}s_{13}e^{i\delta} & s_{23}c_{13} \\
s_{12}s_{23} - c_{12}c_{23}s_{13}e^{i\delta} & -c_{12}s_{23} - s_{12}c_{23}s_{13}e^{i\delta} & c_{23}c_{13} \end{pmatrix} \\
&= \begin{pmatrix} 
1 & 0 & 0 \\ 0 & c_{23} & s_{23} \\ 0 & -s_{23} & c_{23} 
\end{pmatrix}
\begin{pmatrix} 
c_{13} & 0 & s_{13}e^{-i\delta} \\ 0 & 1 & 0 \\ -s_{13}e^{i\delta} & 0 & c_{13} 
\end{pmatrix}
\begin{pmatrix} 
c_{12} & s_{12} & 0 \\ -s_{12} & c_{12} & 0 \\ 0 & 0 & 1 
\end{pmatrix}
\end{aligned}
\]

where \(s_{ij} = \sin \theta_{ij}\), \(c_{ij} = \cos \theta_{ij}\). The
term \(\delta\) is a CP violation term, if \(s_{13} = 0\) we won't be
able to measure \(\delta\) as it always multiplies \(s_{13}\)

\subsection{The 2-flavor mixing case}\label{the-2-flavor-mixing-case}

Let's assume 2 flavor eigenstates identified as rotations of 2 mass
eigenstates:

\[\begin{pmatrix} \nu_e \\ \nu_\mu \end{pmatrix} = \begin{pmatrix} \cos\theta & \sin\theta \\ -\sin\theta & \cos\theta \end{pmatrix} \begin{pmatrix} \nu_1 \\ \nu_2 \end{pmatrix}.\]

The angle \(\theta\) is called the mixing angle.

The mass eigenstates evolve as plane waves with fixed momemtum \(p\):

\[|\nu_{i}(t, x)\rangle = e^{ -i (E_{i} t - p_i x) }|\nu_{i}(0,0)\rangle\]

Let's imagine we start at \((x,t) = (0,0)\) with a pure beam of
\(\nu_e\):

\[\begin{pmatrix} 1 \\ 0 \end{pmatrix} = \begin{pmatrix} \cos\theta & \sin\theta \\ -\sin\theta & \cos\theta \end{pmatrix} \begin{pmatrix} \nu_1(0,0) \\ \nu_2(0,0) \end{pmatrix}.\]

\[|\nu_{1}(0,0)\rangle = \cos \theta\]
\[|\nu_{2}(0,0)\rangle = \sin \theta\]

and as they evolved:

\[|\nu_{1}(t,x)\rangle = \cos \theta e^{ -i (E_{1} t - p_1 x)  }\]
\[|\nu_{2}(t,x)\rangle = \sin \theta e^{ -i (E_{2} t - p_2 x) }\]

So after a while the wave form of the \(\nu_\alpha\) is given by:

\[|\nu_{e}(t, x)\rangle = \cos^2 \theta e^{ -i (E_{1} t - p_1 x)  } + \sin^2 \theta e^{ -i (E_{2} t - p_2 x) } = A_e\]
\[|\nu_{\mu}(t, x)\rangle = -\sin\theta\cos \theta e^{ -i (E_{1} t - p_1 x)  } + \cos\theta\sin \theta e^{ -i (E_{2} t - p_2 x) } = A_e\]

\subsubsection{Example of survival probability for the 2-flavor
mixing}\label{example-of-survival-probability-for-the-2-flavor-mixing}

\[\begin{aligned}
P(\nu_e \rightarrow \nu_\mu) = \left|\langle \nu_{\mu}(t,x)|\nu_{e}(0,0)\rangle\right|^2 &=\left|\cos\theta \sin\theta (e^{i(E_2 t - p_2 x)} - e^{i(E_1 t -p_1 x)})\right|^2\\
&=
\cos^2\theta\sin^2\theta \left|e^{i(E_2 t - p_2 x)} - e^{i(E_1 t -p_1 x)}\right|^2
\end{aligned}
\]

using \(e^{\pm ix} = \cos x \pm i\sin x\)

\[
\begin{aligned}
P(\nu_e \rightarrow \nu_\mu)&= 2 \cos^2\theta\sin^2\theta ( 1 - \cos (E_2t - p_2x - E_1 t - p_1 x))\\
&= \sin^2 2\theta \sin^2 \left(\frac{(E_2 - E_1)t - (p_2 - p_1)x }{2}\right) \\ 
&=\sin^2 2\theta \sin^2 \left(\frac{\Delta m_{12}^2 L}{4E}\right)
\end{aligned}
\]

using \(p_i = \sqrt{E^2_i -m_i^2}\sim E_i(1-\frac{m^2_i}{E_i^2})\), and
in natural units \(t = x = L\) we can write the phase difference as:

\[(E_2 - E_1)t - (p_2 - p_1)x = (\frac{m_1^2}{2E_1}-\frac{m_2^2}{2E_2})L = \frac{\Delta m_{12}^2L}{2E}\]

And the survival probability is:

\[P(\nu_e \rightarrow \nu_e)  = 1 - P(\nu_e \rightarrow \nu_\mu) = 1- \sin^2 2\theta \sin^2\left(\frac{\Delta m_{12}^2 L}{4E}\right)\]

Replacing \(\hbar\) and \(c\) the expression can be written as:

\[P(\nu_e \rightarrow \nu_e)  = 1 - \sin^2 2\theta \sin^2\left[1.27 \left(\frac{\Delta m^2_{12}}{\mathrm{eV}^2}\right)\frac{L/\mathrm{km}}{E/\mathrm{GeV}}\right]\]

We assumed that the mass eigenstates are created with the same energy or
momentum and so \(E_i = E_j\).This assumption is not necessary and it
comes from the fact we use the plane wave approximation. Using the
correct formalism of wave packets the result is the same.

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, colframe=quarto-callout-color-frame, bottomrule=.15mm, leftrule=.75mm, left=2mm, breakable, rightrule=.15mm, arc=.35mm, opacityback=0, colback=white]

\vspace{-3mm}\textbf{Tutorial III: Plot the survival probability of
\(\nu_e \rightarrow \nu_e\)}\vspace{3mm}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ astropy.units }\ImportTok{as}\NormalTok{ u}

\NormalTok{L }\OperatorTok{=} \DecValTok{180} \CommentTok{\# km}

\NormalTok{delta\_m\_sun }\OperatorTok{=} \FloatTok{7.0e{-}5} \CommentTok{\# eV\^{}2}
\NormalTok{sin\_square\_theta\_12 }\OperatorTok{=} \FloatTok{0.84} \CommentTok{\#maximum mixing}


\KeywordTok{def}\NormalTok{ prob\_survival(E, L):}
    \ControlFlowTok{return} \DecValTok{1} \OperatorTok{{-}}\NormalTok{ sin\_square\_theta\_12 }\OperatorTok{*}\NormalTok{ np.sin(}\FloatTok{1.27}\OperatorTok{*}\NormalTok{delta\_m\_sun }\OperatorTok{*}\NormalTok{ L }\OperatorTok{/}\NormalTok{ E)}\OperatorTok{**}\DecValTok{2}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\NormalTok{ax.set\_ylim(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"$E\_\textbackslash{}nu (\textbackslash{}mathrm\{ MeV\})$"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{"$P\_}\SpecialCharTok{\{ee\}}\StringTok{$"}\NormalTok{)}

\NormalTok{E }\OperatorTok{=}\NormalTok{ np.linspace(}\FloatTok{0.1}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{1000}\NormalTok{) }\CommentTok{\#in MeV}

\NormalTok{ax.plot(E, prob\_survival(E}\OperatorTok{*}\FloatTok{1e{-}3}\NormalTok{,L), lw}\OperatorTok{=}\DecValTok{2}\NormalTok{, }
\NormalTok{        label}\OperatorTok{=}\StringTok{"L = }\SpecialCharTok{\%i}\StringTok{ km}\CharTok{\textbackslash{}n}\StringTok{"}\OperatorTok{\%}\NormalTok{L}\OperatorTok{+}\VerbatimStringTok{r"$P\_}\SpecialCharTok{\{ee\}}\VerbatimStringTok{ = 1 {-}\textbackslash{}sin\^{}2 2\textbackslash{}theta\textbackslash{}sin\^{}2(\textbackslash{}Delta m\^{}2L/4E\_\textbackslash{}nu)$"}\NormalTok{)}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{"best"}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap3_files/figure-pdf/cell-6-output-1.pdf}

Eventually at low enough E / long baselines, neutrino beam becomes fully
mixed and energy resolution and source extent conspire to produce 50/50
beam.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y, x }\OperatorTok{=}\NormalTok{ np.meshgrid(np.linspace(}\DecValTok{50}\NormalTok{,}\DecValTok{180}\NormalTok{,}\DecValTok{100}\NormalTok{), np.linspace(}\FloatTok{0.1}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{100}\NormalTok{) )}
\NormalTok{z }\OperatorTok{=}\NormalTok{ prob\_survival(x}\OperatorTok{*}\FloatTok{1e{-}3}\NormalTok{,y)}
\NormalTok{fig }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{5}\NormalTok{))}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{)}
\NormalTok{img }\OperatorTok{=}\NormalTok{ ax.pcolormesh(x, y, z, cmap }\OperatorTok{=} \StringTok{\textquotesingle{}RdBu\textquotesingle{}}\NormalTok{, shading}\OperatorTok{=}\StringTok{\textquotesingle{}auto\textquotesingle{}}\NormalTok{)}

\NormalTok{cax }\OperatorTok{=}\NormalTok{ fig.colorbar(img)}
\NormalTok{ax.set\_ylabel(}\StringTok{"Distance (km)"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\VerbatimStringTok{r"$E\_\textbackslash{}nu (\textbackslash{}mathrm\{ MeV\})$"}\NormalTok{)}
\NormalTok{cax.set\_label(}\StringTok{"Probability"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap3_files/figure-pdf/cell-7-output-1.pdf}

\end{tcolorbox}

\subsection{General case}\label{general-case}

Taking greek letters of the flavor eingenstates and latin letter the
mass eingenstates we can write:

\[|\nu_\alpha(x,t)\rangle = \sum_{k=1,2,3} U_{\alpha k} |\nu_k (x,t)\rangle = \sum_{k=1,2,3} U_{\alpha k} e^{-i\Phi_k}|\nu_k (0,0)\rangle\]

inverting the mixing matrix we have:

\[|\nu_k (0,0)\rangle =\sum_\gamma U^*_{\gamma  k} |\nu_\gamma(0,0)\rangle\]

putting it in the equation above:

\[|\nu_\alpha(x,t)\rangle =\sum_{k=1,2,3} U_{\alpha k} e^{-i\Phi_k}\sum_\gamma U^*_{\gamma  k} |\nu_\gamma(0,0)\rangle\]

If we want to evaluate the probability of finding a neutrino \(\beta\)
when we had \(\alpha\) is the transition amplitude is given by:

\[\begin{aligned}
\mathcal{A}(\nu_\alpha(0,0)\rightarrow \nu_\beta(x,t)) &= \langle \nu_\beta(x,t)|\nu_\alpha(0,0)\rangle \\
&= \sum_\gamma \sum_k U_{\gamma k}e^{i\Phi_k}U^*_{\beta k}\langle \nu_\gamma(0,0)|\nu_\alpha(0,0)\rangle \\
&= \sum_k U_{\alpha  k}e^{i\Phi_k}U^*_{\beta k}
\end{aligned}\]

where we used the fact that flavor eingenstates are ortogonal and hence
\(\langle \nu_\gamma(0,0)|\nu_\alpha(0,0)\rangle = \delta_{\gamma,\alpha}\).

The oscillation probability is then:

\[\begin{aligned}
P(\nu_\alpha \rightarrow \nu_\beta) = |\mathcal{A}(\nu_\alpha(0,0)\rightarrow \nu_\beta(x,t))|^2 &= \left|\sum_k U_{\alpha i}e^{i\Phi_i}U^*_{\beta i}\right|^2\\
&=\sum_i U_{\alpha i}e^{i\Phi_i}U^*_{\beta i}\sum_j U^*_{\alpha j}e^{-i\Phi_j}U_{\beta j}\\
&=\sum_j\sum_i U_{\alpha i}U^*_{\beta i}U^*_{\alpha j}U_{\beta j}e^{-i(\Phi_j-\Phi_i)}
\end{aligned}\]

where \(\Phi_i = E_i t- p_i x\) and so:

\[\Phi_i - \Phi_j = (E_i - E_j)t - (p_i -p_j)x\]

using \(p_i = \sqrt{E^2_i -m_i^2}\sim E_i(1-\frac{m^2_i}{E_i^2})\) we
can write the phase difference as:

\[\Phi_i - \Phi_j = (\frac{m_i^2}{2E_i}-\frac{m_j^2}{2E_j})L = \frac{\Delta m_{ij}^2L}{2E}\]

where we used the fact that at relativistic speeds \(t = x = L\) and a
dodgy approximation where we assumed that the mass eigenstates are
created with the same energy or momentum and so \(E_i = E_j\).This
assumption is not necessary, but we find that whatever assumption is
made you get the the same result. The fact that we have to make such an
approximation comes from the way that we are modelling the mass
eigenstates as plane waves. If we were to do the analysis assuming that
the mass states were wavepackets instead we would not need the equal
momentum (equal energy) assumption and would still get the same answer.

With this we can rewrite the oscillation probability as:

\[\begin{matrix}P(\nu_\alpha \rightarrow \nu_\beta)=\delta_{\alpha\beta} & - & 4{\displaystyle \sum_{i>j}\mathrm{ Re}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*}})\sin^{2}(\frac{\Delta m_{ij}^{2}L}{4E})\\ & + & {\displaystyle 2\sum_{i>j}\mathrm{ Im}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*})\sin(}\frac{\Delta m_{ij}^{2}L}{2E}),\end{matrix}\]

For \(\delta = 0\) the last term is 0.

\subsection{About symmetries.}\label{about-symmetries.}

\begin{itemize}
\tightlist
\item
  Consequences of CPT invariance:
\end{itemize}

\[P(\nu_\alpha \rightarrow \nu_\beta) = P({\bar \nu_\beta} \rightarrow {\bar \nu_\alpha})\]

\begin{itemize}
\tightlist
\item
  Conditions of CP invariance:
\end{itemize}

\[P(\nu_\alpha \rightarrow \nu_\beta) = P({\bar \nu_\alpha} \rightarrow {\bar \nu_\beta}) \]

\begin{itemize}
\tightlist
\item
  Condition os T invariance:
\end{itemize}

\[P({\nu_\alpha} \rightarrow {\nu_\beta}) = P({\nu_\beta} \rightarrow {\nu_\alpha})\mathrm{\; and\; }P({\bar \nu_\alpha} \rightarrow {\bar \nu_\beta}) = P({\bar \nu_\beta} \rightarrow {\bar\nu_\alpha})\]

Only if \(U\) is not real we can have CP violation effects ie:

\[P(\nu_\alpha \rightarrow \nu_\beta) - P({\bar \nu_\alpha} \rightarrow {\bar \nu_\beta}) ={ 4 \sum_{i>j}\mathrm{ Im}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*})\sin(}\frac{\Delta m_{ij}^{2}L}{2E})\]

\subsection{Mass hierarchy}\label{mass-hierarchy}

But this means that neutrinos oscillations can be described in terms of
6 parameters: \(\theta_{12}\), \(\theta_{13}\) and \(\theta_{23}\) plus
2 mass-squared differences, \(\Delta m_{12}^2\) and \(\Delta m_{32}^2\)
and one CP violating phase \(\delta_{CP}\). Althought we can measured
the mass-squared differences in neutrino oscillation experiments, we
cannot know the absolute scales nor the mass hierarchy.

\begin{figure}[H]

{\centering \includegraphics{index_files/mediabag/ce8abf20fa840b880444.png}

}

\caption{Source:
\href{https://inspirehep.net/record/1114323}{arXiv:1205.2671}}

\end{figure}%

Where \(\Delta m_{12}^2 = \Delta m_{Sol}^2\) and
\(\Delta m_{31(2)}^2 = \Delta m_{atm}^2\). Sometimes
\(\Delta m_{atm}^2\) is defined as:
\[\Delta m_{atm}^2  =\left| m_3^2 - \frac{(m_1^2 + m_2^2)}{2} \right|\]

\#\#\# Measurements Status Assuming
\(\Delta m_{21}^2 \ll \Delta m_{31}^2 \sim \Delta m_{32}^2\) and small
\(\theta_{13}\) different detectors can prove different sectors of the
oscillation parameters:

\begin{itemize}
\tightlist
\item
  \textbf{Atmospheric and Long Baseline Accelerators}:
\end{itemize}

\[\begin{pmatrix} 1 & 0 & 0 \\ 0 & c_{23} & s_{23} \\ 0 & -s_{23} & c_{23} \end{pmatrix}\]

If \(\Delta m_{21}^2L/E \ll 1\) this experiments are sensitive to the
oscillation
\(P(\nu_\mu \rightarrow \nu_\tau) \simeq \sin^2 2\theta_{23}\sin^2\frac{\Delta m_{31}^2}{3E}L\)

\begin{itemize}
\tightlist
\item
  \textbf{Short Baseline Reactors}:
  \[\begin{pmatrix} c_{13} & 0 & s_{13}e^{-i\delta}\\ 0 & 1 & 0\\ -s_{13}e^{i\delta} & 0 & c_{13}\end{pmatrix}\]
\end{itemize}

If \(\Delta m_{21}^2L/E \ll 1\) this experiments are sensitive to the
oscillation
\[ P(\nu_e \rightarrow \nu_e) \simeq 1 - \sin^2 2\theta_{13}\sin^2\frac{\Delta m_{31}^2}{3E}L\]

\begin{itemize}
\tightlist
\item
  \textbf{Solar and Long Baseline}:
\end{itemize}

\[\begin{pmatrix} c_{12} & s_{12} & 0 \\ -s_{12} & c_{12} & 0 \\ 0 & 0 & 1 \end{pmatrix}\]

If \(\Delta m_{31}^2L/E \gg 1\) this experimetns are sensitive to the
oscillation
\[ P(\nu_e \rightarrow \nu_e) \simeq 1 - \sin^2 2\theta_{12}\sin^2\frac{\Delta m_{12}^2}{3E}L\]

\subsection{Solar Neutrinos}\label{solar-neutrinos}

Neutrinos from the Sun are produced by some of the fusion reactions in
the \(pp\) chain or the CNO cycle. The combined effect is:

\[4p \rightarrow ^4He + 2e^+ 2\nu_e\]

From the beginning of the solar-neutrino observation a deficit of the
electron neutrino predicted by the Standard Solar Model was observed:
\emph{the solar-neutrino problem}

In 1999 SNO in Canada started taking data. This experiment was able to
detect \(\nu_e\) by CC interactions and \(\nu_x\) by NC interaction
solving the mistery of the solar-neutrino problem. It is now understood
as a neutrino flavor oscillation. The results of SNO together with
KamLAND (a long baseline neutrino detector) confirmed the Large Mixing
Angle solution (LMA) of the solar sector:

\[\sin^2 \theta_{12} \simeq 0.30\]
\[\Delta m_{12}^2 \equiv \Delta m_{\odot}^2 \simeq 8 \times 10^{-5} \mathrm{ \; eV^2}\]

\subsection{Atmospheric Neutrinos}\label{atmospheric-neutrinos}

First evidence of atmospheric neutrino oscillations came from
Super-Kamiokande experiment in 1998. By scanning in zenith angle, is
like changing the \(L\).

\includegraphics{index_files/mediabag/IC86Multi_NuMuOsc_re.png}

If atmospheric mixing is non-maximal, it remains to determine in which
``octant'' the mixing angle \(\theta_{23}\) lies. For a \(\theta_{23}\)
in the first octant (\(< 45^{\circ}\)) the mass eigenstate \(\nu_3\) is
\textbf{tau heavy}, i.e., the tau neutrino fraction is larger than the
muon neutrino fraction. Conversely, for a \(\theta_{23}\) in the second
octant (\(> 45^{\circ}\)) the state \(\nu_3\) is \textbf{muon heavy}.

\subsection{Reactor Neutrinos}\label{reactor-neutrinos}

\begin{itemize}
\tightlist
\item
  Double Chooz:
  \(\sin^2 2\theta_{13} = 0.109 \pm 0.030 \pm 0.025 \neq 0\) at
  \(2.9\sigma\)
\item
  Daya Bay: \(\sin^2 2\theta_{13} = 0.089 \pm 0.010 \pm 0.005 \neq 0\)
  at \(7.7\sigma\)
\item
  RENO: \(\sin^2 2\theta_{13} = 0.113 \pm 0.013 \pm 0.019 \neq 0\) at
  \(4.9\sigma\)
\end{itemize}

\subsection{Neutrino oscillations in
matter.}\label{neutrino-oscillations-in-matter.}

The \(U_{PMNS}\) matrix must be modified to account for the the fact
that electron neutrinos have an extra interaction not present for
\(\nu_\mu\) and \(\nu_\tau\) when travelling through matter. Elastic
scattering of \(\nu_e\) on electron can occur via exchange of a charged
\(W\)-boson as well as by exchange of the neutral \(Z\)-boson adding a
term \(V_e = G_F \sqrt{2}N_e\) in the mass differences for electrons.

Without entering in the maths, what happens here is that a resonance
effect occurs, ie, even if the mixing angle is small in vacuum it can
get amplified in matter. This resonance can be expressed as a condition
on the electron density \(N_e\) which is appropriate for systems such as
stellar interiors (Sun or supernovae too) where provided the core
density is high enough, there is always a region in the neutrinos' path
exiting the star where it passes through resonance.

This is known as the \textbf{MSW effect} for the theorists who
discovered it - Mikheyev, Smirnov, and Wolfenstein.

\subsection{\texorpdfstring{Tutorial III: Calculate the probabilities of
\(\nu_e \rightarrow \nu_x\) as function of
L/E}{Tutorial III: Calculate the probabilities of \textbackslash nu\_e \textbackslash rightarrow \textbackslash nu\_x as function of L/E}}\label{tutorial-iii-calculate-the-probabilities-of-nu_e-rightarrow-nu_x-as-function-of-le}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ PMNS\_Factory(t12, t13, t23, d):}
\NormalTok{    s12 }\OperatorTok{=}\NormalTok{ np.sin(t12)}
\NormalTok{    c12 }\OperatorTok{=}\NormalTok{ np.cos(t12)}
\NormalTok{    s23 }\OperatorTok{=}\NormalTok{ np.sin(t23)}
\NormalTok{    c23 }\OperatorTok{=}\NormalTok{ np.cos(t23)}
\NormalTok{    s13 }\OperatorTok{=}\NormalTok{ np.sin(t13)}
\NormalTok{    c13 }\OperatorTok{=}\NormalTok{ np.cos(t13)}
\NormalTok{    cp  }\OperatorTok{=}\NormalTok{ np.exp(}\OtherTok{1j}\OperatorTok{*}\NormalTok{d)}
    \ControlFlowTok{return}\NormalTok{ np.array([[ c12}\OperatorTok{*}\NormalTok{c13, s12}\OperatorTok{*}\NormalTok{c13, s13}\OperatorTok{*}\NormalTok{np.conj(cp) ],}
\NormalTok{                  [}\OperatorTok{{-}}\NormalTok{s12}\OperatorTok{*}\NormalTok{c23 }\OperatorTok{{-}}\NormalTok{ c12}\OperatorTok{*}\NormalTok{s23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp, c12}\OperatorTok{*}\NormalTok{c23 }\OperatorTok{{-}}\NormalTok{ s12}\OperatorTok{*}\NormalTok{s23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp, s23}\OperatorTok{*}\NormalTok{c13],}
\NormalTok{                  [ s12}\OperatorTok{*}\NormalTok{s23 }\OperatorTok{{-}}\NormalTok{ c12}\OperatorTok{*}\NormalTok{s23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp,}\OperatorTok{{-}}\NormalTok{c12}\OperatorTok{*}\NormalTok{s23 }\OperatorTok{{-}}\NormalTok{ s12}\OperatorTok{*}\NormalTok{c23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp, c23}\OperatorTok{*}\NormalTok{c13]])}
\KeywordTok{def}\NormalTok{ posc(a, b, U, dm2, LEratio):}
    \CommentTok{"""}
\CommentTok{    Gives the oscillation probability for nu(a) {-}\textgreater{} nu(b)}
\CommentTok{    for PMNS matrix U, and L in km and E in GeV, and dm2 in eV\^{}2}
\CommentTok{    """}
\NormalTok{    s }\OperatorTok{=} \DecValTok{0}
    \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{2}\NormalTok{):}
        \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(j}\OperatorTok{+}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{):}
\NormalTok{            arg }\OperatorTok{=} \FloatTok{5.068}\OperatorTok{*}\NormalTok{dm2[i}\OperatorTok{+}\NormalTok{j}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{LEratio}
\NormalTok{            mxe }\OperatorTok{=}\NormalTok{ np.conj(U[a,i])}\OperatorTok{*}\NormalTok{U[b,i]}\OperatorTok{*}\NormalTok{U[a,j]}\OperatorTok{*}\NormalTok{np.conj(U[b,j])}
\NormalTok{            s }\OperatorTok{+=} \OperatorTok{{-}}\DecValTok{4}\OperatorTok{*}\NormalTok{mxe.real}\OperatorTok{*}\NormalTok{np.sin(}\FloatTok{0.25}\OperatorTok{*}\NormalTok{arg)}\OperatorTok{**}\DecValTok{2} \OperatorTok{+} \DecValTok{2}\OperatorTok{*}\NormalTok{mxe.imag}\OperatorTok{*}\NormalTok{np.sin(}\FloatTok{0.50}\OperatorTok{*}\NormalTok{arg)}
    \ControlFlowTok{if}\NormalTok{ a }\OperatorTok{==}\NormalTok{ b: s }\OperatorTok{+=} \FloatTok{1.0}
    \ControlFlowTok{return}\NormalTok{ s}
\NormalTok{t12 }\OperatorTok{=}\NormalTok{ np.arcsin(}\FloatTok{0.312}\OperatorTok{**}\FloatTok{0.5}\NormalTok{)}
\NormalTok{t13 }\OperatorTok{=}\NormalTok{ np.arcsin(}\FloatTok{0.0251}\OperatorTok{**}\FloatTok{0.5}\NormalTok{) }\CommentTok{\#Controlls the size of the small wiggles.}
\CommentTok{\#t13 = np.arcsin(0.0)}
\NormalTok{t23 }\OperatorTok{=}\NormalTok{ np.arcsin(}\FloatTok{0.42}\OperatorTok{**}\FloatTok{0.5}\NormalTok{)}

\NormalTok{dm2 }\OperatorTok{=}\NormalTok{ [ }\FloatTok{7.58E{-}05}\NormalTok{, }\FloatTok{2.27E{-}03}\NormalTok{, }\FloatTok{2.35E{-}03}\NormalTok{]}
\NormalTok{delta }\OperatorTok{=} \DecValTok{0}

\NormalTok{U }\OperatorTok{=}\NormalTok{ PMNS\_Factory(t12, t13, t23, delta)}


\NormalTok{LE }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{0}\NormalTok{, }\DecValTok{36000}\NormalTok{, }\DecValTok{3600}\NormalTok{)}
\NormalTok{Pe }\OperatorTok{=}\NormalTok{ posc(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, U, dm2, LE)}
\NormalTok{Pm }\OperatorTok{=}\NormalTok{ posc(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, U, dm2, LE)}
\NormalTok{Pt }\OperatorTok{=}\NormalTok{ posc(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, U, dm2, LE)}
\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{12}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\NormalTok{ax.plot(LE, Pe, }\StringTok{\textquotesingle{}{-}\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}nu\_e \textbackslash{}rightarrow \textbackslash{}nu\_e$\textquotesingle{}}\NormalTok{)}
\NormalTok{ax.plot(LE, Pm, }\StringTok{\textquotesingle{}k\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}nu\_e\textbackslash{}rightarrow\textbackslash{}nu\_\textbackslash{}mu$\textquotesingle{}}\NormalTok{)}
\NormalTok{ax.plot(LE, Pt, }\StringTok{\textquotesingle{}r\textquotesingle{}}\NormalTok{, label}\OperatorTok{=}\VerbatimStringTok{r\textquotesingle{}$\textbackslash{}nu\_e\textbackslash{}rightarrow\textbackslash{}nu\_\textbackslash{}tau$\textquotesingle{}}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{"L/E (km/GeV)"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"Probability $\textbackslash{}nu\_e \textbackslash{}rightarrow \textbackslash{}nu\_x$"}\NormalTok{)}
\NormalTok{ax.set\_ylim(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{plt.legend(loc}\OperatorTok{=}\StringTok{"best"}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap3_files/figure-pdf/cell-8-output-1.pdf}

\section{What else?}\label{what-else}

\begin{itemize}
\item
  Pressure and temperature effects in the muon and neutrino fluxes.
\item
  Sterile neutrinos, are there more than 3 neutrinos? What does
  cosmology tell us, what do experiements tell us? (LSND and reactor
  anomalies)
\end{itemize}

\bookmarksetup{startatroot}

\chapter{Multimessenger Astronomy}\label{multimessenger-astronomy}

\section{The Beam Dump}\label{the-beam-dump}

Cosmic ray accelerated are typically surrounded by a radiation field and
matter eventually interacting and producing secondary particles. The
picture is similar to that of beam dumps in particle accelerators at
Earth, where a beam of particles is aimed at a specific target. Among
the secondary particles produced we have gamma-rays and neutrinos both
of them will point to the accelerators.

\includegraphics{index_files/mediabag/images/beam_dump.pdf}

A cosmic-ray source it is said to be opaque or \textbf{optically thick}
if photons and protons cannot escape from the source without lossing all
or most of their energy. Alternatively a transparent source it is said
to be \textbf{optically thin}. A source that is very optically thick
won't be visible in any messenger except neutrinos. We call those source
\emph{hidden sources}.

\section{Gamma-ray Astronomy}\label{gamma-ray-astronomy}

As we saw, the origin of CR remains a mystery due to the deflection of
CRs in their travel. Only CR astronomy at \(10^{19}\) eV will be
possible if the composition of these UHECR are protons, but even in this
case the GZK limits the horizon.

Gamma-ray astronomy provides an fundamental tool to observe the Universe
using neutral deep penetrating gamma-ray particles. Originally the
distinction between gamma-rays and X-rays was due to the nuclear
production mechanism. X-rays are the product of transition of electrons
in the atomic shell, while gamma-rays are produced in the atomic
nucleus. This distinction also leads to a classification in energy.
X-rays are typically below 100 keV. Photons with E \textgreater{} 100
keV are called gamma-rays.

\includesvg{index_files/mediabag/EM_spectrum.svg}

\subsection{Spectral Energy
Distribution}\label{spectral-energy-distribution}

In gamma-ray astronomy is usual to study an object emission by its
spectral energy distribution (SED). The SED on an object is its energy
emitted plotted against some measure of the photon - frequency or
wavelength. The reason astronomers do this is to see how much energy is
produced by the object as a function of frequency or wavelength. The SED
is typically characterized by \(\nu F_\nu\) and it is measured in units
of ergs \(\mathrm{cm}^{-2}\; \mathrm{s}\;^{-1}\), ie. it indicates the
rate of energy emitted per surface. The function \(F_\nu\) is the flux
density which indicates the rate of energy emitted per surface and also
per frequency, so it is expressed as ergs
\(\mathrm{cm^{-2}\; s^{-1}\; Hz^{-1}}\). All of this doesn't need to be
confused with the spectrum! which is what we are being using to
characterize CRs. In CR physics spectrum in the rate of particles per
unit energy and surface and it is measured on
\(\mathrm{GeV^{-1}\; cm^{-2}\; s^{-1}}\). The spectrum multiply by
energy, gives you the rate of particles per unit surface. Multiplying
again by energy give use the energy rate per unit surface. Therefore we
have the relation:

\[\nu F_\nu = E^2 \frac{\mathrm{d}N}{\mathrm{d}E}\]

\subsection{Gamma-ray production
mechanism}\label{gamma-ray-production-mechanism}

Sources of CR can also produce gamma-rays by different mechanisms
roughly divided in two main categories:

\subsubsection{Leptonic models:}\label{leptonic-models}

In this models only leptons (mostly electrons) will produce gamma-ray
emission. The mechanismare mostly: * \textbf{Synchrotron radiation.} *
\textbf{Inverse Compton Scattering.}

\subsubsection{Hadronic model:}\label{hadronic-model}

In hadronic models, gamma-rays are produced as a result of acceleration
to high energies of protons or other hadrons. The mechanism of gamma-ray
production in hadronic models are mainly: * \textbf{\(\pi^0\) decay.} *
\textbf{Proton synchrotron radiation.}

Another categories for gamma-ray production can some exotic models like
dark matter annihilaiton, or matter-antimatter annihilation and nuclear
transformation.

\subsection{Leptonic models}\label{leptonic-models-1}

\subsubsection{Synchrotron radiation}\label{synchrotron-radiation}

Synchrotron radiation is extremely important for astrophysics as it was
realized by Shklovskii in 1957 when studing the non-thermal emission of
the Crab remnant. In order to understand better the synchrotron
radiation we will have to dig in a bit in electromagnetism. We already
saw that a charge particle of charge \(q\), for example an electron,
moving with velocity \(v\) in a magnetic field \(\vec{B}\) feels an an
external force:

\[\vec{F} = \frac{q}{c}(\vec{v}\times \vec{B}) \]

Now, because of the force on the particle is perpendicular to the
motion, the magnetic field cannot do work on the particle, and so its
speed does not change, i.e.~\(|v|\) = constant, but there is an
acceleration since the direction will change. On the other hand an
accelerated electrical charge radiates electromagnetic waves!
which\ldots{} will slow down the particle\ldots{}

The reason of this aparent inconsistency comes from the fact that we
treat the electric field lines as the purely Coulombic
action-at-a-distance. In reality we have to take into account that as a
particle moves, the electric field lines need to \emph{re-arrange} and
this re-arrangement cannot happen at a speed faster than the speed of
light.

Here are going to derive the radiation emission for a particle with an
acceleration and we are going to do it by messing around with the
Coulomb fields. For a more formal argument derived from Maxwell
equations you can see the book of Longair.

Let's assume that the particle is at rest at the moment \(t=0\). The
electric field lines clearly point away from the origin. At that moment
the particle accelerates which brings the velocity of the particle to
\(\Delta v\) in a time \(\Delta t\), after that the particle continues
with uniform velocity.

\includegraphics{index_files/mediabag/images/bremsstrahlung.pdf}

After a certain time, the particle will be in the position
\(t\Delta v\). In a sphere located far way (with a radius larger than
\(c t\)), the electric field lines are still those of the stacionary
particle, since they field lines cannot ``know'' yet that the particle
has moved, so the point radially towards the origin at \(t=0\). Inside a
sphere of radius \(c(t - \Delta t\)), the electric field lines are
already those from the electron that moves at a constant velocity.

The perturbation of the electric field lines needs to propagate
radially, this \emph{kink} is nothing more than a radiation! From simple
geometry relations we can get that:

\[\frac{E_\theta}{E_{r}} = \frac{\Delta v  t \sin\theta}{c\Delta t} = \frac{r \sin \theta}{c^2}\frac{\Delta v}{\Delta t}\]

where \(r = c t\), and \(E_r\) is simply the Coulomb field
\(E_r = q/4\pi\epsilon_0 r^2\) or in
\href{https://en.wikipedia.org/wiki/Gaussian_units}{gaussian units}
since the kink is really small and the eletric field along the kink
remains the same \(E_r = q/r^2\) and therefore the transverse component
becomes:

\[E_\theta = \frac{q a \sin\theta}{c^2 r}\]

where we used the fact that \(\Delta v/\Delta t\) is just the
acceleration \(a\). An interesting fact appears here, \(E_\theta\)
depends on \(r^{-1}\) and not \(r^{-2}\) so for larger \(r\),
\(E_\theta\) is going to dominate over \(E_r\). Accompanying this
transverse electric field there will be a magnetic field, which is a
property of an electromagnetic wave. In other words, an electromagnetic
pulse is generated by the accelerated charge particle. Since this is an
electromagnetic radiation there is an energy flow per unit area, per
second and the direction is given by the Poynting vector (with
\(|E|=|B|\) as in electromagnetic wave):

\[\vec{S}  = \frac{c}{4\pi}(\vec{E}\times\vec{B})\]

Which points in the radial direction. In this case can be reduced to:

\[|S| \equiv \frac{ \mathrm{d}E}{\mathrm{d}t \mathrm{d}A} = \frac{c}{4\pi} E^2_\theta \vec{n}\]

Which is the energy flow per unit area per second. The unit area
\(\mathrm{d}A\) can be rewritten in terms of the solid angle as
\(\mathrm{d} A= r^2\mathrm{d}\Omega\), and so the rate of energy loss
through the area subtended by the solid angle \(\mathrm{d} \Omega\) at
distance \(r\) is given by:

\[\left(\frac{\mathrm{d}E}{\mathrm{d}t \mathrm{d} \Omega}\right)_{rad}  = \frac{q^2a^2 \sin^2 \theta}{4\pi c^3}\]

Notice that this energy loss rate follows a \emph{dipole} pattern
\(\mathrm{d}P/\mathrm{d}\Omega \propto \sin^2 \theta\) and that
\(\theta\) is defined along the acceleration line. If we now integrate
over all solid angles we obtain that the emitted power is given by:

\[P \equiv -\left(\frac{\mathrm{d}E}{\mathrm{d}t}\right)_{rad} = \frac{2q^2 a^2 }{3c^3}\]

Which is call the \emph{Larmor's formula}. Note that this is valid for
any form of acceleration \(a\).

In the relativistic case this formula can be rewritten as:

\[P  = \frac{2q^2}{3c^3} \gamma^4 [ \gamma^2 a_{\parallel}^2 + a^2_{\perp}] \]

\subsection{Single-electron in uniform magnetic
field}\label{single-electron-in-uniform-magnetic-field}

In an uniform magnetic field, a high energy charged particle, for
example an electron, moves in spiral path at a constant \emph{pitch
angle}, \(\alpha\).

\includegraphics{index_files/mediabag/images/spiral.pdf}

Its velocity along the field lines is constant
\(v_{\parallel} = v \cos\alpha = \mathrm{const.}\), but its circular
component \(v_\perp = v\sin\alpha\). Let's first attack the
non-relativistic case.

\subsubsection{Non relativistic case: Cyclotron
radiation}\label{non-relativistic-case-cyclotron-radiation}

From Newton's law and the Lorentz force we have that:

\[ m_e a_\perp = m_e \frac{v_\perp^2}{r_{gyr}} = \frac{e v_\perp B}{c}\]

where \(r_{gyr}\) is the gyroradius which can be written as:

\[r_{gyr} = \frac{v_\perp}{\omega_{gyr}} = \frac{v\sin\alpha}{\omega_{gyr}}\]

where we can define the gyrofrecuency as:

\[\omega_{gyr} \equiv \frac{eB}{m_e c}\]

Therefore according to the Larmor's equation of power emitted we can
write:

\[P = \frac{2 e^2}{3c^3} \omega_{gyr}^2 v^2\sin^2\alpha\]

Note the Larmor formula does not tell us frequency spectrum, but if a
particle is moving in a circular motion, then from an observer far way,
the ``aparent'' motion will be sinosoidal as illustrated in the figure
below.

\includegraphics{index_files/mediabag/images/cyclotron.pdf}

In particular since the power \(P\) depends on \(|v^2|\) for a distance
in the \(x-y\) plane, power will varie as \(\sin^2(\omega_{gyr}t)\) and
so the electric field line will change as
\(E(t)\propto \sin(\omega_{gyr}t)\). The radiated emission will appear
as \emph{monochromatic} with an angular frequency given precisely by the
particle circular frequency \(\omega_{gyr}\). This is the known as the
\emph{cyclotron} radiation. In this case the dipole emission pattern is
turning around with the particle and an observer in the laboratory frame
will see the same frequency. As a consequence also the radiation is
independent of the viewing angle.

\subsubsection{Relativistic case: Synchrotron
radiation.}\label{relativistic-case-synchrotron-radiation.}

Things are slighly different when we consider the relativistic case
where electrons move at \(\beta \rightarrow 1\). Using again Newton's
law with the Lorentz force we have:

\[\gamma m_e \frac{\mathrm{d} v_\perp}{\mathrm{d} t} = \frac{e v_\perp B}{c}\]

where we can obtain the perpendicular acceleration as:

\[a_\perp = \frac{e v\sin\alpha}{\gamma m_e c}\]

where now the electrons's relatisvistic angular gyroradius frequency is
given by:

\[\omega^{rel}_{gyr} \equiv \frac{eB}{\gamma m_e c}\]

which is exactly related to the classical angular frequency as
\(\omega_{gyr}/\gamma\). According to the relativistic Larmor's formula
above we have that:

\[P = \frac{2 e^2}{3c^3} \gamma^4 \left(\frac{e v\sin\alpha}{\gamma m_e c}\right)^2 \]

We can re-arrange this formula by assuming ultra-relativistic electrons
\(\beta \rightarrow 1\) and that we have an average number of electrons
with different pitch angles and so
\(\langle \sin^2 \alpha \rangle = 2/3\). We are going also to use the
definition of the Thomson cross-section:

\[\sigma_T \equiv \frac{8\pi}{3}r^2_0\]

where \(r_0\) is the electron classic radius defined (in gaussian units)
as:

\[r_0 = \frac{e^2}{m_e c^2} \]

with that we can write the power loss as:

\[P = \frac{4}{3} \sigma_T c U_B \gamma^2\]

where \(U_B = B^2/8\pi\) is the magnetic field energy density. The power
depends on the electron mass via the Thomson cross-section and the
\(\gamma\). In total it gives \(P\propto m_e^{-4}\) for the electrons.
That's why for protons the syncrotron radiation is not as important as
it is for electrons. The mean free-path for electrons given their losses
sue to synchrotron is (for typical astrophysical values):

\[l_{syn} = \left(\frac{1}{E}\frac{\mathrm{d}E}{\mathrm{d}t}\right)^{-1}  \sim 100 \mathrm{\;pc}\]

That's the reason why electrons are not the main component of CR since
the cannot travel long distances. If we want now to derive the power
emitted per frequency, things get also a bit more complicated. One first
thing to take into account is that in the relativistic regime the power
radiated will be distorted. From Lorentz transformations we can derive
that an angle \(\Psi\) in the particle rest frame will be seen in
laboratory frame as:

\[\sin \Psi = \frac{\sin\Psi^\prime}{\gamma(1+\beta \cos\Psi^\prime)}\]

(we saw this in the Exercises 1). For small angles we have that

\[\sin \Psi \sim \Psi \sim \frac{1}{\gamma}\]

i.e, while the power is radiated nearly isotropically (dipole) in the
particle's instantaneus rest frame, most of it will be \emph{beamed}
into a narrow cone of angle \(\sim 1/\gamma\) in the laboratory frame.
Note that I'm referring to an \emph{instantaneous} rest frame, what does
it even mean? Well it means that I in the particle rest frame, where the
velocity of the particle is 0, the acceleration on the other hand is not
0, so eventually the particle will move. Ie, there is no particle rest
frame, but there is an instantaneous rest frame.

This beaming in the lab reference frame has an impact on how the viewer
sees the electric field variation. It is no longer a sinusoidal, instead
the emission is pulsed every time the cone sweeps around the line of
sight of an observer as illustrated below:

\includegraphics{index_files/mediabag/images/synchrotron_0.pdf}

Since each cone beaming has a half amplidude of \(1/\gamma\) the
radiation from an observer is visible during a
\(\Delta \theta \sim 2/\gamma\). During this angular distance the
particle travels from \(A\) to \(B\) at an angular frequency given by
\(\omega_{gyr}^{rel}\) which means that \(\Delta t_{AB}\) is given by:

\[\Delta t_{AB} = \frac{\Delta \theta}{\omega_{gyr}^{rel}} = \frac{2}{\gamma \omega_{gyr}^{rel}}\]

Given the relativistic speed of the the electron, the frequency of the
radiation is no longer a sinusoidal. When a photon is emitted at the
point \(B\) the photon emitted in \(A\) has already travelled a distance
\(c\Delta t_{AB}\). Therefore the time interval between photons is given
by:

\[\Delta t_{sync} = \frac{c\Delta t_{AB} - v_\perp \Delta t_{AB}}{c} \approx \Delta t_{AB}( 1 - \beta) \approx  \Delta t_{AB} \frac{1 - \beta^2}{1 + \beta} \]

\[ \Delta t_{sync} \approx \frac{ \Delta t_{AB} }{2\gamma^2} = \frac{1}{\gamma^3 \omega_{gyr}^{rel}} = \frac{1}{\gamma^2 \omega_{gyr}} \]

So synchrotron radiation is a very spiky series of widely spaced narrow
pulses of time \(2\Delta t_{sync}\), and adjacent spikes are separated
in frequency \(\Delta t_{gyr} = 1/\nu^{rel}_{gyr} = \gamma/\nu_{gyr}\).
The emission from an observer is illustrated below:

\includegraphics{index_files/mediabag/images/synchrotron_1.pdf}

The power spectrum (ie power as function of frequency) illustrated in
the plot on the right is no long a monochromatic sinusoidal signal, but
the Fourier transform of this time series of pulses. Taking of all the
Fourier components into account results in the following expression for
one electron (the formal derivation can be found for example in
\emph{Classical Electrodynamics} by J. D. Jackson):

\[P(\nu)\mathrm{d}\nu = \frac{\sqrt{3}e^3B\sin\alpha}{m_ec^2}\frac{\nu}{\nu_c}\int_{\nu/\nu_c}^\infty K_{5/3}(\psi)\mathrm{d}\psi\]

where \(K_{5/2}\) is the Bessel function of order 5/2, and we expressed
the power spectrum in terms of the frequency
\(\nu = \nu_{gyr} =\omega_{gyr}/2\pi\) and where we defined the critical
frequency as:

\[\nu_c \equiv \frac{3}{2}\gamma^2\nu_{gyr} \sin \alpha\]

which the frequency at which the power spectrum will peak. In general
terms we can describe the shape of the synchrotron power spectrum of a
single electron has a logarithmic slope at low frequencies as
\(P \propto \nu^{1/3}\), a broad peak near the critical frequency
\(\nu_c\), and a sharp fall off at higher frequencies.

\subsubsection{Spectrum for several electrons for optically thin
sources}\label{spectrum-for-several-electrons-for-optically-thin-sources}

If a synchrotron source containing any arbitrary distribution of
electron energies is optically thin (\(\tau \ll 1\)), then its spectrum
is the superposition of the spectra from individual electrons and its
flux density cannot rise faster than \(\nu^{1/3}\) at any frequency
\(\nu\). The energy distribution of cosmic-ray electrons in most
synchrotron sources is roughly a power law:

\[n(E) \mathrm{d}E \propto E^{-\delta}\mathrm{d}E\]

We make the very simple and crude approximation that each electron
radiates all of its power at a single critical frequency:

\[\nu_c \simeq \gamma^2\nu_{gyr}\]

We can assume that the luminosity or total power emitted per unit volume
per unit frequency, \(L(\nu)\mathrm{d}\nu\) is given by the power
emitted for each individual electron times the number of electrons:

\[ L (\nu) \mathrm{d}\nu = P n(E)\mathrm{d}E = -\left(\frac{\mathrm{d}E}{\mathrm{d}t}\right) n(E)\mathrm{d}E \]

where
\[E = \gamma m_e c^2 \simeq \left(\frac{\nu}{\nu_{gyr}}\right)^{1/2}m_e c^2\]

and so

\[\frac{\mathrm{d}E}{\mathrm{d}\nu} \simeq \frac{m_e c^2 \nu^{-1/2}}{2\nu_{gyr}^{1/2}}\]

putting all together gives:

\[L_\nu \propto B^{(\delta+1)/2}\nu^{(1-\delta)/2}\]

That is, the synchrotron spectrum of a power-law energy distribution is
itself a power law. This idea is represented in the figure below:

\includegraphics{index_files/mediabag/images/synchrotron_spectrum.pdf}

For example in our Galaxy we expect the electron population to have an
spectral index of \(\delta \sim 2.4\), and so the synchrotron radiation
should have an spectral index of \(\sim 0.7\).

\subsubsection{Power spectrum for several electrons for optically thick
sources}\label{power-spectrum-for-several-electrons-for-optically-thick-sources}

The argument of a power law synchrotron spectrum as a power-low with
specltral index \(\alpha = (1 - \delta)/2\) it's true as long as no
absorption of photons by the emitting region happens. At low frequencies
however synchrotron suffers from self-absorption, in which a photon
interacts with a charge in a magnetic field. This also happens in
\emph{optically thick} sources. Therefore at low frequencies its
emission is absorbed and re-emitted as blackbody radiation. The
derivation of the synchrotron self-absorption is complicated so we are
going to give only an heuristic approach. The problem with the
re-emission of low frequencies as a black-body radiation is that a
power-law distribution does not have a characteristic temperature. We
can however assume that each electrons emits energy at a given frequency
(given that the synchrotron emission of individual electrons is highly
peak at a given frequency):

\[\nu_c \equiv \frac{3}{2}\gamma^2\nu_{gyr} \sin \alpha\]

in order to calculate an \emph{effective temperature} we can use that
for an ultrarelativistic gas we have the relation:

\[E_e = 3kT_e(\nu)\]

where \(E_e = \gamma m_e c^2\), since \(\gamma \propto \nu^{1/2}\) we
have that:

\[T_e(\nu) \propto \nu^{1/2}\]

The black-body radiation or Rayleigh-Jeans is proportional to \(\nu^2\)
but given the extra dependency of \(T_e(\nu)\) it is changed as:

\[L(\nu) \propto T(\nu) \nu^2 B^{-1/2} \sim \nu^{1/2}\nu^{2}B^{-1/2} \sim \nu^{5/2} B^{-1/2}\]

A thing to note is that this part of the spectrum is independent of the
orginal electron power-law spectral index.

\subsection{Tutorial I. Working with
SED}\label{tutorial-i.-working-with-sed}

We are going to plot some SED using a python module called
\href{https://github.com/zblz/naima}{\texttt{naima}}. This package
allows for the calculation of non-thermal radiation from relativistic
particle populations.

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{\%}\NormalTok{matplotlib inline}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ matplotlib.pylab }\ImportTok{as}\NormalTok{ plt}


\OperatorTok{\%}\NormalTok{config InlineBackend.figure\_format }\OperatorTok{=} \StringTok{\textquotesingle{}svg\textquotesingle{}}
\ImportTok{import}\NormalTok{ naima}
\ImportTok{import}\NormalTok{ astropy.units }\ImportTok{as}\NormalTok{ u}

\CommentTok{\# First we are going to define a population of electrons with a PowerLaw model                                    }
\NormalTok{e\_pl }\OperatorTok{=}\NormalTok{ naima.models.PowerLaw(}\FloatTok{1e35}\OperatorTok{*}\NormalTok{u.Unit(}\StringTok{\textquotesingle{}1/eV\textquotesingle{}}\NormalTok{), }\DecValTok{1}\OperatorTok{*}\NormalTok{u.TeV, }\FloatTok{2.4}\NormalTok{)}

\CommentTok{\#Now the equivlent synchrotron radiation for a magnetic field of 100 uG}
\NormalTok{syn }\OperatorTok{=}\NormalTok{ naima.models.Synchrotron(e\_pl, B}\OperatorTok{=}\DecValTok{100}\OperatorTok{*}\NormalTok{u.uG)}


\NormalTok{spectrum\_energy }\OperatorTok{=}\NormalTok{ np.logspace(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{16}\NormalTok{,}\DecValTok{1000}\NormalTok{)}\OperatorTok{*}\NormalTok{u.eV}
\NormalTok{sed\_syn }\OperatorTok{=}\NormalTok{ syn.sed(spectrum\_energy, distance}\OperatorTok{=}\FloatTok{1.5}\OperatorTok{*}\NormalTok{u.kpc)}

\NormalTok{fig }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{)}
\NormalTok{ax.loglog(spectrum\_energy,sed\_syn,lw}\OperatorTok{=}\DecValTok{3}\NormalTok{,label}\OperatorTok{=}\StringTok{\textquotesingle{}Syncrotron\textquotesingle{}}\NormalTok{)}

\NormalTok{ax.set\_ylim(}\FloatTok{1e{-}9}\NormalTok{, }\FloatTok{1e{-}5}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{\textquotesingle{}Photon energy [}\SpecialCharTok{\{0\}}\StringTok{]\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}
\NormalTok{        spectrum\_energy.unit.to\_string(}\StringTok{\textquotesingle{}latex\_inline\textquotesingle{}}\NormalTok{)))}
\NormalTok{ax.set\_ylabel(}\StringTok{\textquotesingle{}$E\^{}2 dN/dE$ [}\SpecialCharTok{\{0\}}\StringTok{]\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}
\NormalTok{        sed\_syn.unit.to\_string(}\StringTok{\textquotesingle{}latex\_inline\textquotesingle{}}\NormalTok{)))}
\NormalTok{ax.grid()}
\NormalTok{ax.legend(loc}\OperatorTok{=}\StringTok{\textquotesingle{}upper right\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\includegraphics{index_files/mediabag/chap4_files/figure-pdf/cell-2-output-1.pdf}

\subsection{Inverse Compton
scattering.}\label{inverse-compton-scattering.}

Compton discovered that photons can transfer part of their energy to
electrons in a collision. In astrophysics the inverse Compton effect
electrons accelerated to high energy collide with photons from the
blackbody radiation (thermal photons) or starlight photons and transfer
energy to them.

In astrophysics the inverse compton scattering is very important as a
fast electrons that produce the synchrotron component can hit a
low-energy photon and transfer a large fraction of its energy to the
photon. For low energy photons, the scattering is elastic, and this
regime is called the classical \emph{Thomson regime}. However, for high
energy photons where \(E_\gamma \gg m_e c^2\) the scatting is not
elastic and the energy of the scattered photons changes. This regime is
called the \emph{Klein-Nishina}. The cross-section for this
\emph{inelastic} scattering is given by:

\[\frac{\mathrm{ d} \sigma_{KN}}{\mathrm{ d}\Omega} = \frac{r_e^2}{2} \frac{E^2_{\gamma,out}}{E^2_{\gamma,in}}\left(\frac{E_{\gamma,out}}{E_{\gamma,in}} + \frac{E_{\gamma,in}}{E_{\gamma,out}} - \sin^2\theta\right)\]

In the low energy regime \(E_{\gamma,in} = E_{\gamma,out}\) and the
cross-section approaches that of the Thomson scattering.

\subsubsection{Maximum energy of inverse
Compton}\label{maximum-energy-of-inverse-compton}

Let's assume the lab reference system, \(O\), and the electrons rest
frame system \(O^\prime\). The energy of the photon is then given by:

\[E_{\gamma,in}^\prime = \gamma E_{\gamma,in} (1 + \beta \cos\theta)\]

where \(\gamma\) and \(\beta\) refer obviously to the electron. Since in
the electron's rest frame the scattering happens at low-energy we can
assume that the scattering is described by the elastic Thomson regime,
ie, the photon is scattered with the same energy in the electron's rest
frame. Going back to the lab frame we have then:

\[E_{\gamma,out} = \gamma E_{\gamma,out}^\prime ( 1 + \beta\cos\theta^\prime)\]

but \(E_{\gamma,in}^\prime = E_{\gamma,out}^\prime\). The maximum energy
transfer will be that of a head-on collision in which the electron
\(\cos\theta = \cos \theta^\prime = 1\) is bounced backwards we have
that:

\[\nu_{max} = \nu_0 \gamma^2 ( 1 + \beta)^2 \simeq 4 \nu_0 \gamma^2\]

As electrons are moving in an isotropic photon field the will see mostly
head on collitions. So the energy spectrum of of scattered photons peak
close to the maximum frecuency. This relation is very important for
astrophysics, because it tell us a relation between the energy of
electrons and the spectrum of photons. We know there are electrons with
\(\gamma \sim 100 - 1000\) and therefore the resulting photon emission
is of very high energy. For example assuming electrons with
\(\gamma \approx 1000\) we have:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Waveband
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Frequency (Hz) \(\nu_0\)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Scattered Frequency (Hz)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Radio & \(10^9\) & \(10^{15}\) = UV \\
Far-infrared & \(3\times10^{12}\) & \(3\times10^{18}\) = X-rays \\
Optical & \(4\times10^{14}\) & \(4\times10^{21}\) = \(\gamma\)-rays \\
\end{longtable}

The hand-waving argument \(\nu \sim \nu_0 \gamma^2\) has also
implication on the spectrum of photons. If electrons follow a power-law
in the form of:

\[\mathrm{d} n(E) \propto E^{-p} \mathrm{d} E\]

we can derive the spectrum of scattered photons which will follow a
power-law as:

\[ I(\nu) \propto \nu^{-\frac{p-1}{2}} \]

because electrons losse energy by a factor \(\gamma^2\) and the
frequency of photons is \(\nu \approx \nu_0 \gamma^2\)

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-note-color-frame, leftrule=.75mm, left=2mm, opacitybacktitle=0.6, colbacktitle=quarto-callout-note-color!10!white, coltitle=black, arc=.35mm, titlerule=0mm, toprule=.15mm, opacityback=0, bottomrule=.15mm, breakable, bottomtitle=1mm, rightrule=.15mm, toptitle=1mm, colback=white, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Note}]

In some cases the synchrotron spectrum can interact with the same
electron population that generated them via IC, scenario is called
\emph{Synchrotron Self Compton} (SSC). When external photons are present
IC does not need the synchrotron field. Such process is referred as
\emph{External Inverse Compton}

\end{tcolorbox}

\subsection{Tutorial II Working with
SED}\label{tutorial-ii-working-with-sed}

We are going now to calculate the IC spectrum using the CMB as the
radiation field:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ astropy.constants }\ImportTok{import}\NormalTok{ c}

\NormalTok{IC }\OperatorTok{=}\NormalTok{ naima.models.InverseCompton(e\_pl, seed\_photon\_fields}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}CMB\textquotesingle{}}\NormalTok{])}

\NormalTok{sed\_ic\_cbm }\OperatorTok{=}\NormalTok{ IC.sed(spectrum\_energy, distance}\OperatorTok{=}\FloatTok{1.5}\OperatorTok{*}\NormalTok{u.kpc, seed}\OperatorTok{=}\StringTok{"CMB"}\NormalTok{)}

\NormalTok{fig2 }\OperatorTok{=}\NormalTok{ plt.figure(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{)}
\NormalTok{ax.loglog(spectrum\_energy,sed\_syn,lw}\OperatorTok{=}\DecValTok{3}\NormalTok{,label}\OperatorTok{=}\StringTok{\textquotesingle{}Syncrotron\textquotesingle{}}\NormalTok{,c}\OperatorTok{=}\NormalTok{naima.plot.color\_cycle[}\DecValTok{1}\NormalTok{])}

\NormalTok{ax.loglog(spectrum\_energy,sed\_ic\_cbm,lw}\OperatorTok{=}\DecValTok{3}\NormalTok{,}
\NormalTok{        label}\OperatorTok{=}\StringTok{\textquotesingle{}Inverse Compton CBM\textquotesingle{}}\NormalTok{, c}\OperatorTok{=}\NormalTok{naima.plot.color\_cycle[}\DecValTok{2}\NormalTok{])}

\NormalTok{ax.set\_ylim(}\FloatTok{1e{-}12}\NormalTok{, }\FloatTok{1e{-}5}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{\textquotesingle{}Photon energy [}\SpecialCharTok{\{0\}}\StringTok{]\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}
\NormalTok{        spectrum\_energy.unit.to\_string(}\StringTok{\textquotesingle{}latex\_inline\textquotesingle{}}\NormalTok{)))}
\NormalTok{ax.set\_ylabel(}\StringTok{\textquotesingle{}$E\^{}2 dN/dE$ [}\SpecialCharTok{\{0\}}\StringTok{]\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}
\NormalTok{        sed\_syn.unit.to\_string(}\StringTok{\textquotesingle{}latex\_inline\textquotesingle{}}\NormalTok{)))}
\NormalTok{ax.grid()}
\NormalTok{ax.legend(loc}\OperatorTok{=}\StringTok{\textquotesingle{}upper right\textquotesingle{}}\NormalTok{)}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\includegraphics{index_files/mediabag/chap4_files/figure-pdf/cell-3-output-1.pdf}

\subsubsection{Case of study: Active Galactic
Nuclei}\label{case-of-study-active-galactic-nuclei}

As we saw, blazars are a particular classification of AGNs with their
relativistic plasma jet oriented close to the line of sight. Because
blazars have their jets pointing towards, the full emission comes from a
relatively small region (the width of the jets) and so these objects can
exhibit rapid variability (due to the smaller causally connected
regions). The typical SED for AGNS is characterized by a synchrotron
component extending from radio to X-ray frequencies, and a second
component peaking at gamma-ray frequencies due to either inverse-Compton
radiation (or from hadronic processes). The plot below shows the
spectral energy distribution of nearby (z = 0.044) blazar 1ES 2344+514
during a flaring and a quiet state.

\subsubsection{Lightcurves and flares}\label{lightcurves-and-flares}

In addition to the SED one could measure the light-curve or number of
photons (or energy density) as a function of time. This is usually done
to illustrate the variability of the source. For AGNs it is possible to
make the lightcurve for different energy ranges, and therefore
addressing different emission mechanism.

Sometimes it is possible to observe a \emph{flare} in high energy photon
range but with no activity detected in soft/hard X-ray. These are called
\textbf{orphan flare}. This is interesting since in the SSC scenarios
the X-rays (due to synchrotron) and TeV gamma-rays (due IC scattering)
must be correlated. An orphan flare is therefore an indication that SSC
scenario might be excluded, while the EC is still possible. As we will
see also an hadronic scenario in which TeV photons come from \(\pi^0\)
is still possible.

\subsection{Hadronic models}\label{hadronic-models}

\subsubsection{Pion decay}\label{pion-decay}

Accelerated protons in the source can produce charged and neutral pions
via proton-proton interaction. In this context a CR proton with energy
\(E_p\) and momentum \(p_p\) interacts with the ISM at rest in the
process:

\[ p + p \rightarrow p + p + \pi^0\]

There is a threshold for this production given by the invariant:

\[s = E_{CoM}^2 = (E_p + m_p)^2 - p_p^2 = (2m_p^2 + m_{\pi^0}^2)^2 \]

As we saw in lesson 2, the available energy to produce particles can be
derived as:

\[\epsilon = E_{CoM} - 2m_p \]

The energy threshod to produce a pion at rest is then:

\[E_{p,th} = \frac{m_{\pi^0}^2 + 4m_p m_{\pi^0} + 2m_p^2}{ 2 m_p} = \frac{m_{\pi^0}^2}{2m_p} + 2 m_{\pi^0} + m_p\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mp }\OperatorTok{=} \FloatTok{938.28} \CommentTok{\#MeV}
\NormalTok{mpion }\OperatorTok{=} \FloatTok{134.976} \CommentTok{\#MeV}
\BuiltInTok{print}\NormalTok{ (}\SpecialStringTok{f"Kinetic energy threshold for pion production }\SpecialCharTok{\{}\NormalTok{(mpion}\OperatorTok{**}\DecValTok{2}\OperatorTok{/}\NormalTok{(}\DecValTok{2}\OperatorTok{*}\NormalTok{mp) }\OperatorTok{+} \DecValTok{2}\OperatorTok{*}\NormalTok{mpion)}\SpecialCharTok{:.1f\}}\SpecialStringTok{ MeV"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Kinetic energy threshold for pion production 279.7 MeV
\end{verbatim}

The pions are produced with the same power law as the parent proton.
Neutral pions decay rapidly (\(\tau = 8.4 \times 10^{-17}\) ns, compared
to 26 ns of charged pions) in to two photons. In the CoM each photon
from the pion decay has an energy of
\(E^{*}_\gamma = m_{\pi^0}/2 \approx 70\) MeV as we saw for the 2-body
decay. In order to calculate the energy in the lab system we need to
make a lorentz transformation:

\[E_\gamma = \gamma(E^{*}_\gamma + \beta_\pi p^{*}_\gamma \cos\theta^{*})\]

where (\(^*\)) denotes the CoM. Since pion is an isoscalar the decay is
isotropic the limits are determined by \(\cos\theta^{*} = \pm 1\). These
limits are:

\[\frac{m_{\pi^0}}{2}\sqrt{\frac{1-\beta}{1+\beta}} \leq E_\gamma \leq \frac{m_{\pi^0}}{2}\sqrt{\frac{1+\beta}{1-\beta}}\]

where \(\beta\) is the velocity of the parent pion and we used
\(p^* = E^*\) for photons.

\subsubsection{Pion bump}\label{pion-bump}

But what is the distribution of photons? Since the decay is isotropic in
the CoM:

\[\mathrm{d} N  = \frac{1}{4\pi} d\Omega = \frac{1}{2} \mathrm{d}\cos\theta^*\]

Using the lorentz transformation from CoM system and the lab system we
can express:
\(\mathrm{d}\cos\theta^* = \mathrm{d}E_\gamma/(\gamma \beta_\pi p^*_\gamma) = 2\mathrm{d} E/ (\gamma \beta_\pi m_{\pi^0})\)
and thus:

\[\mathrm{d} N = \frac{\mathrm{d} E}{\gamma \beta_\pi m_{\pi^0}}\]

Then the distribution of photons
\(\mathrm{d}N/\mathrm{d}E = \mathrm{\; const.}\) ie is constant on a box
from \(E_{min}\) to \(E_{max}\) when plotted as \(\log(E_\gamma)\). If
many pions are decaying, the distribution of photons will be
superpossition of boxes around \(m_{\pi^0}\). This is the so-called
\emph{pion bump}.

\includegraphics{images/pion_bump.png}

\subsection{Pion bump in SNR with Molecular
Cloud}\label{pion-bump-in-snr-with-molecular-cloud}

In 2013 Fermi (a gamma-ray satellite) confirmed the pion-bump in two old
SNRs with Molecular Cloud.

\includegraphics{index_files/mediabag/6ff98851515f2a9d31b6.png}

So did we find the sources of Galactic Cosmic Rays? No.~The steep
gamma-ray spectrum at high energies suggests that the acceleration is
not very active any more (as expected from old SNRs) and hence, even
though there might be some particle acceleration these are not the
sources of Galactic Cosmic Rays.

\subsection{Galactic gamma-ray diffuse
emission}\label{galactic-gamma-ray-diffuse-emission}

Diffuse gamma-ray emission is that not associated with a particular
source. Fermi-LAT observed gamma-ray counts in the energy range from 200
MeV to 100 GeV. The signal is dominated by the diffuse Galactic
emission, which is strongest in the plane of our Galaxy and toward the
Galactic center but present all over the sky. The following shows the
diffuse gamma-ray emission from 200 MeV to 100 GeV.

The gamma-ray diffuse emission are produced primarly the \(\pi^0\)
produced by interactions of cosmic rays protons with the ISM. The
Inverse Compton scattering on star light is less important as well as
bremsstrahlung (braking radiation). In the plot below the models are
split into the three basic emission components:

\begin{itemize}
\tightlist
\item
  \(\pi^0\)-decay (red, long-dashed)
\item
  IC (green, dashed),
\item
  and bremsstrahlung (cyan, dash-dotted).
\end{itemize}

\begin{figure}[H]

{\centering \includegraphics{images/GalacticCenter_Fermi.jpg}

}

\caption{Source: Taken from
\href{http://arxiv.org/abs/1202.4039}{arXiv:1202.4039}}

\end{figure}%

\subsection{Extragalactic Background
Light}\label{extragalactic-background-light}

As we saw, VHE gamma-rays (\(E_\gamma =30\) GeV) have a limited horizon
due to their interaction with the CMB and the
\href{http://en.wikipedia.org/wiki/Extragalactic_background_light}{Extragalactic
Background Light (EBL)}. The EBL is difficult to measure directly due to
strong foregrounds from our solar system and the Galaxy. The TeV signal
of distant AGNs are (partially) absorved at the highest energies by the
ELB. The absortion is energy dependent and increases with distance.
Observations of very far distant AGNs can be used to put constrains on
the amount of EBL. However it is difficult to distinguish between an
intrinsic softening of blazar spectra and a softening caused by the
interaction with low energy EBL photons. The plot below shows the
gamma-ray horizon and measurements from some Imaging Atmospheric
Cherenkov Telescopes (IACTs) up to z=0.536.

\begin{figure}[H]

{\centering \includegraphics{images/ELB.png}

}

\caption{Source: Taken from
\href{http://arxiv.org/abs/0904.0774}{arXiv:0904.0774v2}}

\end{figure}%

\subsection{Gamma-ray Detection}\label{gamma-ray-detection}

\subsubsection{The atmosphere}\label{the-atmosphere-1}

The Earth's atmosphere is opaque to photons with energy above 10 eV,
meaning that to observe gamma-rays directly we need to place the
detector above the atmosphere. A turning point in gamma-ray astronomy
was the launch of the first satellite-borne telescope, SAS-2, in 1972.

\begin{figure}[H]

{\centering \includegraphics{index_files/mediabag/800px-atmospheric_el.png}

}

\caption{Source: scienceofdoom.wordpress.com}

\end{figure}%

The mayor limitation of satellite experiments is their low area which
limits their use to \(\leq 100\) GeV. At 100 GeV is when electromagnetic
showers from the initial photon can be detected in ground-based
telescopes.

\subsection{Cherenkov emission.}\label{cherenkov-emission.}

When relativistic particles traverse a medium at a speed greater than
the speed of light in that medium it can induce Cherenkov radiation.
Cherenkov light is emitted in the UV and blue region in a narrow cone
with angle:

\begin{figure}[H]

{\centering \includegraphics{index_files/mediabag/Cherenkov_radiation-.gif}

}

\caption{Source: Wikipedia}

\end{figure}%

\[\cos \theta = \frac{ct/n}{\beta c t} = \frac{1}{\beta n}\]

In the relativistic limit \(\beta \sim 1\) we can write:

\[\sin \theta = \sqrt{1 - \frac{1}{n^2}} = \sqrt{\frac{n^2 - 1}{n^2}} = \sqrt{\frac{(n-1)(n+1)}{n^2}} \approx \sqrt{2(n-1)}\]

In the atmosphere the spectral index depends on the altitude (same as
density and pressure):

\[n = 1 + \epsilon_0 e^{-h/h_0} \]

where \(\epsilon_0 \simeq 2.8 \times 10^{-4}\) at sea level.

\subsection{Tutorial II: Plot of the Cherenkov angle as funcion of the
spectral
index.}\label{tutorial-ii-plot-of-the-cherenkov-angle-as-funcion-of-the-spectral-index.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diffn }\OperatorTok{=}\NormalTok{ np.logspace(}\OperatorTok{{-}}\DecValTok{5}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{100}\NormalTok{) }\CommentTok{\#n {-} 1 form 0.0001 to 1}
\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{))}

\CommentTok{\#lets remove the values that will give errors in the arcsin:}
\NormalTok{diffn }\OperatorTok{=}\NormalTok{ diffn[np.where(np.sqrt(}\DecValTok{2}\OperatorTok{*}\NormalTok{diffn) }\OperatorTok{\textless{}=} \FloatTok{1.}\NormalTok{)]}

\CommentTok{\#In the relativistic limit }
\NormalTok{ax.plot(diffn, np.degrees(np.arcsin(np.sqrt(}\DecValTok{2}\OperatorTok{*}\NormalTok{diffn))))}
\NormalTok{ax.set\_yscale(}\StringTok{"log"}\NormalTok{)}
\NormalTok{ax.set\_xscale(}\StringTok{"log"}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{"n {-} 1 "}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"$\textbackslash{}theta\_C$ ($\^{}\textbackslash{}circ$)"}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{plt.show()}
\NormalTok{thetaw }\OperatorTok{=}\NormalTok{ np.degrees(np.arcsin(np.sqrt(}\DecValTok{2}\OperatorTok{*}\NormalTok{(}\FloatTok{1.33} \OperatorTok{{-}}\DecValTok{1}\NormalTok{))))}
\BuiltInTok{print}\NormalTok{(}\VerbatimStringTok{r"Cherenkov angle in water: $\textbackslash{}theta\_C = }\SpecialCharTok{\%.2f}\VerbatimStringTok{\^{}\{\textbackslash{}circ\}$"}\OperatorTok{\%}\NormalTok{thetaw)}
\CommentTok{\#For the atmosphere n = 1.0003}
\NormalTok{thetaatm }\OperatorTok{=}\NormalTok{ np.degrees(np.arcsin(np.sqrt(}\DecValTok{2}\OperatorTok{*}\NormalTok{(}\FloatTok{1.0003} \OperatorTok{{-}}\DecValTok{1}\NormalTok{))))}
\BuiltInTok{print}\NormalTok{(}\VerbatimStringTok{r"Cherenkov angle in the atmosphere: $\textbackslash{}theta\_C = }\SpecialCharTok{\%.2f}\VerbatimStringTok{\^{}\{\textbackslash{}circ\}$"}\OperatorTok{\%}\NormalTok{thetaatm)}
\end{Highlighting}
\end{Shaded}

\includegraphics{index_files/mediabag/chap4_files/figure-pdf/cell-5-output-1.pdf}

\begin{verbatim}
Cherenkov angle in water: $\theta_C = 54.33^{\circ}$
Cherenkov angle in the atmosphere: $\theta_C = 1.40^{\circ}$
\end{verbatim}

\subsection{Number of photons}\label{number-of-photons}

The number of photons from Cherenkov radiation follows the
\emph{Frank-Tamn} formula:

\[\frac{\mathrm{d}N}{\mathrm{d}x} = 2 \pi \alpha z^2\int_{\lambda_1}^{\lambda_2} \sin^2\theta \frac{\mathrm{d}\lambda}{\lambda^2}\]

For relativistic particles, \(\beta \sim 1\) in water \(n = 1.33\) the
Cherenkov spectrum is:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ scipy.constants }\ImportTok{as}\NormalTok{ cte}
\NormalTok{alpha }\OperatorTok{=}\NormalTok{ cte.alpha }\CommentTok{\#fine structure constant}

\NormalTok{fig, ax }\OperatorTok{=}\NormalTok{ plt.subplots(figsize}\OperatorTok{=}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{))}
\NormalTok{wl }\OperatorTok{=}\NormalTok{ np.arange(}\DecValTok{200}\NormalTok{, }\DecValTok{500}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{n }\OperatorTok{=} \FloatTok{1.33}
\NormalTok{ax.plot(wl, }\DecValTok{2} \OperatorTok{*}\NormalTok{ np.pi }\OperatorTok{*}\NormalTok{ alpha }\OperatorTok{*}\NormalTok{ ( }\DecValTok{1}\OperatorTok{{-}} \DecValTok{1}\OperatorTok{/}\NormalTok{n}\OperatorTok{**}\DecValTok{2}\NormalTok{)}\OperatorTok{/}\NormalTok{wl}\OperatorTok{**}\DecValTok{2}\NormalTok{)}
\NormalTok{ax.set\_xlabel(}\StringTok{"$\textbackslash{}lambda$ [nm]"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\VerbatimStringTok{r"$\textbackslash{}frac\{\textbackslash{}mathrm}\SpecialCharTok{\{d\}}\VerbatimStringTok{N\_\textbackslash{}gamma\}\{\textbackslash{}mathrm}\SpecialCharTok{\{d\}}\VerbatimStringTok{x \textbackslash{}mathrm\{ d\}\textbackslash{}lambda}\SpecialCharTok{\}\}}\VerbatimStringTok{$ (photons nm$\^{}\{{-}2\}$)"}\NormalTok{)}
\NormalTok{ax.grid()}
\NormalTok{plt.show()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
<>:8: SyntaxWarning: invalid escape sequence '\l'
<>:8: SyntaxWarning: invalid escape sequence '\l'
/var/folders/lx/66msvxgn7jbds1ygvq14q5z00000gn/T/ipykernel_17946/3882946818.py:8: SyntaxWarning: invalid escape sequence '\l'
  ax.set_xlabel("$\lambda$ [nm]")
\end{verbatim}

\begin{verbatim}
ValueError: 
$\frac{\mathrm{d}N_\gamma}{\mathrm{d}x \mathrm{ d}\lambda}}$ (photons nm$^{-2}$)
^
ParseException: Expected end of text, found '$'  (at char 0), (line:1, col:1)
\end{verbatim}

\begin{verbatim}
<Figure size 1500x1200 with 1 Axes>
\end{verbatim}

\subsection{Atmospheric extintion.}\label{atmospheric-extintion.}

Once in the atmosphere, the Cherenkov light can suffer absortion and
scattering due to several processes:

\begin{itemize}
\tightlist
\item
  Rayleigh scattering:
\end{itemize}

\[ I = I_0 \frac{8\pi^4 \alpha^2}{\lambda^4 R^2}(1 - \cos^2\theta)\]

where \(R\) is the distance to the particle and \(\theta\) the
scattering angle.

\begin{itemize}
\tightlist
\item
  Absortion by ozone, above 20 km.
\item
  Aerosol, dust. Independent of \(\lambda\).
\end{itemize}

\includegraphics{images/Cherenkov_NSB_spectra.png}

This processes change the Cherenkov spectrum dependending on the
altitude. In ice on the other hand, there is no UV absorption and the
Cherenkov spectrum keeps the \(1/\lambda^2\) tendency.

\section{Gamma-rays, Cosmic-Rays and
Neutrinos}\label{gamma-rays-cosmic-rays-and-neutrinos}

\subsection{Introduction}\label{introduction-2}

Both gamma-rays and neutrinos are produced as secondary products of
Cosmic-Rays interactions. The dominant channels are:

\[
\begin{aligned}
p\gamma &\rightarrow \Delta^+ \rightarrow \begin{cases}
  p \pi^0 & (2/3)\\
  n \pi^+ & (1/3)
  \end{cases}\\
pp &\rightarrow \begin{cases}
  pp \pi^0 & (2/3)\\
  nn \pi^+ & (1/3)
  \end{cases}
  \end{aligned}\]

The same processes occur with neutrons instead of protons leading to
\(\pi^-\) production. The resulting neutrons can decay or interact. One
assumption is that escaping neutrons decay as
\(n \rightarrow p + e^- + \nu_e\) producing the observed CRs. This is
called the \textbf{magnetic confiment models} in which the protons are
trapped in the magnetic fields and only neutrons escape. The
\textbf{Waxman-Bachall models} on the other hand assume that some
protons escape, and therefore the observed flux of cosmic rays is a
lower-limit on the total number of accelerated protons. In both
scenarios the charged and neutral pions will decay as:

\[\begin{aligned}
\pi^+ &\rightarrow \mu^+ \nu_\mu \rightarrow e^+ \nu_e \bar{\nu}_\mu \nu_\mu\\
\pi^- &\rightarrow \mu^- \bar{\nu}_\mu \rightarrow e^- \bar{\nu}_e \nu_\mu\bar{\nu}_\mu \\
\pi^0 &\rightarrow \gamma\gamma
\end{aligned}\]

Clearly the productions of neutrinos, cosmic-rays and \(\gamma\)-rays
are closely related.

\subsection{p-p interactions}\label{p-p-interactions}

For environments where radiation density is low (too few photons) \(pp\)
interactions dominate over \(p\gamma\) interactions. The cross section
of \(pp\) interactions is almost energy independent
\(\sigma_{pp} \sim 4 \times 10^{-26}\) cm\(^2\) (See
\href{\%22http://arxiv.org/abs/astro-ph/0606058\%22}{Kelner et al.}).
The cross section of this process has a threshold given by:

\[E_{th} = m_p + m_\pi(m_\pi + 4m_p)/2m_p \sim 1.2 \mathrm{\; GeV}\]

Therefore most of accelerated protons can interact in the source if
there is enough material and the spectra of secondary particles closely
follows that of the parent proton spectrum assuming the meson
\emph{cooling time} (we usually call \emph{cooling} to any process of
energy loss due to radiation) and interaction length are larger than
decay time/length (in other words, if the meson decays before loosing
energy or interacts).

\begin{itemize}
\item
  If the proton spectrum is \textbf{softer} than
  \(\mathrm{ d}N_p/\mathrm{ d}E \sim E^{-2}\), most of the
  electronmagnetic and neutrino power is in the energy band of 1 GeV.
  Gamma-ray emission is dominated by the \(\pi^0\) decay.
\item
  If the proton spectrum is \textbf{harder} than
  \(\mathrm{ d}N_p/\mathrm{ d}E \sim E^{-2}\), most of the energy ouput
  from proton interactions is at high energy. In this case the main
  contribution in gamma-ray comes from IC from secondary \(e^-e^+\)
  pairs produced in \(\pi^{\pm}\) decays.
\end{itemize}

\subsection{p-gamma interations}\label{p-gamma-interations}

The cross-section of this process has a higher energy threshold than
\(pp\) interactions given by:

\[E_{th} = \frac{m_p m_{\pi} + m_{\pi}^2}{\epsilon_{ph}} \simeq 7 \times 10^{16} \left[\frac{\epsilon_{ph}}{1\mathrm{\; eV}}\right]^{-1}\]

where \(\epsilon_{ph}\) is the target photon energy. Because this
threshold only the highest energy protons can efficiently interact with
the soft-photon fields. This process is the one typically considered for
UHECR and extragalactic sources such as AGNs and Gamma-ray Bursts.

\subsection{The Waxman-Bahcall neutrino
flux}\label{the-waxman-bahcall-neutrino-flux}

The neutrino flux from an optical thin (ie transparent for nucleon-meson
interactions) source is usually referred as the
\href{http://journals.aps.org/prd/abstract/10.1103/PhysRevD.64.023002}{Waxman-Bahcall
flux}.

To derive it let's assume only the extragalactic CR contribution. The
energy density is, as we calculated in Lecture 3 given by:

\[\rho_{CR} = \int E n(E) \mathrm{ d} E =4\pi \int_{E_{min}}^{E_{max}} \frac{E}{c}I(E) \mathrm{ d} E \sim 3\times 10^{-19} \mathrm{\; ergs\; cm^{-3}}\]

where assume the extreme energies of the accelerator to be
\(E_{max}/E_{min} \sim 10^{3}\). If the source is optically thin for
\(p\gamma\) and \(pp\) interactions then the energy flux of neutrinos
cannot be greater than that of cosmic-rays (this can only happen in an
optically thick source where cosmic-rays do not escape but only
neutrinos do). To estimate a bound then we can therefore assume that the
same energy density of cosmic rays ends up in neutrinos and
electromagnetic energy:

\[\int E_\nu I_\nu (E_\nu) \mathrm{ d}E_\nu = c \frac{\rho_{CR}}{4\pi}\]

Assuming that the neutrino follows a power law of spectrum with an
differential spectral index of 2 and a maximum \(E_{max} = 10^{8}\) GeV
the produced neutrino flux is:

\[E_\nu^2 I_\nu (E_\nu) \sim 5 \times 10^{-8} \mathrm{ \; GeV\; cm^{-2}\; s^{-1}\; sr^{-1}}\]

The Waxman-Bahcall flux is sometimes referred as a bound, in part
because more energy is transfer to the neutron than the charged pion
(roughtly a factor 4 times more) and so:

\[E_{\nu_\mu}^2 I_{\nu_\mu} (E_{\nu_\mu}) \sim 1 - 5 \times 10^{-8} \mathrm{ \; GeV\; cm^{-2}\; s^{-1}\; sr^{-1}}\]

The value derived above does not account for several things:

\begin{itemize}
\tightlist
\item
  There are more CR than observed at Earth due to the GZK-effect. It
  also ignores the evolution of the sources as red-shift \(\rightarrow\)
  \textbf{increase the neutrino flux.}
\item
  In \(p\gamma\) muon neutrinos (and antineutrinos) from the pion decay
  \(\pi^+ \rightarrow \mu^+ \nu_\mu \rightarrow e^+ \nu_e \bar{\nu}_\mu \nu_\mu\)
  only receive 1/2 of the energy of the charged pion (assuming each
  lepton carries the same energy) \(\rightarrow\) \textbf{decrease the
  neutrino flux}.
\end{itemize}

In practice these corrections compensate. The other uncertainty is from
where to chose \(E_{min}\) ie the transition to Galactic sources. In
general we can construct a more generic relation between the CR and
neutrino flux of the form of:

\[\rho_{CR}(E_{min}) = n_{\nu/p} \rho_{\nu}(E_{min}) = n_{\nu/p}\int_{E_{min}} n_\nu (E_\nu) E_\nu \mathrm{d} E_\nu\]

\[ n_{\nu/p} 4\pi \int_{E_{min}} \frac{I_\nu (E_\nu)}{c} E_\nu \mathrm{d} E_\nu = 4\pi \int_{E_{min}} \frac{I_p (E_p)}{c} E_p \mathrm{d} E_p \]

where \(n_{\nu/p}\) refers to the number of neutrinos per proton
interaction. Ignoring the integrals we get the relation:

\[E_\nu I_\nu (E_\nu) \sim n_{\nu/p} E_p I_p (E_p)\]

Using that the energy of the neutrinos will be a fraction
\(\langle x_{p\rightarrow \nu} \rangle\) of the proton energy we can
rewrite it as:

\[I_\nu (E_\nu) \sim n_{\nu/p} \frac{1}{\langle x_{p\rightarrow \nu} \rangle} I_p (E_p)\]

\subsection{The neutrino and gamma
connection}\label{the-neutrino-and-gamma-connection}

\subsubsection{Extragalactic p-gamma: Energy
fraction}\label{extragalactic-p-gamma-energy-fraction}

Due to isospin the \(\Delta^+\) decays more often to \(p\) than \(n\).
\[
p\gamma \rightarrow \Delta^+ \rightarrow \begin{cases}
p \pi^0 & (2/3)\\
  n \pi^+ & (1/3)
  \end{cases}\]

In both cases, the fraction of energy that goes to the pions is
\(\langle x_{p\rightarrow\pi}\rangle \sim 0.20\) . Assuming the pion
decays:

\[\pi^0 \rightarrow \gamma\gamma, \mathrm{\;and\;} \pi^+ \rightarrow \mu^+ \nu_\mu \rightarrow e^+ \nu_e \bar{\nu}_\mu \nu_\mu\]

We have that: 1. \(\gamma\)'s take 1/2 of the neutral pion energy. 2.
Leptons take 1/4 of the charge pion energy.

And so:

\[\begin{aligned}
\langle x_{p\rightarrow\nu}\rangle &= \frac{1}{4}\langle x_{p\rightarrow\pi}\rangle =\frac{1}{20}\\
\langle x_{p\rightarrow\gamma}\rangle &= \frac{1}{2}\langle x_{p\rightarrow\pi}\rangle =\frac{1}{10}
\end{aligned}\]

\subsubsection{Extragalactic p-gamma: Number of
particles}\label{extragalactic-p-gamma-number-of-particles}

If we consider only \(\nu_\mu\) we have 2 \(\nu_\mu\) per pion decay, as
well as 2 \(\gamma\)'s per pion decay. So the spectra can be related as:

\[\begin{aligned}
    I_{\nu_\mu}(E_{\nu_\mu}) &= 2 \times \frac{1}{3} \frac{1}{\langle x_{p\rightarrow\nu}\rangle} I_{p}(E_{p})\\
    I_{\gamma}(E_{\gamma}) &= 2\times \frac{2}{3} \frac{1}{\langle x_{p\rightarrow\gamma}\rangle}I_{p}(E_{p})
\end{aligned}\]

Let's assume a proton spectrum \(I_p(E_p) \propto E_p^{-2}\) and so
\(I_p(E_p)\propto E_{\nu_\mu}^{-2}\langle x_{p\rightarrow\nu}\rangle^2\)

\[\begin{aligned}
    I_{\nu_\mu}(E_{\nu_\mu}) \propto 2 \times \frac{1}{3} \langle x_{p\rightarrow\nu}\rangle E_{\nu_\mu}^{-2} \rightarrow 2 \times \frac{1}{3} \times \frac{1}{20} E_{\nu_\mu}^{-2}\\
    I_\gamma(E_\gamma) \propto 2 \times \frac{2}{3}\langle x_{p\rightarrow\gamma}\rangle  E_\gamma^{-2} \rightarrow  2 \times \frac{2}{3} \times \frac{1}{10} E_{\gamma}^{-2}
\end{aligned}\]

So:

\[I_{\nu_\mu} (E_{\nu_\mu}) \sim \frac{1}{4} I_{\gamma}(E_\gamma)\]

\subsubsection{\texorpdfstring{Galactic
\emph{pp}}{Galactic pp}}\label{galactic-pp}

In a matter dominated environtment such as Galactic SN shocks CRs
interact with the H in the Galactic disk via pp interactions. As we saw
these interactions have a lower threshold than \(p\gamma\). Let's
consider the reaction:

\[p + p \rightarrow p + p + \pi^0 + \pi^+ \pi^-\]

where we assume that pions are produced with the same probability (1/3).
Doing the same calculation as before we get that:

\[\begin{aligned}
    I_{\nu_\mu}(E_{\nu_\mu}) &\propto 2 \times \frac{1}{3} \langle x_{p\rightarrow\nu}\rangle E_{\nu_\mu}^{-2} \rightarrow 2 \times \frac{2}{3} \times \frac{1}{20} E_{\nu_\mu}^{-2}\\
    I_\gamma(E_\gamma) &\propto 2 \times \frac{2}{3}\langle x_{p\rightarrow\gamma}\rangle  E_\gamma^{-2} \rightarrow  2 \times \frac{1}{3} \times \frac{1}{10} E_{\gamma}^{-2}
\end{aligned}\]

\subsubsection{Astrophysical Neutrino
Oscillations}\label{astrophysical-neutrino-oscillations}

In the discussion above we focused on muon neutrinos, however we ignored
the fact that neutrino oscillate. We saw that the probability of
neutrino flavor for \(\delta = 0\) can be written as:

\[\begin{aligned}
P(\nu_\alpha \rightarrow \nu_\beta) &=\sum_j\sum_i U_{\alpha i}U^*_{\beta i}U^*_{\alpha  j}U_{\beta j}e^{-i\frac{\Delta m^2L}{2E}}\\
&= \delta_{\alpha\beta}  -  4{\sum_{i>j}\mathrm{ Re}(U_{\alpha i}^{*}U_{\beta i}U_{\alpha j}U_{\beta j}^{*}})\sin^{2}(\frac{\Delta m_{ij}^{2}L}{4E})
\end{aligned}\]

For a non-monochromatic neutrino beam, the probability has to be
averaged over the spectrum. The \(\sin\) term will be averaged to 0.5
for large distances \(L\). And thus the probability does not depend on
time and can be written as a matrix:

\[P(\nu_\alpha \rightarrow \nu_\beta) = \sum_j |U_{\alpha  j}|^2 |U_{\beta j}|^2 \]

\subsection{Tutorial II: Calculation of astrophysical neutrino
oscillations}\label{tutorial-ii-calculation-of-astrophysical-neutrino-oscillations}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ scipy }\ImportTok{as}\NormalTok{ sp}

\KeywordTok{def}\NormalTok{ PMNS\_Factory(t12, t13, t23, d):}
\NormalTok{    s12 }\OperatorTok{=}\NormalTok{ np.sin(t12)}
\NormalTok{    c12 }\OperatorTok{=}\NormalTok{ np.cos(t12)}
\NormalTok{    s23 }\OperatorTok{=}\NormalTok{ np.sin(t23)}
\NormalTok{    c23 }\OperatorTok{=}\NormalTok{ np.cos(t23)}
\NormalTok{    s13 }\OperatorTok{=}\NormalTok{ np.sin(t13)}
\NormalTok{    c13 }\OperatorTok{=}\NormalTok{ np.cos(t13)}
\NormalTok{    cp  }\OperatorTok{=}\NormalTok{ np.exp(}\OtherTok{1j}\OperatorTok{*}\NormalTok{d)}
    \ControlFlowTok{return}\NormalTok{ np.array([[ c12}\OperatorTok{*}\NormalTok{c13, s12}\OperatorTok{*}\NormalTok{c13, s13}\OperatorTok{*}\NormalTok{np.conj(cp) ],}
\NormalTok{                  [}\OperatorTok{{-}}\NormalTok{s12}\OperatorTok{*}\NormalTok{c23 }\OperatorTok{{-}}\NormalTok{ c12}\OperatorTok{*}\NormalTok{s23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp, c12}\OperatorTok{*}\NormalTok{c23 }\OperatorTok{{-}}\NormalTok{ s12}\OperatorTok{*}\NormalTok{s23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp, s23}\OperatorTok{*}\NormalTok{c13],}
\NormalTok{                  [ s12}\OperatorTok{*}\NormalTok{s23 }\OperatorTok{{-}}\NormalTok{ c12}\OperatorTok{*}\NormalTok{s23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp,}\OperatorTok{{-}}\NormalTok{c12}\OperatorTok{*}\NormalTok{s23 }\OperatorTok{{-}}\NormalTok{ s12}\OperatorTok{*}\NormalTok{c23}\OperatorTok{*}\NormalTok{s13}\OperatorTok{*}\NormalTok{cp, c23}\OperatorTok{*}\NormalTok{c13]])}

\CommentTok{\#\#Probability of flavor change when L{-}\textgreater{}inf}
\KeywordTok{def}\NormalTok{ Prob(a, b, U):}
    \CommentTok{"""}
\CommentTok{    Gives the oscillation probability for nu(a) {-}\textgreater{} nu(b)}
\CommentTok{    for PMNS matrix U, and L in km and E in GeV}
\CommentTok{    """}
\NormalTok{    s }\OperatorTok{=} \DecValTok{0}
    \ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{3}\NormalTok{):}
\NormalTok{            s }\OperatorTok{+=}\NormalTok{ (np.conj(U[a,i])}\OperatorTok{*}\NormalTok{U[b,i]}\OperatorTok{*}\NormalTok{U[a,i]}\OperatorTok{*}\NormalTok{np.conj(U[b,i])).real}
    \ControlFlowTok{return}\NormalTok{ s}


\KeywordTok{def}\NormalTok{ ProbMatrix(U):}
    \ControlFlowTok{return}\NormalTok{ np.array([[Prob(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, U), Prob(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, U), Prob(}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{,U)],}
\NormalTok{                     [Prob(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, U), Prob(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, U), Prob(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,U)],}
\NormalTok{                     [Prob(}\DecValTok{2}\NormalTok{, }\DecValTok{0}\NormalTok{, U), Prob(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, U), Prob(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,U)]])}
                     

\NormalTok{t12 }\OperatorTok{=}\NormalTok{ np.arcsin(}\FloatTok{0.306}\OperatorTok{**}\FloatTok{0.5}\NormalTok{)}
\NormalTok{t13 }\OperatorTok{=}\NormalTok{ np.arcsin(}\FloatTok{0.0251}\OperatorTok{**}\FloatTok{0.5}\NormalTok{)}
\NormalTok{t23 }\OperatorTok{=}\NormalTok{ np.arcsin(}\FloatTok{0.42}\OperatorTok{**}\FloatTok{0.5}\NormalTok{)}
\NormalTok{U }\OperatorTok{=}\NormalTok{ PMNS\_Factory(t12, t13, t23, }\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The probability of a neutrino flavor fector of
\((\nu^{source}_e, \nu^{source}_\mu, \nu^{source}_\tau)\) to change into
a flavor vector \((\nu^{Earth}_e, \nu^{Earth}_\mu, \nu^{Earth}_\tau)\)
is given by:

\[\begin{pmatrix}\left.\nu^{Earth}_e \\ \nu^{Earth}_\mu \\ \nu^{Earth}_\tau\right.\end{pmatrix} = P_{\alpha\beta} \begin{pmatrix}\left.\nu^{Source}_e \\ \nu^{Source}_\mu \\ \nu^{Source}_\tau\right.\end{pmatrix} \]

Assuming at the source the flavor ratio is (1:2:0) we have that:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Prob(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, U) }\OperatorTok{+}\NormalTok{ Prob(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, U) }\OperatorTok{+}\NormalTok{ Prob(}\DecValTok{2}\NormalTok{, }\DecValTok{0}\NormalTok{, U)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
1.005381376348095
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{source }\OperatorTok{=}\NormalTok{ np.array([}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{])}
\NormalTok{P }\OperatorTok{=}\NormalTok{ ProbMatrix(U)}
\NormalTok{Earth }\OperatorTok{=}\NormalTok{ np.dot(P, source)}
\BuiltInTok{print}\NormalTok{ (Earth)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1.00538138 1.00204305 1.00854641]
\end{verbatim}

Thus, almost equal number of eletron, muon and tau astrophysical
neutrinos are expected to be observed at Earth due to oscillations. More
info at \href{http://arxiv.org/abs/hep-ph/0005104}{arXiv:hep-ph/0005104}

\subsection{Gamma-ray neutrino
relation}\label{gamma-ray-neutrino-relation}

After oscillations the neutrino and gamma-rays relations are given by:

\[\frac{\mathrm{ d}N_\nu}{\mathrm{ d}E_\nu} = \frac{1}{2}\frac{\mathrm{ d}N_\gamma}{\mathrm{ d}E_\gamma} \mathrm{\; for\;} p + p\]

\[\frac{\mathrm{ d}N_\nu}{\mathrm{ d}E_\nu} = \frac{1}{8}\frac{\mathrm{ d}N_\gamma}{\mathrm{ d}E_\gamma} \mathrm{\; for\;} p + \gamma\]

Assuming an \(E^{-2}\) spectrum.

\subsection{Neutrino Astronomy}\label{neutrino-astronomy}

\subsection{Diffuse flux of Astrophysical
Neutrinos}\label{diffuse-flux-of-astrophysical-neutrinos}

The first detection of high-energy neutrinos of cosmic origin in 2013 by
the IceCube Neutrino Observatory opened a new window to the non-thermal
processes in our universe. The first strong evidence for a cosmic
neutrino component came from a search using data from May 2010 to April
2012 {[}35{]}, where two shower-like events from interactions within the
detector with energies above 1 PeV were discovered. A follow-up search
for events starting in the detector with more than 30 TeV deposited
energy that utilized the same dataset identified 25 additional
high-energy events. The spectrum and zenith angle distribution of the
events was incompatible with the hypothesis of an atmospheric origin at
\textgreater{} \(4\sigma\). IceCube has since collected independent
evidence for an astrophysical neutrino signal by analyzing different
event signatures.

\subsubsection{Starting Events}\label{starting-events}

Neutrino interactions are identified in IceCube by searching for an
interaction vertex within the instrumented volume. This search is
sensitive to both shower-like and track-like events. Since the main
background for this search is comprised of muons from CR air showers,
the rejection strategy is to identify Cherenkov photons from a track
entering the detector. For that, the outer parts of the instrumented
volume are assigned to a ``veto'' region. An event is rejected if a
certain number of Cherekov photons are found in this veto region at
earlier times than the photons produced at the interaction vertex. The
energy threshold for this analysis is about \(E_\nu \sim 30\) TeV.

\subsubsection{Through-going muons}\label{through-going-muons}

Muons produced in CC neutrino interactions far outside the detector can
still reach the instrumented volume to produce track-like events. Even
at 1 TeV a muon can penetrate several kilometers of ice before it stops
and decays. This allows observation of high-energy neutrino interactions
from a much larger volume than the instrumented one, thereby
substantially increasing the effective area of the detector.

\subsubsection{The spectral fit}\label{the-spectral-fit}

The results of a combined analysis fits the neutrino flux to a power-law
between 27 TeV and 2 PeV consistent with an unbroken power law with a
best-fit spectral index of \(-2.49 \pm 0.08\) given by:

\[E^2\Phi(E) = 2.06^{+0.35}_{-0.26} \times 10^{-8} \left(\frac{E}{100 \rm{ TeV}}\right)^{-0.46\pm 0.12} \mathrm{ GeV s}^{-1}\rm{ sr}^{-1}\mathrm{ cm}^{-2}.\]

However using only the high energy through-going muons (abouve 200 TeV)
yields a preferred spectral index of \(-2.13\pm 0.13\)

\subsection{The Search for Point
Sources}\label{the-search-for-point-sources}

In the case where the cosmic neutrino flux is dominated by bright
individual sources, they should be detectable as a local excess of
events on the sky with respect to the atmospheric neutrino and diffuse
cosmic neutrino background. The sensitivity of a search for such
features depends crucially on the precision by which the direction of
the neutrinos can be reconstructed from the data, i.e.~on the detector
angular resolution. No indication for a neutrino point source has been
found in the IceCube data so far. The null result of a point-source of
neutrinos, can be transformed into an flux upper limit at a given
confidence level. This upper limits represents the neutrino flux that we
can be certain to exclude, since IceCube did not see a point source.

\begin{figure}[H]

{\centering \includegraphics{images/upperlimits.png}

}

\caption{Source: IceCube}

\end{figure}%

\subsection{The Olbers' Paradox}\label{the-olbers-paradox}

Altough the most famous formulation of the problem comes from Henrich
Olbers (1826), probably it was Kepler in 1610 the first to note that the
most obvious observation, the night sky is dark, has very important
consequences.

\includegraphics{index_files/mediabag/images/olber.pdf}

The idea is quite simple, suppose there is a source population with
typical luminosity \(L\) in ergs/s and a number density of \(n\), then
the total power emitted per unit area will be:

\[ F = \int L n \frac{dV}{4\pi^2} = \frac{1}{4\pi}\int L n \mathrm{ d}\Omega \mathrm{ d}r\]

Integrating over all distances we can obtain the energy per steradian
per second, and assuming the luminosity is independent of distance as
well as number density we have that:

\[\frac{\mathrm{ d} F}{\mathrm{ d}\Omega} = \frac{1}{4\pi} L n \int_0^{\infty} \mathrm{ d}r \rightarrow \infty\]

The sky should be bright! The solution of this puzzle is the fact the
Universe is dynamic and time dependent! In other words, if the Universe
is expanding the radiation from increasingly distant sources is
increasingly less. Also stars seems to have had a cosmological
evolution, for example, there are more quasars per unit volume at
\(z \sim 2\) than now.

Although the Olbers' paradox is no more a paradox, it represents the
\emph{problem} that arises with neutrino astronomy. Since the
extragalactic space is completely transparent for neutrinos, the flux of
neutrinos that might arrive at Earth will have a significant
contribution from very distant and faint sources. Let's assume now a
source population with typical neutrino luminosity \(L\nu(E)\) and with
a number density population given by:

\[n(z) = n_0 (1+z)^m\]

where \(n_0\) is the \emph{local density} of the source population, (ie
the population close to our epoch \(z = 0\)). The parameter \(m\)
describes the source cosmological evolution (ie, when sources to appear
in the history of the Universe, and how they evolved). Typical values
are \(m= 3\) for star--formation--like evolution and \(m=0\) for no
evolution.

Since the Universe expands and sources move with the \emph{Huble flow}
we are going to use the comoving line of sight distance, defined as (see
Lecture 2):

\[D_c(z) = \int_{t}^{t_0} c\mathrm{ d} t = \frac{c}{H_0} \int^z_0 \frac{\mathrm{ d}z^\prime}{E(z^\prime)}\]

where we introduced the function:

\[E(z)\equiv \sqrt{\Omega_M(1+z)^4 + \Omega_r(1+z)^5 + \Omega_k(1+z)^3 +\Omega_\Lambda(1+z)}\]

revisiting the formula of the energy rate of neutrinos per steroradian
we have:

\[\frac{\mathrm{ d} F_\nu}{\mathrm{ d}\Omega} = \frac{1}{4\pi} \frac{c}{H_0}\int_0^{\infty} \frac{L_\nu(E_\nu) n_0(1+z)^m}{E(z)} \mathrm{ d}z\]

The expresion above needs an extra correction. We assumed that energy
emitted by the source will be the same at the arrival, however energy
will be red-shifted according to \(E_\nu (1 + z)\) so the formula it's
technically:

\[\frac{\mathrm{ d} F_\nu}{\mathrm{ d}\Omega} = \frac{1}{4\pi} \frac{c}{H_0}\int_0^{\infty} \frac{L_\nu(E_\nu(1+z)) n_0(1+z)^m}{E(z)} \mathrm{ d}z\]

Assuming the luminosity follows a power law with,
\(L_\nu \propto E^{-\gamma}\), we can rewrite the expression as:

\[\frac{\mathrm{ d} F_\nu}{\mathrm{ d}\Omega} = \xi \frac{c}{H_0} \frac{L_\nu(E_\nu) n_0}{4\pi} \]

where the unit-less parameter \(\xi\) is the integral that contains
information on the expansion and cosmological evolution of the sources
and the spectral index of the sources defined as:

\[\xi = \int_0^{\infty}\frac{(1+z)^{(m - \gamma)}\mathrm{ d} z}{E(z)}\]

Assuming an spectral index of 2, and expressing it as function of the
scale factor knowing that:

\[\frac{\mathrm{ d}z}{1+z} = - \frac{\mathrm{ d}a}{a} \rightarrow \mathrm{ d}z = -\frac{\mathrm{ d}a}{a^2}\]

and that \(z = \infty \rightarrow a = 0\), \(z = 0 \rightarrow a = 1\),
we can rewrite the integral as:

\[\xi = \int_0^{1}\frac{a^{-m} \mathrm{ d} a}{E(a)}\]

Where it will depend on the cosmic evolution of the sources. Typical
star forming rate evolution (SFR) has an evolution of \(m = 3.4\) in our
local universe \$z\textless1 \$ and \(m=-0.3\) for \$ 1\textless{}
z\textless{} 4\$ and \(m=-3.5\) elsewhere.

\subsection{\texorpdfstring{Tutorial III: Calculate the value of
\(\xi\)}{Tutorial III: Calculate the value of \textbackslash xi}}\label{tutorial-iii-calculate-the-value-of-xi}

We are going to calculate the value of the parameter \(\xi\) for
different cosmological evolution of the sources. The SFR evolution is
given by the following broken power law formula:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ rho(z):}
    \ControlFlowTok{if}\NormalTok{ z }\OperatorTok{\textless{}} \FloatTok{1.}\NormalTok{:}
        \ControlFlowTok{return}\NormalTok{ (}\FloatTok{1.} \OperatorTok{+}\NormalTok{ z)}\OperatorTok{**}\FloatTok{3.4}
    \ControlFlowTok{elif}\NormalTok{ z }\OperatorTok{\textgreater{}=} \FloatTok{1.} \KeywordTok{and}\NormalTok{ z }\OperatorTok{\textless{}=} \FloatTok{4.}\NormalTok{:}
        \ControlFlowTok{return}\NormalTok{ (}\DecValTok{1}\OperatorTok{+}\FloatTok{1.}\NormalTok{)}\OperatorTok{**}\FloatTok{3.4} \OperatorTok{*}\NormalTok{ ((}\FloatTok{1.}\OperatorTok{+}\NormalTok{z)}\OperatorTok{/}\NormalTok{(}\FloatTok{1.}\OperatorTok{+}\FloatTok{1.}\NormalTok{))}\OperatorTok{**{-}}\FloatTok{0.3}
    \ControlFlowTok{else}\NormalTok{:}
        \ControlFlowTok{return}\NormalTok{ (}\FloatTok{1.}\OperatorTok{+}\FloatTok{1.}\NormalTok{)}\OperatorTok{**}\FloatTok{3.4}\OperatorTok{*}\NormalTok{((}\FloatTok{1.}\OperatorTok{+}\FloatTok{4.}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\FloatTok{1.}\OperatorTok{+}\FloatTok{1.}\NormalTok{))}\OperatorTok{**{-}}\FloatTok{0.3}\OperatorTok{*}\NormalTok{((}\FloatTok{1.}\OperatorTok{+}\NormalTok{z)}\OperatorTok{/}\NormalTok{(}\FloatTok{1.}\OperatorTok{+}\FloatTok{4.}\NormalTok{))}\OperatorTok{**{-}}\FloatTok{3.5}
    
\NormalTok{ax }\OperatorTok{=}\NormalTok{ plt.subplot(}\DecValTok{111}\NormalTok{)}

\NormalTok{z }\OperatorTok{=}\NormalTok{ np.linspace(}\DecValTok{0}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{1000}\NormalTok{)}
\NormalTok{vrho }\OperatorTok{=}\NormalTok{ np.vectorize(rho)}

\NormalTok{ax.plot(z, vrho(z))}
\NormalTok{ax.set\_xlabel(}\StringTok{"z"}\NormalTok{)}
\NormalTok{ax.set\_ylabel(}\StringTok{"$n\_}\SpecialCharTok{\{SFR\}}\StringTok{(z)/n\_0$"}\NormalTok{)}
\NormalTok{ax.grid()}

\ImportTok{from}\NormalTok{ astropy.cosmology }\ImportTok{import}\NormalTok{ Planck13 }\ImportTok{as}\NormalTok{ cosmo}
\ImportTok{from}\NormalTok{ scipy }\ImportTok{import}\NormalTok{ integrate}

\KeywordTok{def}\NormalTok{ xi(z):}
    \ControlFlowTok{return}\NormalTok{ cosmo.H0.value}\OperatorTok{/}\NormalTok{cosmo.H(z).value }\OperatorTok{*}\NormalTok{ rho(z) }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ z)}\OperatorTok{**}\NormalTok{(}\OperatorTok{{-}}\DecValTok{2}\NormalTok{)}

\NormalTok{integral }\OperatorTok{=}\NormalTok{ integrate.quad(}\KeywordTok{lambda}\NormalTok{ z: xi(z), }\FloatTok{0.}\NormalTok{, np.inf)[}\DecValTok{0}\NormalTok{]}

\BuiltInTok{print}\NormalTok{(}\VerbatimStringTok{r"$\textbackslash{}xi$ = }\SpecialCharTok{\%.2f}\VerbatimStringTok{ for an evolution of SFR"} \OperatorTok{\%}\NormalTok{(integral))}

\NormalTok{integral }\OperatorTok{=}\NormalTok{ integrate.quad(}\KeywordTok{lambda}\NormalTok{ z: cosmo.H0.value}\OperatorTok{/}\NormalTok{cosmo.H(z).value  }\OperatorTok{*}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ z)}\OperatorTok{**}\NormalTok{(}\OperatorTok{{-}}\DecValTok{2}\NormalTok{), }\FloatTok{0.}\NormalTok{, }\DecValTok{2}\NormalTok{)[}\DecValTok{0}\NormalTok{]}

\BuiltInTok{print}\NormalTok{(}\VerbatimStringTok{r"$\textbackslash{}xi$ = }\SpecialCharTok{\%.2f}\VerbatimStringTok{ for no cosmological evolution up to redshift z \textless{} 2"} \OperatorTok{\%}\NormalTok{(integral))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$\xi$ = 2.39 for an evolution of SFR
$\xi$ = 0.48 for no cosmological evolution up to redshift z < 2
\end{verbatim}

\includegraphics{index_files/mediabag/chap4_files/figure-pdf/cell-10-output-2.pdf}

Therefore the parameter \(\xi\) varies between \(0.5\sim 3\). We can
equate this total neutrino flux per steroradian to the flux observed by
IceCube (assuming an spectral index of 2):

\[\xi \frac{c}{H_0} \frac{L_\nu(E_\nu) n_0}{4\pi} = E^2 \Phi_\nu \sim 2.06 \times 10^{-8} \frac{\mathrm{ GeV}}{\mathrm{ cm}^2\mathrm{ s\;} \mathrm{ sr}}\]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#I\textquotesingle{}m going to use units to avoid stupid mistakes}
\ImportTok{import}\NormalTok{ astropy.units }\ImportTok{as}\NormalTok{ u}
\ImportTok{from}\NormalTok{ astropy }\ImportTok{import}\NormalTok{ constants }\ImportTok{as}\NormalTok{ const}
\ImportTok{from}\NormalTok{ IPython.display }\ImportTok{import}\NormalTok{ display, Markdown}

\NormalTok{xi }\OperatorTok{=} \FloatTok{0.48}

\NormalTok{icecube\_flux }\OperatorTok{=} \FloatTok{2.06e{-}8} \OperatorTok{*}\NormalTok{ u.GeV}\OperatorTok{/}\NormalTok{u.cm}\OperatorTok{**}\DecValTok{2}\OperatorTok{/}\NormalTok{u.s}\OperatorTok{/}\NormalTok{u.sr}

\NormalTok{Ln }\OperatorTok{=}\NormalTok{ icecube\_flux }\OperatorTok{*}\NormalTok{ cosmo.H0.to(}\DecValTok{1}\OperatorTok{/}\NormalTok{u.s)}\OperatorTok{/}\NormalTok{const.c.to(u.Mpc}\OperatorTok{/}\NormalTok{u.s) }\OperatorTok{*} \DecValTok{4} \OperatorTok{*}\NormalTok{ np.pi }\OperatorTok{*}\NormalTok{ u.sr }\OperatorTok{*}\NormalTok{ xi}
\NormalTok{Ln }\OperatorTok{=}\NormalTok{ Ln.to(u.erg}\OperatorTok{/}\NormalTok{u.Mpc}\OperatorTok{**}\DecValTok{3}\OperatorTok{/}\NormalTok{u.yr)}

\NormalTok{display(Markdown(}\VerbatimStringTok{r"$n\_0 L\_\textbackslash{}nu \textbackslash{}sim$ }\SpecialCharTok{\{0:.1e\}}\VerbatimStringTok{ }\SpecialCharTok{\{1\}}\VerbatimStringTok{"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(Ln.value, Ln.unit.to\_string(}\StringTok{"latex"}\NormalTok{))))}
\end{Highlighting}
\end{Shaded}

\(n_0 L_\nu \sim\) 1.4e+43 \(\mathrm{\frac{erg}{yr\,Mpc^{3}}}\)

ie, it reaches the value of:

\[n_0 L_\nu \sim 10^{43} \frac{\mathrm{erg}}{\mathrm{Mpc}^3\mathrm{yr}}\]

note that this is almost independent of the value of \(xi\). We can
represent this relation in a diagram now called Kowalski's plot:

\begin{figure}[H]

{\centering \includegraphics{images/kowalski2.png}

}

\caption{Source: Taken from
\href{https://arxiv.org/pdf/1411.4385.pdf}{arxiv:1411.4385}}

\end{figure}%

Constrains can also be obtained from the point-source limits. The
argument is as follows, if the source population that is responsible of
the diffuse astrophysical flux observed in IceCube, is rate (has a low
density) then the closest of these sources should have provided a signal
in the point-source analysis. Let's assume that \(d\) is the distance to
the nearest source for a source population with local density \(n_0\)
so:

\[n_0 \frac{4}{3} \pi d^3 = 1\]

since there is 1 source in an sphere of radius \(d\). We can estimate
the closest distance to a source of this population as:

\[ d = \left(\frac{1}{\frac{4}{3}\pi n_0}\right)^{1/3} \propto n_0^{-1/3}\]

and thus the estimated neutrino flux for this single point-source is:

\[E^2 \Phi^{ps}_\nu = \frac{L_\nu}{4\pi d^2} \sim L_\nu n_0^{2/3}\]

A typical value of the neutrino point-source upper limits can be
obtained for the Northern sky as:

\[E^2 \Phi^{u.l.}_\nu \leq 2 \times 10^{-9} \mathrm{ GeV} \mathrm{ cm}^{-2}\mathrm{ s}^{-1} \]

so we have the 2 constrains together:

\[n_0^{-1/3} \leq \frac{\Phi^{u.l.}}{10^{43}\frac{\mathrm{erg}}{\mathrm{Mpc}^3\mathrm{yr}}}\]

which leads to the following condition on the local density of sources
from the point-source upper limits:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flux\_upperlimit }\OperatorTok{=} \FloatTok{2e{-}9} \OperatorTok{*}\NormalTok{ u.GeV}\OperatorTok{/}\NormalTok{u.cm}\OperatorTok{**}\DecValTok{2} \OperatorTok{/}\NormalTok{ u.s}

\NormalTok{n0 }\OperatorTok{=}\NormalTok{ np.power(flux\_upperlimit}\OperatorTok{/}\NormalTok{Ln, }\OperatorTok{{-}}\DecValTok{3}\NormalTok{)}
\NormalTok{n0 }\OperatorTok{=}\NormalTok{ n0.to(u.Mpc}\OperatorTok{**{-}}\DecValTok{3}\NormalTok{)}

\NormalTok{display(Markdown(}\VerbatimStringTok{r"$n\_0 \textbackslash{}geq$ }\SpecialCharTok{\{0:.1e\}}\VerbatimStringTok{ }\SpecialCharTok{\{1\}}\VerbatimStringTok{"}\NormalTok{.}\BuiltInTok{format}\NormalTok{(n0.value, n0.unit.to\_string(}\StringTok{"latex\_inline"}\NormalTok{))))}
\end{Highlighting}
\end{Shaded}

\(n_0 \geq\) 2.8e-06 \(\mathrm{Mpc^{-3}}\)

\subsubsection{References}\label{references-2}

\begin{itemize}
\tightlist
\item
  High energy neutrinos in the context of multimessenger astrophysics.
  J. Becker \href{https://arxiv.org/abs/0710.1557}{arXiv:0710.1557v2}
\item
  Cosmic Neutrinos from the Sources of Galactic and Extragalactic Cosmic
  Rays. F. Halzen
  \href{https://arxiv.org/pdf/astro-ph/0611915.pdf}{arxiv:0611915}
\end{itemize}

\bookmarksetup{startatroot}

\chapter{Dark Matter}\label{dark-matter}

\section{Existance of Dark Matter}\label{existance-of-dark-matter}

There are several hints or proves of the existance of additional matter
not visible.

\subsection{1. The mass-to-light ratios}\label{the-mass-to-light-ratios}

The sun has a ratio of \(\frac{M_{\odot}}{\mathcal{L}_{\odot}} \sim 1\)
Our milky way \(M_{MW}/\mathcal{L}_{MW} \sim 10\). Galaxy cluster
\(M_{cluster}/\mathcal{L}_{cluster} \sim 500\)

\subsubsection{The virial theorem}\label{the-virial-theorem}

Apart from the mass-to-light rations another evidance of missing mass
came from two different ways of estimating the mass of galaxie clusters.
For that let's review what is the virial theorem:

In a system made of particles (like galaxies) with momemtum the scalar G
is defined by the equation:

\[ G = \sum_{k = 1}^{N} \vec{p}_k\vec{r}_k \]

where \(\vec{p}_k\) is the momemtum of the \(k\) particule and
\(\vec{r}_k\) its possition. The average of the time derivative of \(G\)
is 0 in bound systems, ie, in systems that are holding together forever,
like galaxies in galaxy cluster bound by gravity. The virial theorem
states that in systems where \(G\) is constant,
(\(\langle \mathrm{d} G/\mathrm{d} t \rangle_\tau = 0\)), then:

\[\langle T \rangle = - \frac{1}{2} \sum^{N}_{k=1}   \langle \vec{F}_k  \cdot \vec{r}_k \rangle \]

Zwicky was the first to use the virial theorem to infer the existence of
unseen matter while examining the Coma galaxy cluster in 1933. In a
common case the potential of a system can be described:

\[V(r_{kj}) =  \alpha r_{kj}^n\]

where the total potential energy is:

\[V_{TOT} = \sum_{k = 1}^N \sum_{j > k} V (r_{kj}) \]

and so the virial theorem can be rewriten as:

\[\langle T \rangle = - \frac{1}{2} \sum^{N}_{k=1}   \langle \vec{F}_k  \cdot \vec{r}_k \rangle =  \frac{1}{2} \sum^{N}_{k=1}\sum_{j > k} \frac{\mathrm{d} V}{\mathrm{d}r} r_{kj} = \frac{1}{2} \sum^{N}_{k=1}\sum_{j > k} n \alpha r_{kj}^{n-1} r_{kj}\]

\[2\langle T \rangle = n \langle V_{TOT} \rangle \]

in the particular case of gravitational systems we have that \(n = -1\).
Ie, by measuring the kinetic energy of the system, we can infer the
total gravitational potential and hence the mass:

\[\langle V_{TOT} \rangle = - G_N \frac{M_{TOT}^2}{\langle r \rangle}\]

while the total kinetic energy can be written as

\[\langle T \rangle = \frac{1}{2}M_{TOT}\langle v^2 \rangle\]

so we can extract the total mass as:

\[M_{TOT} \simeq \frac{\langle r \rangle \langle v^2 \rangle}{G_N} \gg \sum m_{galaxies} \]

which for the Coma cluster turned out to be much more than the mass
estimated just by simply counting the galaxies in the cluster.

\subsubsection{About Zwicky}\label{about-zwicky}

Fritz Zwicky was a prolific scientist and made important contributions
in many areas of astronomy but he is rather unknown. He coined the term
dark matter, supernova and predicted the existence of neutron stars (2
years after the discovery of the neutron)\ldots{} He also proposed an
alternative cosmology explaining the red-shift as tired light.

He also believed in re-arranging the planets in the solar system using
rockets to make them habitable.

\subsection{2. The rotational curves of
Galaxies}\label{the-rotational-curves-of-galaxies}

In Kelperian systems, like our solar system, where most of the mass is
at the center one can infer the centripital force of a mass orbiting the
system as:

\[\frac{m v^2}{r} = G \frac{m M}{r^2}\]

where \(M\) is the inner mass. In this case the velocity of the orbiting
masses \(m\) is expected to follow \(v \propto 1/\sqrt{r}\). In the case
of spiral galaxies, where the total mass is at the center, the velocity
of external objects (like our Sun), was expected to follow the same
trend, however it was obsevered that most of the spiral galaxies had
rotational velocities of \(v \sim \mathrm{cte}\). It can be deducted
that there is matter density (a halo) that should follow
\(\rho \propto r^{-2}\) in order to explain the constant mass.

Vera Rubin measured the rotation curves of large number of galaxies up
to 110 kpc. They all showed the similar behavoir proving that this was
an universal feature.

\subsubsection{About Vera}\label{about-vera}

More info on Vera Rubin can be found on
\href{https://en.wikipedia.org/wiki/Vera_Rubin}{wikipedia}.

\subsection{3. Gravitational lensing}\label{gravitational-lensing}

In general relativity, the presence of matter (energy density) can curve
spacetime, and the path of a light ray will be deflected as a result.
This process is called gravitational lensing and in many cases can be
described in analogy to the deflection of light by (e.g.~glass) lenses
in optics.

The angle of deviation from gravitational lensing is given by:

\[\alpha = \frac{4GM}{c^2 b}\]

where \(b\) is the impact parameter or the closest distance.

The analysis of the distance in this figure gives the relation:

\[D_{LS} \sin \frac{\alpha}{2} = \frac{1}{2}(D_s \sin \theta_1 - D_s \sin \theta_s)\]

making small angle approximations gives:

\[\alpha D_{LS} = D_s (\theta_1 - \theta_s)\]

therefore

\[\theta_s = \theta_1 - \frac{4GM}{c^2}\frac{D_{LS}}{D_s D_L}\frac{1}{\theta_1}\]

in the particular case of a colinearity between the source and the lens,
ie \(\theta_s = 0\), we have:

\[\theta_1 \equiv \theta_E = \left(\frac{4GM}{c^2}\frac{D_{LS}}{D_s D_L}\right)^{1/2}\]

which is known as the Einstein ring

\subsection{4. Cosmic Microwave
Background}\label{cosmic-microwave-background-1}

As we show the microwave background radiation can be decomposed just
like sound from a musical instrument can be broken into harmonics. From
the features of its \emph{power spectrum}, i.e.~the amount of radiation
associated to each frequency, astrophysicists can calculate the quantity
of dark matter contained in the Universe. As we saw in Lecture 2, the
current cosmological model \(\Lambda\)CDM, has the following components
for matter and dark energy:

\[\Omega_\Lambda \simeq 0.70, \;\;\; \Omega_{m} \simeq 0.30\]

\subsection{5. Big Bang nucleusintesis
(BBN)}\label{big-bang-nucleusintesis-bbn}

It is known that the elements observed in the Universe were created in
either of two ways:

\begin{itemize}
\tightlist
\item
  Light elements (deuterium, helium, and lithium) were produced in the
  first few minutes of the Big Bang
\item
  Heavier elements than helium are thought to have an stellar origin and
  be formed much later in the history of the Universe.
\end{itemize}

Roughly three minutes after the Big Bang itself, the temperature of the
Universe who was at roughly \(10^{32}\) K cooled down to approximately
\(10^9\) Kelvin when nucleosynthesis, or the production of light
elements, could take place. The prediction of light elements as function
of the baryon density can be seen in this plot:

\includegraphics{images/BBN.png}

As can be seen the predictions depend strongly on the baryon density (ie
neutrons and protons) at the time of the nucleosynthesis. In particular
they depend on the relative abundance of baryons relative to radiation,
the baryon-to-photon ratio. Since the photon energy density is well
known from the CMB, the observations of primordial abundances of the
isotopes of hydrogen, helium and lithium provide a strong constraint on
the baryon density. The estimate of baryon density is then
\(\Omega_b h^2 \simeq 0.02\)

\section{Dark matter?}\label{dark-matter-1}

In January 1860 the French mathematician Urbain Le Verrier announces the
discovery of a new planet that he named Vulcan between Mercury and the
Sun (following his earlier successful prediction of Neptune in 1856)
explaining the precession of Mercury. During years, amateur astronomers
claimed to have seen the planet. However we know now the precession is
explained by Einsteins gravity.

Today, the search continues for these so-called vulcanoid asteroids.
None have been found yet and searches have ruled out asteroids larger
than about 6 km. Neither SOHO nor STEREO have detected a planet inside
the orbit of Mercury so far.

\subsection{Modified Newtonian Dynamics
(MoND)}\label{modified-newtonian-dynamics-mond}

What if the mass discrepancy can be solved without ``adding'' matter. In
1983 Mordehai Milgrom proposed that a modified newtonian dynanics could
explain the dynamics of galaxies in the small acceleration regime. In
MOND, violation of Newton's Laws occurs at extremely small
accelerations, characteristic of galaxies yet far below anything
typically encountered in the Solar System or on Earth.

\subsection{The Bullet Cluster}\label{the-bullet-cluster}

It is usually quoted as the ``irrefutable proof of CDM'' it consists on
two colliding galaxy clusters. At a statistical significance of
8\(\sigma\), it was found that the spatial offset of the center of the
total mass from the center of the baryonic mass peaks cannot be
explained with an alteration of the gravitational force law alone

\href{http://backreaction.blogspot.be/2017/01/the-bullet-cluster-as-evidence-against.html}{Here}
is an interesting post from theorist Sabine Hossenfelder about recents
papers on the Bullet Cluster and its implication on the Dark Matter
nature of the mass discrepancy:

\section{Dark Matter Candidates}\label{dark-matter-candidates}

\subsection{Introduction}\label{introduction-3}

Assuming that Dark Matter exists, there are some conditions this matter
must satify. It must:

\begin{itemize}
\tightlist
\item
  stable at least for the life time of the Universe.
\item
  not interacting electromagnetically (it is dark).
\item
  Can interact weakily
\item
  it must have a density of \(\Omega_{DM} \sim 0.2\) since:
  \[\Omega_{matter} = \Omega_{baryon} + \Omega_{\nu HDM} + \Omega_{CDM} \simeq 0.05 + 0.01 + 0.24 = 0.30 \]
\end{itemize}

\subsection{The Boltzman equation}\label{the-boltzman-equation}

Imagine that dark matter is a non-interacting, non-relativistic particle
with number density given \(n_\chi \propto a^{-3}\). As the universe
expands the density is diluting according to:

\[\frac{d n_\chi}{dt} = - 3 H n_\chi\]

Since \(H = da/dt\). Now let's imagine that dark matter is in thermal
equilibrium with the standard model, we are talking here about
``chemical'' equilibrium in which particles interact and convert among
each other while keeping the \emph{total number of particles}. Ie, in
this case it will mean that dark matter particles annihilate to SM
(\(\chi \chi \rightarrow f\bar{f}\)) and SM particles produce dark
matter particles (\$f\bar\{f\} \rightarrow \chi \chi \$). Dark matter
annihilation happens at the rate that depends on the square of dark
matter number density (because we need 2 DM particles) and the thermally
average annihilation cross-section, so we can add this term in the
equation above \$n\^{}2\_\chi \langle \sigma\emph{\{A\}
v}\chi \rangle \$. On the contrary, the convertion of SM particles to DM
can be is produced as a rate of
\(-n^2_{SM} \langle \sigma_{A,inv} v_\chi \rangle\). At equilibrium,
both processes must compensate so we can write:

\[n^2_{\chi, eq} \langle \sigma_{A} v_\chi \rangle = n^2_{SM} \langle \sigma_{A,inv} v_\chi \rangle\]

which leads us to the Boltzman equation written as:

\[\frac{\mathrm{d} n_\chi}{\mathrm{d}t} = - 3 H n_\chi  - \langle \sigma_{A} v_\chi \rangle (n^2_\chi - n^2_{\chi, eq})\]

\subsection{Thermal freeze-out and the WIMP
``miracle''}\label{thermal-freeze-out-and-the-wimp-miracle}

From the boltzman equation is easy to see what would happen in an
Universe with no expansion, \(H = 0\). It is clear that if
\(n^2_\chi > n^2_{\chi,eq}\) annihilation will dominate until the number
of \(\chi\) particles drops to its equilibrium value. If the universe is
expanding, but the expansion is slow, we still can ignore the term
\(-3Hn_\chi\) but temperature will change and it will change the number
density in equilibrium. For cold dark matter, like not relativistic
wimps with mass \(M_\chi \gg T\), this follow the equilibrium density
function from the Boltzmann relation:

\[n_{\chi, eq}(T)  = \left(\frac{M_\chi T}{2\pi}\right)^{3/2} \exp \left(\frac{-M_\chi}{T}\right)\]

In other words, the number density of dark matter drops as the tempeture
goes down and Universe expands. (Hot dark matter on the other hand will
be \(n^{HDM}_\chi(T) \sim T^3\)) What happens is that annihilation
processes like \(\chi \chi \rightarrow f\bar{f}\) happen easily, but
because \(\chi\) is heavy, inverse annihilation processes like
\(f\bar{f} \rightarrow \chi\chi\) happen only very rarely (with photons
on the tail of the momentum distribution).

At some point the expansion of the Universe becomes important and we no
longer can ignore the term \(-3Hn_\chi\). As \(n_\chi\) becomes smaller,
the expansion rate becomes more important that the annihilation term
that depends on \(n^2_\chi\). Dark matter particles are separated away
from each other and they cannot annihilate. This is the freeze-out of
dark matter. At that moment the number density of dark matter becomes
estable in a solution called the freeze-out abundance.

In a radiation dominated Universe the expansion of the Universe is given
by:

\[ H(T) \propto \frac{T^2}{M_{Pl}} \]

where \(M_{PL}\) is the plank mass. So according to the Boltzman
equation, in an expanding Universe the moment of the freeze-out is given
by the condition:

\[n_\chi(T_{fo}) \langle \sigma_{A} v_\chi \rangle =  3H(T_{fo}) \]

where we can assume that \(n_\chi = n_{\chi,eq}\). After the freeze-out,
the number density changes scales with \(a(t)^{-3}\) but also \(T\)
scales with \(a(t)^{-1}\) so the number density of dark matter particles
today can be written as:

\[n_\chi(T_0) \sim n_\chi(T_{fo})\left(\frac{T_0}{T_{fo}}\right)^3 \sim \left(\frac{T_0}{T_{fo}}\right)^3 \times \frac{T_{fo}^2/M_{Pl}}{\langle \sigma_{A} v_\chi \rangle} \]

The mass density is then, \(\rho_\chi = M_\chi n_\chi\) and dividing by
the critical energy gives:

\[\Omega_\chi = \frac{\rho_\chi}{\rho_c} \sim \frac{10^{-25}}{\langle \sigma_{A} v_\chi \rangle} \rm{cm}^3\rm{s}^{-1}\]

Finding the right relic density of dark matter is the same as finding
the right value of \(\langle \sigma_{A} v_\chi \rangle\). As it happens
this values turns out to be in the same range expected for the weak
interactions. This is called the WIMP miracle\ldots{}

\subsection{Direct detection}\label{direct-detection}

The differential rate per unit detector mass is given by:

\[\frac{\mathrm{d}R}{\mathrm{d} E_R} = \frac{n_\chi}{m_N} \Biggl\langle v \frac{\mathrm{d}\sigma}{\mathrm{d}E_R}\Biggr\rangle\]

As can be seen the rate depends on the dark matter density since
\(n_\chi = \rho_\chi/m_\chi\), the velocity of DM, \(v\) and their
differential cross-section.

The recoil energy can be measured by this three different techniques:

\begin{itemize}
\tightlist
\item
  Phonon/Thermal: vibration (seen as rise in T) in a crystal due to the
  recoiled of the nucleus impacted by the WIMP.
\item
  Ionization: an electron is pushed away from its nucleus. A magnetic
  field drives the electron to a charge detector
\item
  Scintillation: an electron absorbs energy in the interaction. A short
  time after, it de-excites and emits a photon.
\end{itemize}

\subsection{Indirect detection}\label{indirect-detection}

The flux of particles observed in a indirect detector using
\(\gamma\)-rays or neutrinos can be deducted from this formula:

\[\frac{\mathrm{d}\Phi_x}{\mathrm{d}E_x} = \frac{1}{4\pi} \frac{\langle \sigma_A v \rangle}{2m_\chi^2} \frac{\mathrm{d} N_x}{\mathrm{d}E_x} \int_0^{\Delta \Omega} \mathrm{d} \Omega \int_{l.o.s} \rho_\chi^2(r(s,\Psi, \theta)) \mathrm{d} s\]

where \(x\) = \(\gamma\)-rays, \(\nu\). The J-Factor is the integral of
the density square (we need two dark matter particles to annihilate)
along the line of sight. There are many halo models in the market.
Simulations favor that the DM collapse give ``cuspy'' profiles,
i.e.~more peaked (good for enhancing the signal). Observations of
rotation curves of galaxies favor ``cored'' profiles, i.e.~constant
density cores Substructure not well resolved below
\(\sim 10^5 M_\odot\), which may have an important effect due to the
\(\rho^2\) dependency of signal Effect of baryons is still unclear:

\begin{itemize}
\tightlist
\item
  steepening through adiabatic contraction
\item
  flattening through star bursts
\end{itemize}

\subsection{Targets for indirect
detection}\label{targets-for-indirect-detection}

\textbf{Dwarf Galaxies:} * clean (low star formation) * largest
mass-to-light ratio * boost factors irrelevant * about 25 known dwarf
satellites of MW * best limits for \(\langle \sigma_A v \rangle\):
already at natural scale for small masses (\textasciitilde10 GeV) with
Fermi-LAT

\textbf{Galaxy Cluster:} * Largest gravitationally bound objects in the
Universe * Dark matter dominated * Substructure is quite uncertain *
Boost factors could be very large, making them competitive with dwarf
galaxies in the most optimistic cases * Astrophysical background could
be important (AGNs, CR interacting with hadronic material\ldots)

\textbf{Isotropic emission:} * Spectrum: power law from 200 MeV to
100~GeV with γ=2.4) * Mainly due to extragalactic unresolved sources:
starburst and normal galaxies, galaxy clusters, shocks by the assembly
or large scale structures * Detection of DM difficult, but upper bounds
can be set assuming contributions from these populations, able to
discard the PAMELA excess DM interpretation

\textbf{Galactic Center:}

\begin{itemize}
\tightlist
\item
  Brightest source of DM by two orders of magnitude
\item
  Large astrophysical background
\item
  For GeV searches also interaction of CRs with molecular material in
  the inner Galaxy
\item
  Searches focused slightly off the most inner GC
\item
  More effect of the DM profile, since it is closer
\end{itemize}

\textbf{Sun and Earth} * Only visibles in neutrinos. * Low or
intexistant background * Less effects on the Halo model profiles * Dark
Matter is accumulated as an effect of the capturing of dark matter,
these searches can prove the \(\sigma_{\chi N}\)

\textbf{\emph{Absorption in the Sun}}

The mean free path of neutrinos in the Sun is given by:

\[ \lambda = \frac{A_H}{N_A\rho \sigma} = \frac{ 1\; \mathrm{mol}}{6.023 \times 10^{23}\; \mathrm{mol/gr} 1.6 \times 10^5\; \mathrm{gr/cm}^3 0.686\times 10^{-38}\; \mathrm{cm}^{2}/\mathrm{GeV} 5000 \;\mathrm{GeV}} = 3.0 \times 10^5 \mathrm{\; cm} \ll 7 \times 10^{10} \mathrm{cm}  = R_\odot\]

\subsection{Capturing of DM in local celestial
bodies}\label{capturing-of-dm-in-local-celestial-bodies}

Dark Matter in the Sun or Earth is accumulated by scattering processes
of DM followed by gravitational capture of DM. It is not the relic
density that we can find for instance at the Center of the Galaxy or
other astrophysical places like Dwarf Galaxies, etc. Let's assume \(N\)
to be the number of DM particles in a celestial body. The equation that
govern the evolution of this density can be described as:

\[\frac{\mathrm{d} N}{\mathrm{d}t} = C_c - C_A N^2 - C_E N\]

The various elements of this equation are:

\begin{itemize}
\tightlist
\item
  \(C_E\) is the ``evaporation'' of dark matter, it is the escape of DM
  due to their thermal velociy being equivalent to the escape velocity
  of the celestial body. The Sun's escape velocity is
  \(v_{esc} \simeq 1156\) km/s. Assuming DM particles sink into the core
  of the Sun and gain the thermal velocity the typical velocity is:
\end{itemize}

\[v_\chi  \simeq c \left(\frac{1 \mathrm{keV}}{m_\chi}\right)^{1/2} \geq  v_{esc}^{\odot} \rightarrow m_\chi \leq 0.1 \mathrm{GeV} \]

only for very low masses the evaporation term is important.

\begin{itemize}
\item
  \(C_A\) is the annihilation term which depends on the factor
  \(\langle \sigma_A v \rangle\) and an effective volume.
\item
  \(C_c\) is the capture term and it depends on the DM-nucleon
  cross-sections \(\sigma_{\chi-N}\). For capture in the Earth the main
  contribution comes from the spin-independent cross-section which is
  quadratically proportional to \(A^2\) of the elements in Earth. It is
  also proportional to the DM flux, ie (for the Sun):
  \[ C_c \sim \frac{\rho_\chi}{m_\chi}v_\chi \left(\frac{M_\odot}{m_N}\right)\sigma_{\chi-N}\]
\end{itemize}

By solving the equation above (ignoring the evaporation term) we can
express the total annihilation rate \(\Gamma_A\) is expressed as:

\[\Gamma_A = \frac{1}{2}C_A N^2 = \frac{C_c}{2}\left[\tanh(\sqrt{C_c C_A} t)\right]^2\]

where \(t\) is the lifetime of the celestial body. It is clear from this
equation that equilibrium is reached when:

\[t_{eq} \equiv \frac{1}{\sqrt{C_c C_A}} \]

For the Earth, this equilibrium time is of the order of \(10^{11}\)
years if the spin-independent WIMP-proton cross-section is
\$\sigma\^{}\{SI\}\_\{\chi - p\} \sim 10\^{}\{-43\} \(cm\)\^{}\{2\}\$
which is longer than the age of the solar system \(t_{Earth} \sim 4.5\)
Gyr. In the Sun however, most models predict \(t_{eq} \ll t_\odot\) and
therefore we can assume that equilibrium is reached in the Sun.

\section{Bibliography}\label{bibliography}

\begin{itemize}
\tightlist
\item
  PDG review on Dark Matter
  pdg.lbl.gov/2016/reviews/rpp2016-rev-dark-matter.pdf
\item
  Particle Dark Matter: Observation, Models and Searches. Gianfranco
  Bertone.
  \href{https://www.cambridge.org/core/books/particle-dark-matter/B03C934EAB188884EFC6B02432632496}{DOI:
  10.1017/CBO9780511770739}
\item
  Some reviews in the arxiv:

  \begin{itemize}
  \tightlist
  \item
    https://arxiv.org/abs/hep-ph/0404175
  \item
    https://arxiv.org/abs/hep-ph/9506380
  \end{itemize}
\end{itemize}

\bookmarksetup{startatroot}

\chapter*{References}\label{references-3}
\addcontentsline{toc}{chapter}{References}

\markboth{References}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-Claus}
Grupen, Claus. n.d. \emph{Astro Particle Physics}.

\bibitem[\citeproctext]{ref-kachelriess2008lecture}
Kachelriess, M. 2008. {``Lecture Notes on High Energy Cosmic Rays.''}
\url{https://arxiv.org/abs/0801.4376}.

\bibitem[\citeproctext]{ref-Kampert_2014}
Kampert, Karl-Heinz, and Peter Tinyakov. 2014. {``Cosmic Rays from the
Ankle to the Cutoff.''} \emph{Comptes Rendus. Physique} 15 (4): 318--28.
\url{https://doi.org/10.1016/j.crhy.2014.04.006}.

\bibitem[\citeproctext]{ref-72925f46-3bcd-305f-ad05-7b07a9fbcf25}
Melia, Fulvio. 2009. \emph{High-Energy Astrophysics}. Vol. 14. Princeton
University Press. \url{http://www.jstor.org/stable/j.ctv21r3q4z}.

\bibitem[\citeproctext]{ref-Workman:2022ynf}
Workman, R. L., and Others. 2022. {``{Review of Particle Physics}.''}
\emph{PTEP} 2022: 083C01. \url{https://doi.org/10.1093/ptep/ptac097}.

\end{CSLReferences}



\end{document}
